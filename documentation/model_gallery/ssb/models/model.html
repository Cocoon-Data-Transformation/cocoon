<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cocoon - Data Modeling</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-yaml.min.js"></script>
</head>
<style>
    /* for list-group-item highlight */
    .list-group-item.active {
        background-color: #464646;
        border-color: #f8f9fa;
        color: #ffffff;
    }

    .list-group-item.active:hover {
        background-color: #bebebe;
        border-color: #e9ecef;
        color: #ffffff;
    }

    /* for nav-link highlight */
    .nav-link {
        color: #6c757d !important;
        /* Gray color for inactive links */
    }

    .nav-link.active {
        color: #000 !important;
        /* Black color for active link */
    }

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 0.9em;
    border-radius: 4px;
    overflow: hidden;
}

th,
td {
    padding: 3px 4px;
    text-align: left;
    border-bottom: 1px solid #dddddd;
    border-right: 1px solid #dddddd;
}

thead tr {
    background-color: #464646;
    /* Changed color for header */
    color: #ffffff;
    /* Changed text color for better contrast */
    text-align: left;
    font-weight: bold;
    font-size: 12px;
}

th {
    top: 0;
    background-color: #464646;
    color: #ffffff;
}

tbody tr {
    background-color: #f9f9f9;
    /* Lighter color for content rows */
    font-size: 10px
}
.code_container {
    max-height: calc(60vh);
    overflow: auto;
}

.code_container pre[class*="language-"] {
    border-radius: 4px;
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
    font-size: 12px;
}


.tree li {
    list-style-type: none;
    margin: 10px 0 10px 10px;
    position: relative;
}
.tree li::before {
    content: "";
    position: absolute;
    top: -10px;
    left: -20px;
    border-left: 1px solid #ccc;
    border-bottom: 1px solid #ccc;
    width: 20px;
    height: 15px;
}
.tree li::after {
    position: absolute;
    content: "";
    top: 5px;
    left: -20px;
    border-left: 1px solid #ccc;
    border-top: 1px solid #ccc;
    width: 20px;
    height: 100%;
}
.tree li:last-child::after {
    display: none;
}
.tree li:last-child:before {
    border-radius: 0 0 0 5px;
}
ul.tree > li:first-child::before {
    display: none;
}
ul.tree > li:first-child::after {
    border-radius: 5px 0 0 0;
}
.tree li span {
    border: 1px solid #ccc;
    padding: 5px 10px;
    text-decoration: none;
    color: #666;
    font-family: arial, verdana, tahoma;
    font-size: 11px;
    display: inline-block;
    border-radius: 5px;
    transition: all 0.2s;
    width: 400px;
    box-sizing: border-box;
    white-space: normal;
    word-wrap: break-word;
}

.tree li span:hover, .tree li span:hover+ul li span {
    background: #c8e4f8;
    color: #000;
    border: 1px solid #94a0b4;
}
.tree li span:hover+ul li::after, 
.tree li span:hover+ul li::before, 
.tree li span:hover+ul::before, 
.tree li span:hover+ul ul::before {
    border-color: #94a0b4;
}

/* Collapsible functionality */
.tree li input[type="checkbox"] {
    display: none;
}
.tree li input[type="checkbox"] ~ ul {
    display: none;
}
.tree li input[type="checkbox"]:checked ~ ul {
    display: block;
}
.tree li label {
    cursor: pointer;
}

/* Color indicator for expandable items */
.tree li label span {
    background-color: #e6f3ff;
    border-color: #b8daff;
    color: #004085;
}
.tree li label span:hover {
    background-color: #cce5ff;
    border-color: #b8daff;
    color: #002752;
}

/* Styles for <b> tags */
.tree li span b {
    font-size: 13px;
    display: block;
    margin-bottom: 3px;
}

/* Styles for <em> tags in labels */
.tree li label span em {
    color: #666;
    font-style: italic;
    font-size: 10px;
    display: block;
    max-width: 200px;
}

/* Styles for <em> tags in regular list items */
.tree li:not(label) span em {
    color: #888;
    font-style: normal;
    font-size: 10px;
    display: inline;
}


    .code_container {
        max-height: calc(60vh);
        overflow: auto;
    }

    .code_container pre[class*="language-"] {
        border-radius: 4px;
        padding: 1em;
        margin: .5em 0;
        overflow: auto;
        font-size: 12px;
    }


    .carousel-indicators li {
        background-color: #808080;
        /* Gray for inactive indicators */
    }

    .carousel-indicators .active {
        background-color: #000000;
        /* Black for active indicator */
    }
</style>

<body>


    <div class="container mt-4">
        <!-- New row for the header -->
        <div class="row mb-4">
            <div class="col-md-6">
                <a href="https://github.com/Cocoon-Data-Transformation/cocoon" target="_blank"
                    class="text-decoration-none text-dark">
                    <div class="d-flex align-items-center">
                        <img src="https://raw.githubusercontent.com/Cocoon-Data-Transformation/cocoon/main/images/cocoon_icon.png"
                            alt="cocoon icon" width="40" class="mr-3">
                        <div>
                            <h4 class="mb-0">Cocoon Catalog</h4>
                            <small class="mb-0">Verified by human, RAG by LLMs</small>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-md-6 d-flex align-items-center justify-content-end">
                <h2><agent_exp.DataProject object at 0x7f7d1185cfd0></h2>
            </div>
        </div>


        <div class="row">
            <div class="col-md-9">
                <div class="card">
                    <div class="card-body">
                        <div class="tab-content">
                            
        <div class="tab-pane fade show active" id="cocoon_steps_source">
            <nav class="navbar navbar-light bg-light">
                <span class="navbar-brand mb-0">
                    <h5 class="card-title mb-0">Source</h5>
                </span>
                
    <ul class="nav">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#"
                id="navbarDropdownMenuLink_source" data-toggle="dropdown" aria-haspopup="true"
                aria-expanded="false">
                Select Source Table
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink_source">
    <a class="dropdown-item active" data-toggle="tab" href="#cocoon_source_customer">customer</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_source_date">date</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_source_lineorder">lineorder</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_source_part">part</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_source_supplier">supplier</a>
            </div>
        </li>
    </ul>
    
            </nav>
            <div class="container">
                <small class="text-muted">We display the source tables from the data warehouses to model.</small>
            </div>
            <hr>
            <div class="scroll-container overflow-auto">
                <div class="tab-content mt-3">
                    
        <div class="tab-pane fade show active" id="cocoon_source_customer">
            <p class="subtitle text-center mb-3">customer</p>
            <p class="text-center mb-0">Table Preview<small class="text-muted">(first 5 rows)</small></p><div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C_CUSTKEY</th>
      <th>C_NAME</th>
      <th>C_ADDRESS</th>
      <th>C_CITY</th>
      <th>C_NATION</th>
      <th>C_REGION</th>
      <th>C_PHONE</th>
      <th>C_MKTSEGMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Customer#000000001</td>
      <td>j5JsirBM9P</td>
      <td>MOROCCO  4</td>
      <td>MOROCCO</td>
      <td>AFRICA</td>
      <td>25-214-662-5265</td>
      <td>BUILDING</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Customer#000000002</td>
      <td>487LW1dovn6Q4dMVym</td>
      <td>JORDAN   5</td>
      <td>JORDAN</td>
      <td>MIDDLE EAST</td>
      <td>23-159-880-1131</td>
      <td>AUTOMOBILE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>Customer#000000004</td>
      <td>4u58h f</td>
      <td>EGYPT    6</td>
      <td>EGYPT</td>
      <td>MIDDLE EAST</td>
      <td>14-108-116-4678</td>
      <td>MACHINERY</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>Customer#000000005</td>
      <td>hwBtxkoBF qSW4KrI</td>
      <td>CANADA   2</td>
      <td>CANADA</td>
      <td>AMERICA</td>
      <td>13-360-101-6891</td>
      <td>HOUSEHOLD</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>Customer#000000007</td>
      <td>8OkMVLQ1dK6Mbu6WG9</td>
      <td>CHINA    3</td>
      <td>CHINA</td>
      <td>ASIA</td>
      <td>28-777-614-8279</td>
      <td>AUTOMOBILE</td>
    </tr>
  </tbody>
</table></div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_source_date">
            <p class="subtitle text-center mb-3">date</p>
            <p class="text-center mb-0">Table Preview<small class="text-muted">(first 5 rows)</small></p><div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D_DATEKEY</th>
      <th>D_DATE</th>
      <th>D_DAYOFWEEK</th>
      <th>D_MONTH</th>
      <th>D_YEAR</th>
      <th>D_YEARMONTHNUM</th>
      <th>D_YEARMONTH</th>
      <th>D_DAYNUMINWEEK</th>
      <th>D_DAYNUMINMONTH</th>
      <th>D_DAYNUMINYEAR</th>
      <th>D_MONTHNUMINYEAR</th>
      <th>D_WEEKNUMINYEAR</th>
      <th>D_SELLINGSEASON</th>
      <th>D_LASTDAYINWEEKFL</th>
      <th>D_LASTDAYINMONTHFL</th>
      <th>D_HOLIDAYFL</th>
      <th>D_WEEKDAYFL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19920101</td>
      <td>January 1, 1992</td>
      <td>Thursday</td>
      <td>January</td>
      <td>1992</td>
      <td>199201</td>
      <td>Jan1992</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19920102</td>
      <td>January 2, 1992</td>
      <td>Friday</td>
      <td>January</td>
      <td>1992</td>
      <td>199201</td>
      <td>Jan1992</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19920103</td>
      <td>January 3, 1992</td>
      <td>Saturday</td>
      <td>January</td>
      <td>1992</td>
      <td>199201</td>
      <td>Jan1992</td>
      <td>7</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19920104</td>
      <td>January 4, 1992</td>
      <td>Sunday</td>
      <td>January</td>
      <td>1992</td>
      <td>199201</td>
      <td>Jan1992</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19920105</td>
      <td>January 5, 1992</td>
      <td>Monday</td>
      <td>January</td>
      <td>1992</td>
      <td>199201</td>
      <td>Jan1992</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table></div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_source_lineorder">
            <p class="subtitle text-center mb-3">lineorder</p>
            <p class="text-center mb-0">Table Preview<small class="text-muted">(first 5 rows)</small></p><div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LO_ORDERKEY</th>
      <th>LO_LINENUMBER</th>
      <th>LO_CUSTKEY</th>
      <th>LO_PARTKEY</th>
      <th>LO_SUPPKEY</th>
      <th>LO_ORDERDATE</th>
      <th>LO_ORDERPRIORITY</th>
      <th>LO_SHIPPRIORITY</th>
      <th>LO_QUANTITY</th>
      <th>LO_EXTENDEDPRICE</th>
      <th>LO_ORDTOTALPRICE</th>
      <th>LO_DISCOUNT</th>
      <th>LO_REVENUE</th>
      <th>LO_SUPPLYCOST</th>
      <th>LO_TAX</th>
      <th>LO_COMMITDATE</th>
      <th>LO_SHIPMODE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>277316</td>
      <td>7</td>
      <td>19190</td>
      <td>99546</td>
      <td>1170</td>
      <td>19950228</td>
      <td>4-NOT SPECIFIED</td>
      <td>0</td>
      <td>13</td>
      <td>2009202</td>
      <td>23455557</td>
      <td>0</td>
      <td>2009202</td>
      <td>92732</td>
      <td>3</td>
      <td>19950525</td>
      <td>REG AIR</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5929219</td>
      <td>4</td>
      <td>28511</td>
      <td>48214</td>
      <td>1427</td>
      <td>19980702</td>
      <td>1-URGENT</td>
      <td>0</td>
      <td>14</td>
      <td>1627094</td>
      <td>20688659</td>
      <td>4</td>
      <td>1562010</td>
      <td>69732</td>
      <td>0</td>
      <td>19980922</td>
      <td>SHIP</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3693318</td>
      <td>4</td>
      <td>15811</td>
      <td>100325</td>
      <td>1170</td>
      <td>19920807</td>
      <td>2-HIGH</td>
      <td>0</td>
      <td>4</td>
      <td>530128</td>
      <td>19688727</td>
      <td>9</td>
      <td>482416</td>
      <td>79519</td>
      <td>0</td>
      <td>19921013</td>
      <td>FOB</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2765669</td>
      <td>2</td>
      <td>2258</td>
      <td>126666</td>
      <td>35</td>
      <td>19920504</td>
      <td>4-NOT SPECIFIED</td>
      <td>0</td>
      <td>15</td>
      <td>2538990</td>
      <td>3523267</td>
      <td>8</td>
      <td>2335870</td>
      <td>101559</td>
      <td>8</td>
      <td>19920703</td>
      <td>MAIL</td>
    </tr>
    <tr>
      <th>4</th>
      <td>686017</td>
      <td>1</td>
      <td>23836</td>
      <td>172615</td>
      <td>804</td>
      <td>19951014</td>
      <td>1-URGENT</td>
      <td>0</td>
      <td>17</td>
      <td>2868937</td>
      <td>4014677</td>
      <td>7</td>
      <td>2668111</td>
      <td>101256</td>
      <td>8</td>
      <td>19951213</td>
      <td>TRUCK</td>
    </tr>
  </tbody>
</table></div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_source_part">
            <p class="subtitle text-center mb-3">part</p>
            <p class="text-center mb-0">Table Preview<small class="text-muted">(first 5 rows)</small></p><div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P_PARTKEY</th>
      <th>P_NAME</th>
      <th>P_MFGR</th>
      <th>P_CATEGORY</th>
      <th>P_BRAND1</th>
      <th>P_COLOR</th>
      <th>P_TYPE</th>
      <th>P_SIZE</th>
      <th>P_CONTAINER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>moccasin royal</td>
      <td>MFGR#2</td>
      <td>MFGR#21</td>
      <td>MFGR#2128</td>
      <td>floral</td>
      <td>LARGE BURNISHED STEEL</td>
      <td>44</td>
      <td>LG CAN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>dark sky</td>
      <td>MFGR#3</td>
      <td>MFGR#34</td>
      <td>MFGR#3438</td>
      <td>navajo</td>
      <td>LARGE ANODIZED BRASS</td>
      <td>45</td>
      <td>LG CASE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>brown turquoise</td>
      <td>MFGR#5</td>
      <td>MFGR#54</td>
      <td>MFGR#5415</td>
      <td>deep</td>
      <td>PROMO PLATED TIN</td>
      <td>2</td>
      <td>MED PACK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>floral beige</td>
      <td>MFGR#4</td>
      <td>MFGR#44</td>
      <td>MFGR#4421</td>
      <td>medium</td>
      <td>PROMO POLISHED BRASS</td>
      <td>19</td>
      <td>LG DRUM</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>forest magenta</td>
      <td>MFGR#2</td>
      <td>MFGR#23</td>
      <td>MFGR#2336</td>
      <td>blush</td>
      <td>STANDARD BRUSHED COPPER</td>
      <td>3</td>
      <td>JUMBO BAG</td>
    </tr>
  </tbody>
</table></div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_source_supplier">
            <p class="subtitle text-center mb-3">supplier</p>
            <p class="text-center mb-0">Table Preview<small class="text-muted">(first 5 rows)</small></p><div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>S_SUPPKEY</th>
      <th>S_NAME</th>
      <th>S_ADDRESS</th>
      <th>S_CITY</th>
      <th>S_NATION</th>
      <th>S_REGION</th>
      <th>S_PHONE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Supplier#000000001</td>
      <td>sdrGnXCDRcfriBvY0KL,i</td>
      <td>PERU     7</td>
      <td>PERU</td>
      <td>AMERICA</td>
      <td>27-989-741-2988</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Supplier#000000002</td>
      <td>TRMhVHz3XiFu</td>
      <td>ETHIOPIA 2</td>
      <td>ETHIOPIA</td>
      <td>AFRICA</td>
      <td>15-768-687-3665</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Supplier#000000003</td>
      <td>BZ0kXcHUcHjx62L7CjZS</td>
      <td>ARGENTINA8</td>
      <td>ARGENTINA</td>
      <td>AMERICA</td>
      <td>11-719-748-3364</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Supplier#000000004</td>
      <td>qGTQJXogS83a7MB</td>
      <td>MOROCCO  5</td>
      <td>MOROCCO</td>
      <td>AFRICA</td>
      <td>25-128-190-5944</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Supplier#000000005</td>
      <td>lONEYAh9sF</td>
      <td>IRAQ     1</td>
      <td>IRAQ</td>
      <td>MIDDLE EAST</td>
      <td>21-750-942-6364</td>
    </tr>
  </tbody>
</table></div>
        </div>
        
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_steps_stage">
            <nav class="navbar navbar-light bg-light">
                <span class="navbar-brand mb-0">
                    <h5 class="card-title mb-0">Stage</h5>
                </span>
                
    <ul class="nav">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#"
                id="navbarDropdownMenuLink_stage" data-toggle="dropdown" aria-haspopup="true"
                aria-expanded="false">
                Select Stage Table
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink_stage">
    <a class="dropdown-item active" data-toggle="tab" href="#cocoon_stage_stg_date">stg_date</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_stage_stg_part">stg_part</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_stage_stg_customer">stg_customer</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_stage_stg_supplier">stg_supplier</a><a class="dropdown-item " data-toggle="tab" href="#cocoon_stage_stg_lineorder">stg_lineorder</a>
            </div>
        </li>
    </ul>
    
            </nav>
            <div class="container">
                <small class="text-muted">We display the stage tables, their SQL transformations, and their configurations.</small>
            </div>
            <hr>
            <div class="scroll-container overflow-auto">
                <div class="tab-content mt-3">
                    
        <div class="tab-pane fade show active" id="cocoon_stage_stg_date">
            <p class="subtitle text-center mb-3">stg_date</p>
            
<p class="text-center mb-0">Table Preview <small class="text-muted">(first 5 rows)</small></p>
<div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day_of_week</th>
      <th>month_name</th>
      <th>year_</th>
      <th>year_month_abbr</th>
      <th>day_number_in_week</th>
      <th>day_number_in_month</th>
      <th>day_number_in_year</th>
      <th>month_number</th>
      <th>week_number</th>
      <th>selling_season</th>
      <th>date_key</th>
      <th>full_date</th>
      <th>is_holiday</th>
      <th>is_last_day_of_month</th>
      <th>is_last_day_of_week</th>
      <th>is_weekday</th>
      <th>year_month_numeric</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Thursday</td>
      <td>January</td>
      <td>1992</td>
      <td>Jan1992</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>19920101</td>
      <td>1992-01-01</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>199201</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Friday</td>
      <td>January</td>
      <td>1992</td>
      <td>Jan1992</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>19920102</td>
      <td>1992-01-02</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>199201</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Saturday</td>
      <td>January</td>
      <td>1992</td>
      <td>Jan1992</td>
      <td>7</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>19920103</td>
      <td>1992-01-03</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>199201</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sunday</td>
      <td>January</td>
      <td>1992</td>
      <td>Jan1992</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>19920104</td>
      <td>1992-01-04</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>199201</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Monday</td>
      <td>January</td>
      <td>1992</td>
      <td>Jan1992</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>Winter</td>
      <td>19920105</td>
      <td>1992-01-05</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>199201</td>
    </tr>
  </tbody>
</table></div>

<p class="text-center">stg_date.sql <small class="text-muted">(clean the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
-- Generated at 2024-08-26 00:48:59.029137+00:00
WITH 
"date_renamed" AS (
    -- Rename: Renaming columns
    -- D_DATEKEY -> date_key
    -- D_DATE -> full_date
    -- D_DAYOFWEEK -> day_of_week
    -- D_MONTH -> month_name
    -- D_YEAR -> year_
    -- D_YEARMONTHNUM -> year_month_numeric
    -- D_YEARMONTH -> year_month_abbr
    -- D_DAYNUMINWEEK -> day_number_in_week
    -- D_DAYNUMINMONTH -> day_number_in_month
    -- D_DAYNUMINYEAR -> day_number_in_year
    -- D_MONTHNUMINYEAR -> month_number
    -- D_WEEKNUMINYEAR -> week_number
    -- D_SELLINGSEASON -> selling_season
    -- D_LASTDAYINWEEKFL -> is_last_day_of_week
    -- D_LASTDAYINMONTHFL -> is_last_day_of_month
    -- D_HOLIDAYFL -> is_holiday
    -- D_WEEKDAYFL -> is_weekday
    SELECT 
        "D_DATEKEY" AS "date_key",
        "D_DATE" AS "full_date",
        "D_DAYOFWEEK" AS "day_of_week",
        "D_MONTH" AS "month_name",
        "D_YEAR" AS "year_",
        "D_YEARMONTHNUM" AS "year_month_numeric",
        "D_YEARMONTH" AS "year_month_abbr",
        "D_DAYNUMINWEEK" AS "day_number_in_week",
        "D_DAYNUMINMONTH" AS "day_number_in_month",
        "D_DAYNUMINYEAR" AS "day_number_in_year",
        "D_MONTHNUMINYEAR" AS "month_number",
        "D_WEEKNUMINYEAR" AS "week_number",
        "D_SELLINGSEASON" AS "selling_season",
        "D_LASTDAYINWEEKFL" AS "is_last_day_of_week",
        "D_LASTDAYINMONTHFL" AS "is_last_day_of_month",
        "D_HOLIDAYFL" AS "is_holiday",
        "D_WEEKDAYFL" AS "is_weekday"
    FROM "memory"."main"."date"
),

"date_renamed_cleaned" AS (
    -- Clean unusual string values: 
    -- month_name: The problem is that there are two misspelled month names in the dataset. 'Augest' is a misspelling of 'August', and 'Octorber' is a misspelling of 'October'. These are typos that need to be corrected to ensure accurate data representation and analysis. The correct values should be the proper spellings of these month names.
    SELECT
        "date_key",
        "full_date",
        "day_of_week",
        CASE
            WHEN "month_name" = 'Augest' THEN 'August'
            WHEN "month_name" = 'Octorber' THEN 'October'
            ELSE "month_name"
        END AS "month_name",
        "year_",
        "year_month_numeric",
        "year_month_abbr",
        "day_number_in_week",
        "day_number_in_month",
        "day_number_in_year",
        "month_number",
        "week_number",
        "selling_season",
        "is_last_day_of_week",
        "is_last_day_of_month",
        "is_holiday",
        "is_weekday"
    FROM "date_renamed"
),

"date_renamed_cleaned_casted" AS (
    -- Column Type Casting: 
    -- date_key: from INT to VARCHAR
    -- full_date: from VARCHAR to DATE
    -- is_holiday: from INT to BOOLEAN
    -- is_last_day_of_month: from INT to BOOLEAN
    -- is_last_day_of_week: from INT to BOOLEAN
    -- is_weekday: from INT to BOOLEAN
    -- year_month_numeric: from INT to VARCHAR
    SELECT
        "day_of_week",
        "month_name",
        "year_",
        "year_month_abbr",
        "day_number_in_week",
        "day_number_in_month",
        "day_number_in_year",
        "month_number",
        "week_number",
        "selling_season",
        CAST("date_key" AS VARCHAR) 
        AS "date_key",
        CASE
            WHEN regexp_full_match("full_date", 'April \d{1,2}, \d{4}') THEN CAST(strptime("full_date", '%B %-d, %Y') AS DATE)
            WHEN regexp_full_match("full_date", 'Augest \d{1,2}, \d{4}') THEN CAST(strptime(replace("full_date", 'Augest', 'August'), '%B %-d, %Y') AS DATE)
            WHEN regexp_full_match("full_date", 'December \d{1,2}, \d{4}') THEN CAST(strptime("full_date", '%B %-d, %Y') AS DATE)
            WHEN regexp_full_match("full_date", '(January|February|March|April|May|June|July|August|September|October|November|December) \d{1,2}, \d{4}') THEN CAST(strptime("full_date", '%B %d, %Y') AS DATE)
            WHEN regexp_full_match("full_date", 'Octorber \d{1,2}, \d{4}') THEN CAST(strptime(replace("full_date", 'Octorber', 'October'), '%B %d, %Y') AS DATE)
        END 
        AS "full_date",
        CAST("is_holiday" AS BOOLEAN) 
        AS "is_holiday",
        CAST("is_last_day_of_month" AS BOOLEAN) 
        AS "is_last_day_of_month",
        CAST("is_last_day_of_week" AS BOOLEAN) 
        AS "is_last_day_of_week",
        CAST("is_weekday" AS BOOLEAN) 
        AS "is_weekday",
        CAST("year_month_numeric" AS VARCHAR) 
        AS "year_month_numeric"
    FROM "date_renamed_cleaned"
)

-- COCOON BLOCK END
SELECT *
FROM "date_renamed_cleaned_casted"</code></pre>
</div>
<p class="text-center">stg_date.yml <small class="text-muted"> (Document the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">version: 2
models:
- name: stg_date
  description: The table is about calendar dates. It contains various attributes of
    dates including the date key, full date, day of week, month, year, and numeric
    representations. It also includes flags for special days like holidays, last day
    of week/month, and selling seasons. The table provides a comprehensive breakdown
    of date information for data analysis and reporting purposes.
  columns:
  - name: day_of_week
    description: Name of the day of the week
    tests:
    - not_null
    - accepted_values:
        values:
        - Saturday
        - Thursday
        - Friday
        - Monday
        - Sunday
        - Tuesday
        - Wednesday
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: month_name
    description: Name of the month
    tests:
    - not_null
    - accepted_values:
        values:
        - August
        - January
        - July
        - March
        - May
        - October
        - April
        - June
        - September
        - February
        - December
        - November
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: year_
    description: Year in YYYY format
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: year_month_abbr
    description: Year and month abbreviation
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: day_number_in_week
    description: Day number within the week (1-7)
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: day_number_in_month
    description: Day number within the month
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: day_number_in_year
    description: Day number within the year
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: month_number
    description: Month number within the year (1-12)
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: week_number
    description: Week number within the year
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: selling_season
    description: Current selling season (e.g., Winter)
    tests:
    - not_null
    - accepted_values:
        values:
        - Summer
        - Winter
        - Fall
        - Christmas
        - Spring
    cocoon_meta:
      future_accepted_values:
      - Back to School
      - Halloween
      - Valentine's Day
      - Easter
      data_type:
        current_data_type: VARCHAR
  - name: date_key
    description: Unique identifier for each date
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column is a unique identifier for each date. For this table,
        each row represents a specific date. The date_key appears to be a concatenation
        of year, month, and day, which would be unique across rows.
      data_type:
        current_data_type: VARCHAR
  - name: full_date
    description: Full date in 'Month Day, Year' format
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column represents the full date in 'YYYY-MM-DD' format.
        For this table, each row represents a specific date. The full_date would be
        unique across rows as it represents a distinct calendar date.
      data_type:
        current_data_type: DATE
  - name: is_holiday
    description: Flag for holiday
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: BOOLEAN
  - name: is_last_day_of_month
    description: Flag for last day of the month
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: BOOLEAN
  - name: is_last_day_of_week
    description: Flag for last day of the week
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: BOOLEAN
  - name: is_weekday
    description: Flag for weekday (Monday-Friday)
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: BOOLEAN
  - name: year_month_numeric
    description: Year and month in YYYYMM format
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  tests: []
</code></pre>
</div>

        </div>
        
        <div class="tab-pane fade " id="cocoon_stage_stg_part">
            <p class="subtitle text-center mb-3">stg_part</p>
            
<p class="text-center mb-0">Table Preview <small class="text-muted">(first 5 rows)</small></p>
<div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>part_id</th>
      <th>part_name</th>
      <th>manufacturer_code</th>
      <th>category_code</th>
      <th>brand_code</th>
      <th>color</th>
      <th>type_and_material</th>
      <th>size_</th>
      <th>container_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>moccasin royal</td>
      <td>MFGR#2</td>
      <td>MFGR#21</td>
      <td>MFGR#2128</td>
      <td>floral</td>
      <td>LARGE BURNISHED STEEL</td>
      <td>44</td>
      <td>LG CAN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>dark sky</td>
      <td>MFGR#3</td>
      <td>MFGR#34</td>
      <td>MFGR#3438</td>
      <td>navajo</td>
      <td>LARGE ANODIZED BRASS</td>
      <td>45</td>
      <td>LG CASE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>brown turquoise</td>
      <td>MFGR#5</td>
      <td>MFGR#54</td>
      <td>MFGR#5415</td>
      <td>deep</td>
      <td>PROMO PLATED TIN</td>
      <td>2</td>
      <td>MED PACK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>floral beige</td>
      <td>MFGR#4</td>
      <td>MFGR#44</td>
      <td>MFGR#4421</td>
      <td>medium</td>
      <td>PROMO POLISHED BRASS</td>
      <td>19</td>
      <td>LG DRUM</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>forest magenta</td>
      <td>MFGR#2</td>
      <td>MFGR#23</td>
      <td>MFGR#2336</td>
      <td>blush</td>
      <td>STANDARD BRUSHED COPPER</td>
      <td>3</td>
      <td>JUMBO BAG</td>
    </tr>
  </tbody>
</table></div>

<p class="text-center">stg_part.sql <small class="text-muted">(clean the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
-- Generated at 2024-08-26 00:51:15.538935+00:00
WITH 
"part_renamed" AS (
    -- Rename: Renaming columns
    -- P_PARTKEY -> part_id
    -- P_NAME -> part_name
    -- P_MFGR -> manufacturer_code
    -- P_CATEGORY -> category_code
    -- P_BRAND1 -> brand_code
    -- P_COLOR -> color
    -- P_TYPE -> type_and_material
    -- P_SIZE -> size_
    -- P_CONTAINER -> container_type
    SELECT 
        "P_PARTKEY" AS "part_id",
        "P_NAME" AS "part_name",
        "P_MFGR" AS "manufacturer_code",
        "P_CATEGORY" AS "category_code",
        "P_BRAND1" AS "brand_code",
        "P_COLOR" AS "color",
        "P_TYPE" AS "type_and_material",
        "P_SIZE" AS "size_",
        "P_CONTAINER" AS "container_type"
    FROM "memory"."main"."part"
)

-- COCOON BLOCK END
SELECT *
FROM "part_renamed"</code></pre>
</div>
<p class="text-center">stg_part.yml <small class="text-muted"> (Document the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">version: 2
models:
- name: stg_part
  description: The table is about parts. It contains details of various parts including
    their unique key, name, manufacturer, category, brand, color, type, size, and
    container. Each row represents a different part with its specific attributes.
    The table seems to be a catalog or inventory of parts with their characteristics
    and classifications.
  columns:
  - name: part_id
    description: Unique identifier for the part
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column represents a unique identifier for each part. For
        this table, each row represents a different part, and part_id appears to be
        unique across rows.
      data_type:
        current_data_type: INT
  - name: part_name
    description: Descriptive name of the part
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: ^[a-z]+ [a-z]+$
        summary: Two color names or descriptors separated by a space
      data_type:
        current_data_type: VARCHAR
  - name: manufacturer_code
    description: Manufacturer code of the part
    tests:
    - not_null
    - accepted_values:
        values:
        - MFGR#2
        - MFGR#4
        - MFGR#1
        - MFGR#5
        - MFGR#3
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: category_code
    description: Category code of the part
    tests:
    - not_null
    - accepted_values:
        values:
        - MFGR#23
        - MFGR#41
        - MFGR#14
        - MFGR#11
        - MFGR#24
        - MFGR#54
        - MFGR#53
        - MFGR#22
        - MFGR#45
        - MFGR#32
        - MFGR#42
        - MFGR#34
        - MFGR#51
        - MFGR#13
        - MFGR#31
        - MFGR#25
        - MFGR#21
        - MFGR#44
        - MFGR#43
        - MFGR#33
        - MFGR#52
        - MFGR#55
        - MFGR#35
        - MFGR#12
        - MFGR#15
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: brand_code
    description: Brand code of the part
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: MFGR#\d{3,4}
        summary: Manufacturer codes starting with "MFGR#" followed by 3 or 4 digits
      data_type:
        current_data_type: VARCHAR
  - name: color
    description: Color of the part
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: type_and_material
    description: Type and material of the part
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: (ECONOMY|MEDIUM|SMALL|LARGE|PROMO|STANDARD) (ANODIZED|POLISHED|PLATED|BURNISHED|BRUSHED)
          (STEEL|NICKEL|BRASS|COPPER|TIN)
        summary: Product type, treatment, and material in all caps
      data_type:
        current_data_type: VARCHAR
  - name: size_
    description: Size of the part
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: container_type
    description: Container type for the part
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  tests: []
</code></pre>
</div>

        </div>
        
        <div class="tab-pane fade " id="cocoon_stage_stg_customer">
            <p class="subtitle text-center mb-3">stg_customer</p>
            
<p class="text-center mb-0">Table Preview <small class="text-muted">(first 5 rows)</small></p>
<div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>customer_name</th>
      <th>city</th>
      <th>country</th>
      <th>region</th>
      <th>phone_number</th>
      <th>market_segment</th>
      <th>street_address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Customer#000000001</td>
      <td>MOROCCO</td>
      <td>MOROCCO</td>
      <td>AFRICA</td>
      <td>25-214-662-5265</td>
      <td>BUILDING</td>
      <td>j5JsirBM9P</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Customer#000000002</td>
      <td>JORDAN 5</td>
      <td>JORDAN</td>
      <td>MIDDLE EAST</td>
      <td>23-159-880-1131</td>
      <td>AUTOMOBILE</td>
      <td>487LW1dovn6Q4dMVym</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>Customer#000000004</td>
      <td>EGYPT</td>
      <td>EGYPT</td>
      <td>MIDDLE EAST</td>
      <td>14-108-116-4678</td>
      <td>MACHINERY</td>
      <td>4u58h f</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>Customer#000000005</td>
      <td>CANADA 2</td>
      <td>CANADA</td>
      <td>AMERICA</td>
      <td>13-360-101-6891</td>
      <td>HOUSEHOLD</td>
      <td>hwBtxkoBF qSW4KrI</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>Customer#000000007</td>
      <td>CHINA</td>
      <td>CHINA</td>
      <td>ASIA</td>
      <td>28-777-614-8279</td>
      <td>AUTOMOBILE</td>
      <td>8OkMVLQ1dK6Mbu6WG9</td>
    </tr>
  </tbody>
</table></div>

<p class="text-center">stg_customer.sql <small class="text-muted">(clean the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
-- Generated at 2024-08-26 00:47:19.528883+00:00
WITH 
"customer_renamed" AS (
    -- Rename: Renaming columns
    -- C_CUSTKEY -> customer_id
    -- C_NAME -> customer_name
    -- C_ADDRESS -> street_address
    -- C_CITY -> city
    -- C_NATION -> country
    -- C_REGION -> region
    -- C_PHONE -> phone_number
    -- C_MKTSEGMENT -> market_segment
    SELECT 
        "C_CUSTKEY" AS "customer_id",
        "C_NAME" AS "customer_name",
        "C_ADDRESS" AS "street_address",
        "C_CITY" AS "city",
        "C_NATION" AS "country",
        "C_REGION" AS "region",
        "C_PHONE" AS "phone_number",
        "C_MKTSEGMENT" AS "market_segment"
    FROM "memory"."main"."customer"
),

"customer_renamed_trimmed" AS (
    -- Trim Leading and Trailing Spaces
    SELECT
        "customer_id",
        "customer_name",
        "city",
        "country",
        "region",
        "phone_number",
        "market_segment",
        TRIM("street_address") AS "street_address"
    FROM "customer_renamed"
),

"customer_renamed_trimmed_cleaned" AS (
    -- Clean unusual string values: 
    -- city: The problem is that the city column contains country names followed by numbers, with inconsistent spacing and truncation. The country names should be standardized, and the numbers (which likely represent some kind of code or index) should be separated. "UNITED ST" is truncated and should be "UNITED STATES". "UNITED KI" should be "UNITED KINGDOM". "SAUDI ARA" should be "SAUDI ARABIA". The correct values should have consistent spacing between the country name and the number, with the country name in full.
    -- street_address: Values starting with commas are unusual. Random strings like '2z1 vZUo2qjaxg7qJouIBb' are not typical for street addresses.
    SELECT
        "customer_id",
        "customer_name",
        CASE
            WHEN "city" = 'UNITED ST4' THEN 'UNITED STATES 4'
            WHEN "city" = 'UNITED ST0' THEN 'UNITED STATES 0'
            WHEN "city" = 'UNITED ST1' THEN 'UNITED STATES 1'
            WHEN "city" = 'UNITED KI5' THEN 'UNITED KINGDOM 5'
            WHEN "city" = 'SAUDI ARA7' THEN 'SAUDI ARABIA 7'
            WHEN "city" = 'ARGENTINA4' THEN 'ARGENTINA 4'
            WHEN "city" = 'ARGENTINA5' THEN 'ARGENTINA 5'
            WHEN "city" = 'MOZAMBIQU7' THEN 'MOZAMBIQUE 7'
            WHEN "city" = 'MOZAMBIQU9' THEN 'MOZAMBIQUE 9'
            WHEN "city" = 'RUSSIA   5' THEN 'RUSSIA 5'
            WHEN "city" = 'RUSSIA   6' THEN 'RUSSIA 6'
            WHEN "city" = 'RUSSIA   3' THEN 'RUSSIA 3'
            WHEN "city" = 'MOROCCO  5' THEN 'MOROCCO 5'
            WHEN "city" = 'FRANCE   8' THEN 'FRANCE 8'
            WHEN "city" = 'JAPAN    3' THEN 'JAPAN 3'
            WHEN "city" = 'ALGERIA  8' THEN 'ALGERIA 8'
            WHEN "city" = 'ALGERIA  0' THEN 'ALGERIA 0'
            WHEN "city" = 'ALGERIA  5' THEN 'ALGERIA 5'
            WHEN "city" = 'CHINA    5' THEN 'CHINA 5'
            WHEN "city" = 'EGYPT    7' THEN 'EGYPT 7'
            WHEN "city" = 'EGYPT    1' THEN 'EGYPT 1'
            WHEN "city" = 'EGYPT    3' THEN 'EGYPT 3'
            WHEN "city" = 'JORDAN   5' THEN 'JORDAN 5'
            WHEN "city" = 'JORDAN   8' THEN 'JORDAN 8'
            WHEN "city" = 'KENYA    2' THEN 'KENYA 2'
            WHEN "city" = 'KENYA    9' THEN 'KENYA 9'
            WHEN "city" = 'PERU     8' THEN 'PERU 8'
            WHEN "city" = 'CANADA   2' THEN 'CANADA 2'
            WHEN "city" = 'CANADA   4' THEN 'CANADA 4'
            WHEN "city" = 'CANADA   9' THEN 'CANADA 9'
            WHEN "city" = 'CANADA   0' THEN 'CANADA 0'
            WHEN "city" = 'VIETNAM  0' THEN 'VIETNAM 0'
            WHEN "city" = 'GERMANY  0' THEN 'GERMANY 0'
            WHEN "city" = 'GERMANY  9' THEN 'GERMANY 9'
            WHEN "city" = 'GERMANY  4' THEN 'GERMANY 4'
            WHEN "city" = 'IRAN     4' THEN 'IRAN 4'
            WHEN "city" = 'IRAN     6' THEN 'IRAN 6'
            WHEN "city" = 'IRAN     7' THEN 'IRAN 7'
            WHEN "city" = 'IRAQ     4' THEN 'IRAQ 4'
            WHEN "city" = 'IRAQ     9' THEN 'IRAQ 9'
            WHEN "city" = 'IRAQ     5' THEN 'IRAQ 5'
            WHEN "city" = 'INDIA    8' THEN 'INDIA 8'
            WHEN "city" = 'INDONESIA1' THEN 'INDONESIA 1'
            WHEN "city" = 'INDONESIA3' THEN 'INDONESIA 3'
            WHEN "city" = 'BRAZIL   4' THEN 'BRAZIL 4'
            WHEN "city" = 'ROMANIA  4' THEN 'ROMANIA 4'
            WHEN "city" = 'ROMANIA  7' THEN 'ROMANIA 7'
            WHEN "city" = 'MOZAMBIQU2' THEN 'MOZAMBIQUE'
            WHEN "city" = 'ROMANIA  1' THEN 'ROMANIA'
            WHEN "city" = 'ROMANIA  3' THEN 'ROMANIA'
            WHEN "city" = 'VIETNAM  5' THEN 'VIETNAM'
            WHEN "city" = 'ARGENTINA2' THEN 'ARGENTINA'
            WHEN "city" = 'CHINA    2' THEN 'CHINA'
            WHEN "city" = 'CHINA    4' THEN 'CHINA'
            WHEN "city" = 'FRANCE   0' THEN 'FRANCE'
            WHEN "city" = 'JAPAN    9' THEN 'JAPAN'
            WHEN "city" = 'UNITED KI3' THEN 'UNITED KINGDOM'
            WHEN "city" = 'ALGERIA  2' THEN 'ALGERIA'
            WHEN "city" = 'ARGENTINA7' THEN 'ARGENTINA'
            WHEN "city" = 'BRAZIL   8' THEN 'BRAZIL'
            WHEN "city" = 'ETHIOPIA 8' THEN 'ETHIOPIA'
            WHEN "city" = 'FRANCE   6' THEN 'FRANCE'
            WHEN "city" = 'INDONESIA2' THEN 'INDONESIA'
            WHEN "city" = 'JORDAN   2' THEN 'JORDAN'
            WHEN "city" = 'KENYA    3' THEN 'KENYA'
            WHEN "city" = 'ROMANIA  5' THEN 'ROMANIA'
            WHEN "city" = 'UNITED KI0' THEN 'UNITED KINGDOM'
            WHEN "city" = 'ETHIOPIA 6' THEN 'ETHIOPIA'
            WHEN "city" = 'INDONESIA7' THEN 'INDONESIA'
            WHEN "city" = 'MOROCCO  4' THEN 'MOROCCO'
            WHEN "city" = 'MOROCCO  8' THEN 'MOROCCO'
            WHEN "city" = 'MOZAMBIQU1' THEN 'MOZAMBIQUE'
            WHEN "city" = 'MOZAMBIQU3' THEN 'MOZAMBIQUE'
            WHEN "city" = 'UNITED ST2' THEN 'UNITED STATES'
            WHEN "city" = 'UNITED ST5' THEN 'UNITED STATES'
            WHEN "city" = 'EGYPT    0' THEN 'EGYPT'
            WHEN "city" = 'EGYPT    8' THEN 'EGYPT'
            WHEN "city" = 'EGYPT    9' THEN 'EGYPT'
            WHEN "city" = 'INDIA    9' THEN 'INDIA'
            WHEN "city" = 'IRAN     1' THEN 'IRAN'
            WHEN "city" = 'IRAQ     3' THEN 'IRAQ'
            WHEN "city" = 'PERU     6' THEN 'PERU'
            WHEN "city" = 'UNITED ST6' THEN 'UNITED STATES'
            WHEN "city" = 'UNITED ST8' THEN 'UNITED STATES'
            WHEN "city" = 'CANADA   6' THEN 'CANADA'
            WHEN "city" = 'CHINA    0' THEN 'CHINA'
            WHEN "city" = 'CHINA    1' THEN 'CHINA'
            WHEN "city" = 'CHINA    3' THEN 'CHINA'
            WHEN "city" = 'GERMANY  6' THEN 'GERMANY'
            WHEN "city" = 'INDONESIA8' THEN 'INDONESIA'
            WHEN "city" = 'IRAQ     7' THEN 'IRAQ'
            WHEN "city" = 'JAPAN    1' THEN 'JAPAN'
            WHEN "city" = 'JAPAN    6' THEN 'JAPAN'
            WHEN "city" = 'ROMANIA  6' THEN 'ROMANIA'
            WHEN "city" = 'VIETNAM  1' THEN 'VIETNAM'
            WHEN "city" = 'ARGENTINA8' THEN 'ARGENTINA'
            WHEN "city" = 'GERMANY  7' THEN 'GERMANY'
            WHEN "city" = 'SAUDI ARA1' THEN 'SAUDI ARABIA 1'
            WHEN "city" = 'SAUDI ARA2' THEN 'SAUDI ARABIA 2'
            WHEN "city" = 'SAUDI ARA4' THEN 'SAUDI ARABIA 4'
            WHEN "city" = 'UNITED KI2' THEN 'UNITED KINGDOM 2'
            WHEN "city" = 'UNITED KI7' THEN 'UNITED KINGDOM 7'
            WHEN "city" = 'MOZAMBIQU5' THEN 'MOZAMBIQUE 5'
            WHEN "city" = 'INDONESIA6' THEN 'INDONESIA 6'
            WHEN "city" = 'IRAN     0' THEN 'IRAN 0'
            WHEN "city" = 'IRAQ     6' THEN 'IRAQ 6'
            WHEN "city" = 'KENYA    1' THEN 'KENYA 1'
            WHEN "city" = 'KENYA    7' THEN 'KENYA 7'
            WHEN "city" = 'MOROCCO  1' THEN 'MOROCCO 1'
            WHEN "city" = 'VIETNAM  2' THEN 'VIETNAM 2'
            WHEN "city" = 'BRAZIL   2' THEN 'BRAZIL 2'
            WHEN "city" = 'CANADA   3' THEN 'CANADA 3'
            WHEN "city" = 'CHINA    6' THEN 'CHINA 6'
            WHEN "city" = 'GERMANY  5' THEN 'GERMANY 5'
            WHEN "city" = 'INDIA    4' THEN 'INDIA 4'
            WHEN "city" = 'IRAN     3' THEN 'IRAN 3'
            WHEN "city" = 'JAPAN    0' THEN 'JAPAN 0'
            WHEN "city" = 'JORDAN   3' THEN 'JORDAN 3'
            WHEN "city" = 'MOROCCO  9' THEN 'MOROCCO 9'
            WHEN "city" = 'VIETNAM  8' THEN 'VIETNAM 8'
            WHEN "city" = 'ARGENTINA3' THEN 'ARGENTINA 3'
            WHEN "city" = 'CHINA    9' THEN 'CHINA 9'
            WHEN "city" = 'FRANCE   2' THEN 'FRANCE 2'
            WHEN "city" = 'GERMANY  8' THEN 'GERMANY 8'
            WHEN "city" = 'INDIA    3' THEN 'INDIA 3'
            WHEN "city" = 'INDIA    7' THEN 'INDIA 7'
            WHEN "city" = 'JORDAN   1' THEN 'JORDAN 1'
            WHEN "city" = 'JORDAN   7' THEN 'JORDAN 7'
            WHEN "city" = 'KENYA    0' THEN 'KENYA 0'
            WHEN "city" = 'PERU     0' THEN 'PERU 0'
            WHEN "city" = 'BRAZIL   0' THEN 'BRAZIL 0'
            WHEN "city" = 'BRAZIL   7' THEN 'BRAZIL 7'
            WHEN "city" = 'FRANCE   9' THEN 'FRANCE 9'
            WHEN "city" = 'IRAN     5' THEN 'IRAN 5'
            WHEN "city" = 'JAPAN    5' THEN 'JAPAN 5'
            WHEN "city" = 'KENYA    8' THEN 'KENYA 8'
            WHEN "city" = 'MOROCCO  6' THEN 'MOROCCO 6'
            WHEN "city" = 'RUSSIA   9' THEN 'RUSSIA 9'
            WHEN "city" = 'CANADA   1' THEN 'CANADA 1'
            WHEN "city" = 'EGYPT    5' THEN 'EGYPT 5'
            WHEN "city" = 'INDIA    0' THEN 'INDIA 0'
            WHEN "city" = 'INDONESIA5' THEN 'INDONESIA 5'
            WHEN "city" = 'IRAN     9' THEN 'IRAN 9'
            WHEN "city" = 'JORDAN   6' THEN 'JORDAN 6'
            WHEN "city" = 'PERU     4' THEN 'PERU 4'
            WHEN "city" = 'PERU     9' THEN 'PERU'
            WHEN "city" = 'RUSSIA   4' THEN 'RUSSIA'
            WHEN "city" = 'RUSSIA   7' THEN 'RUSSIA'
            WHEN "city" = 'SAUDI ARA9' THEN 'SAUDI ARABIA'
            WHEN "city" = 'UNITED KI1' THEN 'UNITED KINGDOM'
            WHEN "city" = 'ALGERIA  1' THEN 'ALGERIA'
            WHEN "city" = 'CHINA    8' THEN 'CHINA'
            WHEN "city" = 'FRANCE   5' THEN 'FRANCE'
            WHEN "city" = 'GERMANY  1' THEN 'GERMANY'
            WHEN "city" = 'INDIA    1' THEN 'INDIA'
            WHEN "city" = 'IRAN     8' THEN 'IRAN'
            WHEN "city" = 'KENYA    6' THEN 'KENYA'
            WHEN "city" = 'ROMANIA  2' THEN 'ROMANIA'
            WHEN "city" = 'RUSSIA   8' THEN 'RUSSIA'
            WHEN "city" = 'UNITED KI8' THEN 'UNITED KINGDOM'
            WHEN "city" = 'VIETNAM  6' THEN 'VIETNAM'
            WHEN "city" = 'VIETNAM  9' THEN 'VIETNAM'
            WHEN "city" = 'ARGENTINA0' THEN 'ARGENTINA'
            WHEN "city" = 'BRAZIL   6' THEN 'BRAZIL'
            WHEN "city" = 'ETHIOPIA 0' THEN 'ETHIOPIA'
            WHEN "city" = 'ETHIOPIA 1' THEN 'ETHIOPIA'
            WHEN "city" = 'FRANCE   3' THEN 'FRANCE'
            WHEN "city" = 'FRANCE   7' THEN 'FRANCE'
            WHEN "city" = 'GERMANY  2' THEN 'GERMANY'
            WHEN "city" = 'INDONESIA0' THEN 'INDONESIA'
            WHEN "city" = 'IRAN     2' THEN 'IRAN'
            WHEN "city" = 'IRAQ     1' THEN 'IRAQ'
            WHEN "city" = 'IRAQ     8' THEN 'IRAQ'
            WHEN "city" = 'KENYA    5' THEN 'KENYA'
            WHEN "city" = 'MOZAMBIQU8' THEN 'MOZAMBIQUE'
            WHEN "city" = 'PERU     3' THEN 'PERU'
            WHEN "city" = 'UNITED KI4' THEN 'UNITED KINGDOM'
            WHEN "city" = 'ALGERIA  7' THEN 'ALGERIA'
            WHEN "city" = 'CANADA   7' THEN 'CANADA'
            WHEN "city" = 'CANADA   8' THEN 'CANADA'
            WHEN "city" = 'IRAQ     2' THEN 'IRAQ'
            WHEN "city" = 'SAUDI ARA5' THEN 'SAUDI ARABIA'
            WHEN "city" = 'UNITED ST9' THEN 'UNITED STATES'
            WHEN "city" = 'VIETNAM  4' THEN 'VIETNAM'
            WHEN "city" = 'GERMANY  3' THEN 'GERMANY'
            WHEN "city" = 'IRAQ     0' THEN 'IRAQ'
            WHEN "city" = 'JORDAN   0' THEN 'JORDAN'
            WHEN "city" = 'MOROCCO  0' THEN 'MOROCCO'
            WHEN "city" = 'MOROCCO  3' THEN 'MOROCCO'
            WHEN "city" = 'ROMANIA  9' THEN 'ROMANIA'
            WHEN "city" = 'SAUDI ARA3' THEN 'SAUDI ARABIA'
            WHEN "city" = 'UNITED KI9' THEN 'UNITED KINGDOM'
            WHEN "city" = 'UNITED ST7' THEN 'UNITED STATES'
            WHEN "city" = 'BRAZIL   1' THEN 'BRAZIL'
            WHEN "city" = 'BRAZIL   9' THEN 'BRAZIL'
            WHEN "city" = 'EGYPT    6' THEN 'EGYPT'
            WHEN "city" = 'FRANCE   4' THEN 'FRANCE'
            WHEN "city" = 'JAPAN    7' THEN 'JAPAN'
            WHEN "city" = 'JAPAN    8' THEN 'JAPAN'
            WHEN "city" = 'MOZAMBIQU6' THEN 'MOZAMBIQUE'
            WHEN "city" = 'PERU     5' THEN 'PERU'
            WHEN "city" = 'PERU     7' THEN 'PERU'
            WHEN "city" = 'RUSSIA   2' THEN 'RUSSIA'
            WHEN "city" = 'UNITED KI6' THEN 'UNITED KINGDOM'
            WHEN "city" = 'ARGENTINA1' THEN 'ARGENTINA'
            WHEN "city" = 'BRAZIL   5' THEN 'BRAZIL'
            WHEN "city" = 'CHINA    7' THEN 'CHINA'
            WHEN "city" = 'FRANCE   1' THEN 'FRANCE'
            WHEN "city" = 'INDIA    5' THEN 'INDIA'
            WHEN "city" = 'JAPAN    2' THEN 'JAPAN'
            WHEN "city" = 'JORDAN   9' THEN 'JORDAN'
            WHEN "city" = 'UNITED ST3' THEN 'UNITED STATES'
            WHEN "city" = 'ALGERIA  4' THEN 'ALGERIA'
            WHEN "city" = 'ARGENTINA6' THEN 'ARGENTINA'
            WHEN "city" = 'INDONESIA9' THEN 'INDONESIA'
            WHEN "city" = 'MOROCCO  2' THEN 'MOROCCO'
            WHEN "city" = 'PERU     1' THEN 'PERU'
            WHEN "city" = 'ROMANIA  0' THEN 'ROMANIA'
            WHEN "city" = 'RUSSIA   1' THEN 'RUSSIA'
            WHEN "city" = 'INDIA    6' THEN 'INDIA'
            WHEN "city" = 'INDONESIA4' THEN 'INDONESIA'
            WHEN "city" = 'PERU     2' THEN 'PERU'
            WHEN "city" = 'SAUDI ARA6' THEN 'SAUDI ARABIA'
            WHEN "city" = 'VIETNAM  7' THEN 'VIETNAM'
            WHEN "city" = 'BRAZIL   3' THEN 'BRAZIL'
            WHEN "city" = 'EGYPT    2' THEN 'EGYPT'
            WHEN "city" = 'EGYPT    4' THEN 'EGYPT'
            WHEN "city" = 'ETHIOPIA 4' THEN 'ETHIOPIA'
            WHEN "city" = 'SAUDI ARA8' THEN 'SAUDI ARABIA'
            WHEN "city" = 'ETHIOPIA 2' THEN 'ETHIOPIA'
            WHEN "city" = 'MOZAMBIQU4' THEN 'MOZAMBIQUE'
            WHEN "city" = 'ROMANIA  8' THEN 'ROMANIA'
            WHEN "city" = 'JAPAN    4' THEN 'JAPAN'
            WHEN "city" = 'VIETNAM  3' THEN 'VIETNAM'
            WHEN "city" = 'INDIA    2' THEN 'INDIA'
            WHEN "city" = 'JORDAN   4' THEN 'JORDAN'
            WHEN "city" = 'ALGERIA  3' THEN 'ALGERIA'
            WHEN "city" = 'ALGERIA  9' THEN 'ALGERIA'
            WHEN "city" = 'KENYA    4' THEN 'KENYA'
            WHEN "city" = 'MOZAMBIQU0' THEN 'MOZAMBIQUE'
            WHEN "city" = 'RUSSIA   0' THEN 'RUSSIA'
            WHEN "city" = 'SAUDI ARA0' THEN 'SAUDI ARABIA'
            WHEN "city" = 'ALGERIA  6' THEN 'ALGERIA'
            WHEN "city" = 'MOROCCO  7' THEN 'MOROCCO'
            WHEN "city" = 'CANADA   5' THEN 'CANADA'
            ELSE "city"
        END AS "city",
        "country",
        "region",
        "phone_number",
        "market_segment",
        "street_address"
    FROM "customer_renamed_trimmed"
)

-- COCOON BLOCK END
SELECT *
FROM "customer_renamed_trimmed_cleaned"</code></pre>
</div>
<p class="text-center">stg_customer.yml <small class="text-muted"> (Document the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">version: 2
models:
- name: stg_customer
  description: The table is about customers. It contains customer details including
    a unique customer key, name, address, city, nation, region, phone number, and
    market segment. Each row represents a single customer with their specific information.
    The table appears to be part of a larger database system, likely for managing
    customer information in a business context.
  columns:
  - name: customer_id
    description: Unique identifier for each customer
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column represents a unique identifier for each customer.
        For this table, each row is for a single customer. customer_id appears to
        be unique across rows, as it's formatted as "Customer#000000001", "Customer#000000002",
        etc.
      data_type:
        current_data_type: INT
  - name: customer_name
    description: Customer's full name
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: Customer#\d{9}
        summary: Customer IDs in the format of Customer# followed by a 9-digit number
      data_type:
        current_data_type: VARCHAR
  - name: city
    description: Customer's city of residence
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: '[A-Z ]+\s\d$'
        summary: Country name followed by a space and a single digit
      - regex: ^[A-Z ]+$
        summary: Country name only
      - regex: ARGENTINA\d
        summary: Text starting with "ARGENTINA" followed by a single digit
      data_type:
        current_data_type: VARCHAR
  - name: country
    description: Customer's country of residence
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: region
    description: Geographical region of the customer
    tests:
    - not_null
    - accepted_values:
        values:
        - EUROPE
        - AMERICA
        - MIDDLE EAST
        - ASIA
        - AFRICA
    cocoon_meta:
      future_accepted_values:
      - OCEANIA
      - ANTARCTICA
      - CARIBBEAN
      - CENTRAL AMERICA
      - SOUTH AMERICA
      data_type:
        current_data_type: VARCHAR
  - name: phone_number
    description: Customer's phone number
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: \d{2}-\d{3}-\d{3}-\d{4}
        summary: Phone numbers in the format of XX-XXX-XXX-XXXX, where X represents
          a digit
      data_type:
        current_data_type: VARCHAR
  - name: market_segment
    description: Market segment the customer belongs to
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: street_address
    description: Customer's street address
    tests:
    - not_null
    cocoon_meta:
      unusual_values: Values starting with commas are unusual. Random strings like
        '2z1 vZUo2qjaxg7qJouIBb' are not typical for street addresses.
      data_type:
        current_data_type: VARCHAR
  tests: []
</code></pre>
</div>

        </div>
        
        <div class="tab-pane fade " id="cocoon_stage_stg_supplier">
            <p class="subtitle text-center mb-3">stg_supplier</p>
            
<p class="text-center mb-0">Table Preview <small class="text-muted">(first 5 rows)</small></p>
<div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>supplier_id</th>
      <th>supplier_name</th>
      <th>city</th>
      <th>country</th>
      <th>region</th>
      <th>phone_number</th>
      <th>street_address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Supplier#000000001</td>
      <td>PERU     7</td>
      <td>PERU</td>
      <td>AMERICA</td>
      <td>27-989-741-2988</td>
      <td>sdrGnXCDRcfriBvY0KL,i</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Supplier#000000002</td>
      <td>ETHIOPIA 2</td>
      <td>ETHIOPIA</td>
      <td>AFRICA</td>
      <td>15-768-687-3665</td>
      <td>TRMhVHz3XiFu</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Supplier#000000003</td>
      <td>ARGENTINA 8</td>
      <td>ARGENTINA</td>
      <td>AMERICA</td>
      <td>11-719-748-3364</td>
      <td>BZ0kXcHUcHjx62L7CjZS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Supplier#000000004</td>
      <td>MOROCCO  5</td>
      <td>MOROCCO</td>
      <td>AFRICA</td>
      <td>25-128-190-5944</td>
      <td>qGTQJXogS83a7MB</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Supplier#000000005</td>
      <td>IRAQ     1</td>
      <td>IRAQ</td>
      <td>MIDDLE EAST</td>
      <td>21-750-942-6364</td>
      <td>lONEYAh9sF</td>
    </tr>
  </tbody>
</table></div>

<p class="text-center">stg_supplier.sql <small class="text-muted">(clean the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
-- Generated at 2024-08-26 00:52:51.226296+00:00
WITH 
"supplier_renamed" AS (
    -- Rename: Renaming columns
    -- S_SUPPKEY -> supplier_id
    -- S_NAME -> supplier_name
    -- S_ADDRESS -> street_address
    -- S_CITY -> city
    -- S_NATION -> country
    -- S_REGION -> region
    -- S_PHONE -> phone_number
    SELECT 
        "S_SUPPKEY" AS "supplier_id",
        "S_NAME" AS "supplier_name",
        "S_ADDRESS" AS "street_address",
        "S_CITY" AS "city",
        "S_NATION" AS "country",
        "S_REGION" AS "region",
        "S_PHONE" AS "phone_number"
    FROM "memory"."main"."supplier"
),

"supplier_renamed_trimmed" AS (
    -- Trim Leading and Trailing Spaces
    SELECT
        "supplier_id",
        "supplier_name",
        "city",
        "country",
        "region",
        "phone_number",
        TRIM("street_address") AS "street_address"
    FROM "supplier_renamed"
),

"supplier_renamed_trimmed_cleaned" AS (
    -- Clean unusual string values: 
    -- city: The problem is that some city names are truncated or have inconsistent spacing. The "SAUDI ARA" entries are truncated and should be "SAUDI ARABIA". The "INDONESIA" entries have inconsistent spacing, with "INDONESIA4" having no space and "INDONESIA1" having one space. All other entries have 2 spaces between the country name and number. The correct values should have consistent formatting with 2 spaces between the country name and number for all entries.
    -- street_address: All values are unusual because they start with commas and consist of random alphanumeric strings instead of typical address components.
    SELECT
        "supplier_id",
        "supplier_name",
        CASE
            WHEN "city" = 'INDONESIA4' THEN 'INDONESIA 4'
            WHEN "city" = 'INDONESIA1' THEN 'INDONESIA 1'
            WHEN "city" = 'SAUDI ARA0' THEN 'SAUDI ARABIA 0'
            WHEN "city" = 'SAUDI ARA7' THEN 'SAUDI ARABIA 7'
            WHEN "city" = 'SAUDI ARA5' THEN 'SAUDI ARABIA 5'
            WHEN "city" = 'SAUDI ARA8' THEN 'SAUDI ARABIA 8'
            WHEN "city" = 'SAUDI ARA1' THEN 'SAUDI ARA 1'
            WHEN "city" = 'SAUDI ARA6' THEN 'SAUDI ARA 6'
            WHEN "city" = 'INDONESIA8' THEN 'INDONESIA 8'
            WHEN "city" = 'INDONESIA3' THEN 'INDONESIA 3'
            WHEN "city" = 'INDONESIA7' THEN 'INDONESIA 7'
            WHEN "city" = 'INDONESIA9' THEN 'INDONESIA 9'
            WHEN "city" = 'INDONESIA0' THEN 'INDONESIA 0'
            WHEN "city" = 'UNITED KI9' THEN 'UNITED KI 9'
            WHEN "city" = 'UNITED ST0' THEN 'UNITED ST 0'
            WHEN "city" = 'UNITED ST8' THEN 'UNITED ST 8'
            WHEN "city" = 'UNITED ST9' THEN 'UNITED ST 9'
            WHEN "city" = 'ARGENTINA7' THEN 'ARGENTINA 7'
            WHEN "city" = 'ARGENTINA8' THEN 'ARGENTINA 8'
            WHEN "city" = 'SAUDI ARA2' THEN 'SAUDI AR 2'
            WHEN "city" = 'SAUDI ARA9' THEN 'SAUDI AR 9'
            WHEN "city" = 'INDONESIA2' THEN 'INDONESI 2'
            WHEN "city" = 'UNITED ST4' THEN 'UNITED S 4'
            WHEN "city" = 'UNITED ST5' THEN 'UNITED S 5'
            WHEN "city" = 'UNITED ST6' THEN 'UNITED S 6'
            WHEN "city" = 'UNITED ST7' THEN 'UNITED S 7'
            WHEN "city" = 'UNITED KI0' THEN 'UNITED K 0'
            WHEN "city" = 'MOZAMBIQU2' THEN 'MOZAMBIQ 2'
            WHEN "city" = 'MOZAMBIQU6' THEN 'MOZAMBIQ 6'
            WHEN "city" = 'INDONESIA5' THEN 'INDONESIA 5'
            WHEN "city" = 'INDONESIA6' THEN 'INDONESIA 6'
            ELSE "city"
        END AS "city",
        "country",
        "region",
        "phone_number",
        "street_address"
    FROM "supplier_renamed_trimmed"
)

-- COCOON BLOCK END
SELECT *
FROM "supplier_renamed_trimmed_cleaned"</code></pre>
</div>
<p class="text-center">stg_supplier.yml <small class="text-muted"> (Document the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">version: 2
models:
- name: stg_supplier
  description: The table is about suppliers. It contains details of each supplier
    including their unique key, name, address, city, nation, region, and phone number.
    Each row represents a single supplier with their specific information. The table
    appears to be a part of a larger database system, likely used for supply chain
    management or procurement processes.
  columns:
  - name: supplier_id
    description: Unique identifier for the supplier
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column represents a unique identifier for each supplier.
        For this table, each row represents a single supplier, and supplier_id appears
        to be unique across rows.
      data_type:
        current_data_type: INT
  - name: supplier_name
    description: Name of the supplier
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: Supplier#\d{9}
        summary: Supplier names in the format of "Supplier#" followed by a 9-digit
          number
      data_type:
        current_data_type: VARCHAR
  - name: city
    description: City where the supplier is located
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: '[A-Z\s]{3,14}\s\d'
        summary: Country name (uppercase, potentially truncated) followed by space
          and single digit
      - regex: '[A-Z\s]{5,11}\d'
        summary: Abbreviated country names (in uppercase) followed by a single digit
      data_type:
        current_data_type: VARCHAR
  - name: country
    description: Country where the supplier is based
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: region
    description: Geographical region of the supplier
    tests:
    - not_null
    - accepted_values:
        values:
        - ASIA
        - MIDDLE EAST
        - AFRICA
        - EUROPE
        - AMERICA
    cocoon_meta:
      future_accepted_values:
      - NORTH AMERICA
      - SOUTH AMERICA
      - OCEANIA
      data_type:
        current_data_type: VARCHAR
  - name: phone_number
    description: Contact phone number for the supplier
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: 1[01]-\d{3}-\d{3}-\d{4}
        summary: Phone numbers in the format of XX-XXX-XXX-XXXX, where X is a digit
      - regex: \d{2}-\d{3}-\d{3}-\d{4}
        summary: Phone numbers in the format of 12-xxx-xxx-xxxx where x represents
          digits
      data_type:
        current_data_type: VARCHAR
  - name: street_address
    description: Street address of the supplier
    tests:
    - not_null
    cocoon_meta:
      unusual_values: All values are unusual because they start with commas and consist
        of random alphanumeric strings instead of typical address components.
      patterns:
      - regex: ^,[\w\s]+$
        summary: Values starting with a comma followed by alphanumeric characters
          and spaces
      - regex: ^\d+,[\w\s]+$
        summary: Values starting with digits followed by a comma and alphanumeric
          characters
      - regex: ^[\w\s,]+$
        summary: Alphanumeric strings with possible spaces and commas
      data_type:
        current_data_type: VARCHAR
  tests: []
</code></pre>
</div>

        </div>
        
        <div class="tab-pane fade " id="cocoon_stage_stg_lineorder">
            <p class="subtitle text-center mb-3">stg_lineorder</p>
            
<p class="text-center mb-0">Table Preview <small class="text-muted">(first 5 rows)</small></p>
<div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_priority</th>
      <th>quantity</th>
      <th>shipping_mode</th>
      <th>line_number</th>
      <th>shipping_priority</th>
      <th>product_id</th>
      <th>order_id</th>
      <th>customer_id</th>
      <th>supplier_id</th>
      <th>commit_date</th>
      <th>discount_percentage</th>
      <th>line_item_revenue</th>
      <th>line_item_total</th>
      <th>order_date</th>
      <th>order_total</th>
      <th>supply_cost</th>
      <th>tax_percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>13</td>
      <td>REG AIR</td>
      <td>7</td>
      <td>0</td>
      <td>99546</td>
      <td>277316</td>
      <td>19190</td>
      <td>1170</td>
      <td>1995-05-25</td>
      <td>0.0</td>
      <td>2009202.0</td>
      <td>2009202.0</td>
      <td>1995-02-28</td>
      <td>23455557.0</td>
      <td>92732.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1-URGENT</td>
      <td>14</td>
      <td>SHIP</td>
      <td>4</td>
      <td>0</td>
      <td>48214</td>
      <td>5929219</td>
      <td>28511</td>
      <td>1427</td>
      <td>1998-09-22</td>
      <td>4.0</td>
      <td>1562010.0</td>
      <td>1627094.0</td>
      <td>1998-07-02</td>
      <td>20688659.0</td>
      <td>69732.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2-HIGH</td>
      <td>4</td>
      <td>FOB</td>
      <td>4</td>
      <td>0</td>
      <td>100325</td>
      <td>3693318</td>
      <td>15811</td>
      <td>1170</td>
      <td>1992-10-13</td>
      <td>9.0</td>
      <td>482416.0</td>
      <td>530128.0</td>
      <td>1992-08-07</td>
      <td>19688727.0</td>
      <td>79519.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>None</td>
      <td>15</td>
      <td>MAIL</td>
      <td>2</td>
      <td>0</td>
      <td>126666</td>
      <td>2765669</td>
      <td>2258</td>
      <td>35</td>
      <td>1992-07-03</td>
      <td>8.0</td>
      <td>2335870.0</td>
      <td>2538990.0</td>
      <td>1992-05-04</td>
      <td>3523267.0</td>
      <td>101559.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1-URGENT</td>
      <td>17</td>
      <td>TRUCK</td>
      <td>1</td>
      <td>0</td>
      <td>172615</td>
      <td>686017</td>
      <td>23836</td>
      <td>804</td>
      <td>1995-12-13</td>
      <td>7.0</td>
      <td>2668111.0</td>
      <td>2868937.0</td>
      <td>1995-10-14</td>
      <td>4014677.0</td>
      <td>101256.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table></div>

<p class="text-center">stg_lineorder.sql <small class="text-muted">(clean the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
-- Generated at 2024-08-26 00:50:02.289320+00:00
WITH 
"lineorder_renamed" AS (
    -- Rename: Renaming columns
    -- LO_ORDERKEY -> order_id
    -- LO_LINENUMBER -> line_number
    -- LO_CUSTKEY -> customer_id
    -- LO_PARTKEY -> product_id
    -- LO_SUPPKEY -> supplier_id
    -- LO_ORDERDATE -> order_date
    -- LO_ORDERPRIORITY -> order_priority
    -- LO_SHIPPRIORITY -> shipping_priority
    -- LO_QUANTITY -> quantity
    -- LO_EXTENDEDPRICE -> line_item_total
    -- LO_ORDTOTALPRICE -> order_total
    -- LO_DISCOUNT -> discount_percentage
    -- LO_REVENUE -> line_item_revenue
    -- LO_SUPPLYCOST -> supply_cost
    -- LO_TAX -> tax_percentage
    -- LO_COMMITDATE -> commit_date
    -- LO_SHIPMODE -> shipping_mode
    SELECT 
        "LO_ORDERKEY" AS "order_id",
        "LO_LINENUMBER" AS "line_number",
        "LO_CUSTKEY" AS "customer_id",
        "LO_PARTKEY" AS "product_id",
        "LO_SUPPKEY" AS "supplier_id",
        "LO_ORDERDATE" AS "order_date",
        "LO_ORDERPRIORITY" AS "order_priority",
        "LO_SHIPPRIORITY" AS "shipping_priority",
        "LO_QUANTITY" AS "quantity",
        "LO_EXTENDEDPRICE" AS "line_item_total",
        "LO_ORDTOTALPRICE" AS "order_total",
        "LO_DISCOUNT" AS "discount_percentage",
        "LO_REVENUE" AS "line_item_revenue",
        "LO_SUPPLYCOST" AS "supply_cost",
        "LO_TAX" AS "tax_percentage",
        "LO_COMMITDATE" AS "commit_date",
        "LO_SHIPMODE" AS "shipping_mode"
    FROM "memory"."main"."lineorder"
),

"lineorder_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- order_priority: ['4-NOT SPECIFIED']
    SELECT 
        CASE
            WHEN "order_priority" = '4-NOT SPECIFIED' THEN NULL
            ELSE "order_priority"
        END AS "order_priority",
        "supply_cost",
        "quantity",
        "line_item_total",
        "tax_percentage",
        "commit_date",
        "shipping_mode",
        "line_number",
        "shipping_priority",
        "product_id",
        "discount_percentage",
        "order_id",
        "customer_id",
        "order_total",
        "line_item_revenue",
        "order_date",
        "supplier_id"
    FROM "lineorder_renamed"
),

"lineorder_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- commit_date: from INT to DATE
    -- discount_percentage: from INT to DECIMAL
    -- line_item_revenue: from INT to DECIMAL
    -- line_item_total: from INT to DECIMAL
    -- order_date: from INT to DATE
    -- order_total: from INT to DECIMAL
    -- supply_cost: from INT to DECIMAL
    -- tax_percentage: from INT to DECIMAL
    SELECT
        "order_priority",
        "quantity",
        "shipping_mode",
        "line_number",
        "shipping_priority",
        "product_id",
        "order_id",
        "customer_id",
        "supplier_id",
        strptime(CAST("commit_date" AS VARCHAR), '%Y%m%d') 
        AS "commit_date",
        CAST("discount_percentage" AS DECIMAL) 
        AS "discount_percentage",
        CAST("line_item_revenue" AS DECIMAL) 
        AS "line_item_revenue",
        CAST("line_item_total" AS DECIMAL) 
        AS "line_item_total",
        strptime(CAST("order_date" AS VARCHAR), '%Y%m%d') 
        AS "order_date",
        CAST("order_total" AS DECIMAL) 
        AS "order_total",
        CAST("supply_cost" AS DECIMAL) 
        AS "supply_cost",
        CAST("tax_percentage" AS DECIMAL) 
        AS "tax_percentage"
    FROM "lineorder_renamed_null"
)

-- COCOON BLOCK END
SELECT *
FROM "lineorder_renamed_null_casted"</code></pre>
</div>
<p class="text-center">stg_lineorder.yml <small class="text-muted"> (Document the table)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">version: 2
models:
- name: stg_lineorder
  description: The table is about line items in orders. It includes order details
    like order key, line number, customer key, part key, supplier key, and order date.
    It also contains shipping information, quantities, prices, discounts, and revenue.
    The table provides a comprehensive view of each line item in an order, including
    financial and logistical aspects.
  columns:
  - name: order_priority
    description: Priority level of the order
    tests:
    - accepted_values:
        values:
        - 5-LOW
        - 2-HIGH
        - 1-URGENT
        - 3-MEDIUM
    cocoon_meta:
      missing_reason: Not applicable for non-priority or standard orders.
      future_accepted_values:
      - 4-NORMAL
      data_type:
        current_data_type: VARCHAR
  - name: quantity
    description: Quantity of items ordered
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: shipping_mode
    description: Mode of shipping for the line item
    tests:
    - not_null
    - accepted_values:
        values:
        - REG AIR
        - FOB
        - SHIP
        - TRUCK
        - AIR
        - RAIL
        - MAIL
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: line_number
    description: Line item number within an order
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: shipping_priority
    description: Priority level for shipping the order
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: product_id
    description: Unique identifier for the product or part
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: order_id
    description: Unique identifier for each order
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: customer_id
    description: Unique identifier for the customer
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: supplier_id
    description: Unique identifier for the supplier
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: commit_date
    description: Committed delivery date for the line item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: TIMESTAMP
        expected_data_type: DATE
  - name: discount_percentage
    description: Discount percentage applied to the line item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: line_item_revenue
    description: Revenue generated from the line item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: line_item_total
    description: Total price for the line item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: order_date
    description: Date when the order was placed
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: TIMESTAMP
        expected_data_type: DATE
  - name: order_total
    description: Total price for the entire order
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: supply_cost
    description: Cost of supplying the item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: tax_percentage
    description: Tax percentage applied to the line item
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  tests: []
</code></pre>
</div>

        </div>
        
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_steps_join">
            <nav class="navbar navbar-light bg-light">
                <span class="navbar-brand mb-0">
                    <h5 class="card-title mb-0">Integration</h5>
                </span>
                
            </nav>
            <div class="container">
                <small class="text-muted">We identify the primary key (PK) and foreign key (FK) from tables. We build a join graph that connects FK to PK.</small>
            </div>
            <hr>
            <div class="scroll-container overflow-auto">
                <div class="tab-content mt-3">
                    
<p class="text-center">Join Graph <small class="text-muted">(FK to PK)</small></p>
<div class="container mb-4">
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="186pt" height="88pt"
 viewBox="0.00 0.00 185.50 88.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-84 181.5,-84 181.5,4 -4,4"/>
<!-- stg_lineorder_0 -->
<g id="node1" class="node">
<title>stg_lineorder_0</title>
<polygon fill="#ffffff" stroke="#000000" points="113,-80 59,-80 59,-58 113,-58 113,-80"/>
<text text-anchor="middle" x="86" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_lineorder</text>
</g>
<!-- stg_supplier_1 -->
<g id="node2" class="node">
<title>stg_supplier_1</title>
<polygon fill="#ffffff" stroke="#000000" points="50,-22 0,-22 0,0 50,0 50,-22"/>
<text text-anchor="middle" x="25" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_supplier</text>
</g>
<!-- stg_lineorder_0&#45;&gt;stg_supplier_1 -->
<g id="edge3" class="edge">
<title>stg_lineorder_0&#45;&gt;stg_supplier_1</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M75.09,-57.99C65.58,-49.26 51.67,-36.48 40.91,-26.61"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="42.06,-24.81 36.22,-22.3 39.22,-27.91 42.06,-24.81"/>
</g>
<!-- stg_part_2 -->
<g id="node3" class="node">
<title>stg_part_2</title>
<polygon fill="#ffffff" stroke="#000000" points="104,-22 68,-22 68,0 104,0 104,-22"/>
<text text-anchor="middle" x="86" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_part</text>
</g>
<!-- stg_lineorder_0&#45;&gt;stg_part_2 -->
<g id="edge2" class="edge">
<title>stg_lineorder_0&#45;&gt;stg_part_2</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M86,-57.99C86,-49.81 86,-38.08 86,-28.51"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="88.1,-28.3 86,-22.3 83.9,-28.3 88.1,-28.3"/>
</g>
<!-- stg_customer_3 -->
<g id="node4" class="node">
<title>stg_customer_3</title>
<polygon fill="#ffffff" stroke="#000000" points="177.5,-22 122.5,-22 122.5,0 177.5,0 177.5,-22"/>
<text text-anchor="middle" x="150" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_customer</text>
</g>
<!-- stg_lineorder_0&#45;&gt;stg_customer_3 -->
<g id="edge1" class="edge">
<title>stg_lineorder_0&#45;&gt;stg_customer_3</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M97.44,-57.99C107.51,-49.18 122.28,-36.25 133.61,-26.34"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="135.09,-27.84 138.22,-22.3 132.33,-24.67 135.09,-27.84"/>
</g>
<!-- stg_date_4 -->
<g id="node5" class="node">
<title>stg_date_4</title>
<polygon fill="#ffffff" stroke="#000000" points="167,-80 131,-80 131,-58 167,-58 167,-80"/>
<text text-anchor="middle" x="149" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_date</text>
</g>
</g>
</svg>

        </div>
        </div>
<p class="text-center">cocoon_join.yml <small class="text-muted"> (Document the joins)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">join_graph:
- table_name: stg_customer
  primary_key: customer_id
  foreign_keys: []
- table_name: stg_lineorder
  foreign_keys:
  - column: customer_id
    reference:
      table_name: stg_customer
      column: customer_id
  - column: product_id
    reference:
      table_name: stg_part
      column: part_id
  - column: supplier_id
    reference:
      table_name: stg_supplier
      column: supplier_id
  time_keys:
  - commit_date
  - order_date
- table_name: stg_part
  primary_key: part_id
  foreign_keys: []
- table_name: stg_supplier
  primary_key: supplier_id
  foreign_keys: []
- table_name: stg_date
  time_keys:
  - full_date
</code></pre>
</div>

                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="cocoon_steps_knowledge">
            <nav class="navbar navbar-light bg-light">
                <span class="navbar-brand mb-0">
                    <h5 class="card-title mb-0">Process</h5>
                </span>
                
    <ul class="nav">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#"
                id="navbarDropdownMenuLink_knowledge" data-toggle="dropdown" aria-haspopup="true"
                aria-expanded="false">
                Select Category
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink_knowledge">
    <a class="dropdown-item active" data-toggle="tab" href="#cocoon_knowledge_All">All</a>
            </div>
        </li>
    </ul>
    
            </nav>
            <div class="container">
                <small class="text-muted">We illustrate the step-by-step process behind the data.</small>
            </div>
            <hr>
            <div class="scroll-container overflow-auto">
                <div class="tab-content mt-3">
                    
        <div class="tab-pane fade show active" id="cocoon_knowledge_All">
            <p class="subtitle text-center mb-3">All</p>
            
<p class="text-center">Process Story</p>
<div class="container">
    <div id="cocoon_er_story_carousel_0" class="carousel slide" data-interval="false">
        <div class="d-flex justify-content-between align-items-center mt-3">
            <a class="btn btn-secondary" href="#cocoon_er_story_carousel_0" role="button"
                data-slide="prev">
                Prev
            </a>
            <a class="btn btn-secondary" href="#cocoon_er_story_carousel_0" role="button"
                data-slide="next">
                Next
            </a>
        </div>
        <ol class="carousel-indicators" style="position: relative; bottom: 30px;">
            <li data-target="#cocoon_er_story_carousel_0" data-slide-to="0" class="active"></li>
<li data-target="#cocoon_er_story_carousel_0" data-slide-to="1" class=""></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active" style="transition: none;">
    <p>Story behind the relationships <small class="text-muted"> (only for those connect >= 2 entities)</small></p><ol class="small"><li><b>[DateDimension]: Calendar dates track order timelines and supplier deliveries.</b></li></ol>
    
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="84pt" height="30pt"
 viewBox="0.00 0.00 83.92 30.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-26 79.92,-26 79.92,4 -4,4"/>
<!-- DateDimension_0 -->
<g id="node1" class="node">
<title>DateDimension_0</title>
<polygon fill="#e1f5fe" stroke="#4fc3f7" points="75.87,-6.44 75.87,-15.56 53.66,-22 22.25,-22 0.04,-15.56 0.04,-6.44 22.25,0 53.66,0 75.87,-6.44"/>
<text text-anchor="middle" x="37.96" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">DateDimension</text>
</g>
</g>
</svg>

        </div>
        
    <br>
    
    </div>
<div class="carousel-item " style="transition: none;">
    <p>Story behind the relationships <small class="text-muted"> (only for those connect >= 2 entities)</small></p><ol class="small"><li>[DateDimension]: Calendar dates track order timelines and supplier deliveries.</li><li><b>[OrderLineItems]: Customers order parts from suppliers, creating detailed invoices.</b></li></ol>
    
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="211pt" height="88pt"
 viewBox="0.00 0.00 211.33 88.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-84 207.33,-84 207.33,4 -4,4"/>
<!-- DateDimension_0 -->
<g id="node1" class="node">
<title>DateDimension_0</title>
<polygon fill="#ffffff" stroke="#000000" points="75.87,-64.44 75.87,-73.56 53.66,-80 22.25,-80 0.04,-73.56 0.04,-64.44 22.25,-58 53.66,-58 75.87,-64.44"/>
<text text-anchor="middle" x="37.96" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">DateDimension</text>
</g>
<!-- OrderLineItems_1 -->
<g id="node2" class="node">
<title>OrderLineItems_1</title>
<polygon fill="#e1f5fe" stroke="#4fc3f7" points="156.46,-80 93.46,-80 93.46,-58 156.46,-58 156.46,-80"/>
<text text-anchor="middle" x="124.96" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">OrderLineItems</text>
</g>
<!-- Customers_2 -->
<g id="node3" class="node">
<title>Customers_2</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="64.96" cy="-11" rx="24.22" ry="11"/>
<text text-anchor="middle" x="64.96" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Customers</text>
</g>
<!-- OrderLineItems_1&#45;&#45;Customers_2 -->
<g id="edge1" class="edge">
<title>OrderLineItems_1&#45;&#45;Customers_2</title>
<path fill="none" stroke="#4fc3f7" d="M114.23,-57.99C103.04,-47.54 85.64,-31.31 74.8,-21.18"/>
</g>
<!-- Parts_3 -->
<g id="node4" class="node">
<title>Parts_3</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="124.96" cy="-11" rx="18" ry="11"/>
<text text-anchor="middle" x="124.96" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Parts</text>
</g>
<!-- OrderLineItems_1&#45;&#45;Parts_3 -->
<g id="edge2" class="edge">
<title>OrderLineItems_1&#45;&#45;Parts_3</title>
<path fill="none" stroke="#4fc3f7" d="M124.96,-57.99C124.96,-47.92 124.96,-32.47 124.96,-22.3"/>
</g>
<!-- Suppliers_4 -->
<g id="node5" class="node">
<title>Suppliers_4</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="181.96" cy="-11" rx="21.24" ry="11"/>
<text text-anchor="middle" x="181.96" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Suppliers</text>
</g>
<!-- OrderLineItems_1&#45;&#45;Suppliers_4 -->
<g id="edge3" class="edge">
<title>OrderLineItems_1&#45;&#45;Suppliers_4</title>
<path fill="none" stroke="#4fc3f7" d="M135.15,-57.99C145.78,-47.54 162.31,-31.31 172.61,-21.18"/>
</g>
</g>
</svg>

        </div>
        
    <br>
    
    </div>
        </div>
    </div>
</div>
<p class="text-center mt-4">cocoon_er.yml <small class="text-muted">(Document the entity relationships)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">groups:
- group_name: DateDimension
  group_summary: This group focuses on date-related information, providing a comprehensive
    breakdown of calendar dates and their various attributes for data analysis and
    reporting purposes.
  tables:
  - stg_date
  join_info: As there is only one table in this group, no join information is applicable.
    However, this table can potentially be used to join with other tables that have
    date-related fields using the date_key or full_date attributes.
entities:
- entity_name: Customers
  entity_description: Represents individual customers with their personal and contact
    information.
  table_name: stg_customer
  primary_key: customer_id
- entity_name: Parts
  entity_description: Represents individual parts or products with their specifications
    and classifications.
  table_name: stg_part
  primary_key: part_id
- entity_name: Suppliers
  entity_description: Represents individual suppliers with their company and contact
    information.
  table_name: stg_supplier
  primary_key: supplier_id
relations:
- relation_name: OrderLineItems
  relation_description: Customers place orders for Parts, which are supplied by Suppliers,
    creating line items in the order.
  table_name: stg_lineorder
  entities:
  - Customers
  - Parts
  - Suppliers
story:
- name: DateDimension
  description: Calendar dates track order timelines and supplier deliveries.
  type: group
- name: OrderLineItems
  description: Customers order parts from suppliers, creating detailed invoices.
  type: relation
</code></pre>
</div>
        </div>
        
                </div>
            </div>
        </div>
        
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-md-3">
                <div class="list-group" id="myTab" role="tablist">
                    
        <a class="list-group-item list-group-item-action active" data-toggle="list" href="#cocoon_steps_source">
            <div>
                <h6 class="mb-0">1. Source</h6>
                <small>Initial tables from data warehouses</small>
            </div>
        </a>
        
        <a class="list-group-item list-group-item-action " data-toggle="list" href="#cocoon_steps_stage">
            <div>
                <h6 class="mb-0">2. Stage</h6>
                <small>Clean and document the tables</small>
            </div>
        </a>
        
        <a class="list-group-item list-group-item-action " data-toggle="list" href="#cocoon_steps_join">
            <div>
                <h6 class="mb-0">3. Integration</h6>
                <small>Join graph from PK/FK</small>
            </div>
        </a>
        
        <a class="list-group-item list-group-item-action " data-toggle="list" href="#cocoon_steps_knowledge">
            <div>
                <h6 class="mb-0">4. Process</h6>
                <small>Process behind the tables</small>
            </div>
        </a>
        
                </div>
            </div>
        </div>
    </div>
</body>

</html>