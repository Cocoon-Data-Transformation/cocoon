version: 2
models:
- name: stg_drug_exposure
  description: The table is about drug exposures. It includes patient identifiers,
    drug administration dates, dosage details, and prescriber information. Each row
    represents a single drug exposure event. The table captures key information like
    drug name, quantity, dosage instructions, and reasons for stopping medication.
    It also links to other healthcare entities through IDs for the patient, provider,
    and visit.
  columns:
  - name: drug_exposure_id
    description: Unique identifier for each drug exposure event
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column is a unique identifier for each drug exposure event.
        For this table, each row represents a single drug exposure event, so drug_exposure_id
        should be unique across rows.
      data_type:
        current_data_type: INT
  - name: person_id
    description: Unique identifier for the patient
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: stop_reason
    description: Reason for discontinuing the medication
    tests:
    - not_null
    - accepted_values:
        values:
        - Adverse reaction
        - Completed course
    cocoon_meta:
      future_accepted_values:
      - Ineffective
      - Patient decision
      - Physician decision
      - Cost
      - Drug interaction
      - Dosage change
      - Switching to alternative
      - Pregnancy
      - Breastfeeding
      - Surgery
      - Contraindication
      - Side effects
      - Allergic reaction
      - Treatment goal achieved
      - Loss of efficacy
      - Drug shortage
      - Insurance coverage issue
      - Patient non-compliance
      - Hospitalization
      - End of life care
      - Other
      data_type:
        current_data_type: VARCHAR
  - name: refills
    description: Number of refills allowed
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: days_supply
    description: Number of days the supply will last
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: sig
    description: Instructions for drug administration
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: lot_number
    description: Manufacturer's lot number for the drug
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: provider_id
    description: Unique identifier for the prescribing provider
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: visit_occurrence_id
    description: Identifier for the associated healthcare visit
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: INT
  - name: drug_source_value
    description: This field houses the verbatim value from the source data representing
      the drug exposure that occurred. For example, this could be an NDC or Gemscript
      code.
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: route_source_value
    description: This field houses the verbatim value from the source data representing
      the drug route.
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: dose_unit_source_value
    description: This field houses the verbatim value from the source data representing
      the dose unit of the drug given.
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: drug_exposure_end_date
    description: Date when the drug administration ended
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DATE
  - name: drug_exposure_start_date
    description: Date when the drug administration began
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DATE
  - name: quantity
    description: Amount of medication dispensed
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: verbatim_end_date
    description: This is the end date of the drug exposure as it appears in the source
      data, if it is given
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DATE
