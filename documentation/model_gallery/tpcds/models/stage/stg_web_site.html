<!DOCTYPE html>
<html lang="en">
<head>
<title>Cocoon</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">


<style>
  html {
    height: 100%; /* Ensure the html element covers the full height */
    background-color: #f0f0f0; /* Set your desired background color */
  }

  body {
    /* Scale the entire content to 70% */
    transform: scale(0.75);
    transform-origin: top left; /* Adjust as needed */
    width: 133.33%; /* Increase width to fit, since scaling down shrinks the viewport */
    height: 133.33%; /* Adjust height similarly if necessary */
    overflow: auto; /* Add scrollbars if content overflows */
  }

  body, h1, h2, p {
    margin: 0;
    padding: 0;
    font-family: 'Arial', sans-serif;
  }

  .container {
    display: flex;
    justify-content: space-between;
    align-items: center; /* This ensures the items are aligned in the middle vertically */
  }

  .map-container {
    width: 300px;
    height: 200px;
    border: 1px solid black;
  }
  
  .histogram-container {
    width: 300px;
    height: 100px;
    border: 1px solid black;
  }

  .chart-container { /* Style for the container */
    width: 200px;
    height: 80px;
    border: 1px solid black;
  }
  
  .bar-chart-container {
    width: 300px;
    height: 100px;
    border: 1px solid black;
  }

  .dashboard {
    display: grid;
    grid-template-areas:
      "main-panel right-panel"
      "bottom-panel right-panel";
    grid-template-rows: 1fr 1fr; /* Equal height for both rows */
    gap: 10px;
    height: 130vh;
    padding: 10px;
    background-color: #f0f0f0;
  }

  .main-panel {
    grid-area: main-panel;
    background-color: #ffffff;
    padding: 20px;
    position: relative; /* Set the main-panel to relative to position the chat box inside it */
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column; /* Stack the children vertically */
  }

  .table-container {
    overflow-x: auto; /* Allows horizontal scrolling for the table */
    overflow-y: auto; /* Allows vertical scrolling for the table */
    flex-grow: 1;
    max-width: 100%; /* Ensures that the container doesn't exceed the width of its parent */
    display: none;
  }

  .right-panel {
    grid-area: right-panel;
    background-color: #fff;
    padding: 15px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    overflow-y: auto; /* Enable scrolling for the panel */
    width: 360px;
  }

  .indent {
    padding-left: 5px; /* Increase as needed for deeper indents */
    font-size: small;
    display: none;
  }

  .card-item {
    display: flex;
    align-items: center;
    background-color: #626262; /* White background for the card */
    border: 1px solid #626262; /* Light grey border */
    color: white;
    border-radius: 4px; /* Slightly rounded corners */
    margin-bottom: 6px; /* Space between card items */
    padding: 3px;
    padding-left: 10px;
    width: 320px;
  }

  .card-item-collapsed {
    background-color: #d0d0d0; /* Lighter background for collapsed card */
    border: 1px solid #d0d0d0; /* Lighter border for collapsed card */
    color: black; /* Change text color for better contrast on light background */
  }

  .icon {
    /* Styles for the icon, you can replace it with an actual icon font or image */
    padding-right: 20px;
  }

  .field-name {
    /* Styles for the field name */
    flex-grow: 1;
    padding-right: 20px;
    font-size: 14px;

  }

  .circle {
    background-color: red;
    font-size: small;
    border-radius: 50%;
    color: white;
    padding: 0px;
    text-align: center;
    display: inline-block;
      width: 16px;         /* Fixed width */
      height: 16px;        /* Fixed height */
      line-height: 16px;   /* Center the number vertically */
  }

  .circle2 {
    background-color: green;
    font-size: small;
    border-radius: 50%;
    color: white;
    padding: 0px;
    text-align: center;
    display: inline-block;
    /* Changes for a better circle */
      width: 16px;         /* Fixed width */
      height: 16px;        /* Fixed height */
      line-height: 16px;   /* Center the number vertically */
  }

  .card-controls {
    display: flex;
  }

  .drop-down-btn,
  .add-btn {
    /* Shared styles for buttons */
    background-color: #4CAF50; /* Green background */
    color: white;
    border: none;
    border-radius: 2px; /* Slightly rounded corners for the buttons */
    cursor: pointer;
    padding: 2px 6px; /* Smaller padding for a compact look */
    margin-left: 4px; /* Spacing between buttons */
  }

  .drop-down-btn:hover,
  .add-btn:hover {
    background-color: #45a049; /* Darker green on hover */
  }

  .bottom-panel {
    grid-area: bottom-panel;
    background-color: #ffffff;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    overflow-x: auto;
  }

  
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
  font-size: 0.9em;
  border-radius: 8px;
  overflow: hidden;
}

th, td {
  padding: 6px 8px;
  text-align: left;
  border-bottom: 1px solid #dddddd;
  border-right: 1px solid #dddddd;
}

th:last-child, td:last-child {
  border-right: none; /* Removes the border from the last cell of each row */
}

thead tr {
  background-color: #bebebe; /* Changed color for header */
  color: #ffffff; /* Changed text color for better contrast */
  text-align: left;
  font-weight: bold;
  font-size: 14px;
}

th {
  position: sticky;
  top: 0;
  background-color: #bebebe; /* Ensure the sticky header has the same background color */
}

tbody tr {
  background-color: #f9f9f9; /* Lighter color for content rows */
  font-size: 14px
}

tbody tr:last-of-type {
  border-bottom: 2px solid #6e6e6e;
}

tbody tr.active-row {
  font-weight: bold;
  color: #6e6e6e;
}


  .link {
      fill: none;
      stroke: #555;
      stroke-opacity: 0.4;
      stroke-width: 1.5px;
  }

  .node {
      cursor: pointer;
  }

  .node circle {
      fill: #999;
      stroke: black;
      stroke-width: 1.5px;
  }

  .node text {
      font: 12px sans-serif;
      fill: #555;
  }

  .icons {
    /* Making the icon larger */
    font-size: 20px; /* You can adjust this value as needed */
    color: white; /* Icon color */
    background-color: black; /* Background color */
    padding: 6px 6px; /* Top/bottom padding and left/right padding */
    border-radius: 3px; /* Making the corners sharp for a rectangular look */
  }

  .switch-container {
    display: flex;
    align-items: center;
  }

  .switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
    margin: 0 10px;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }

  input:checked + .slider {
    background-color: #2196F3;
  }

  input:checked + .slider:before {
    transform: translateX(26px);
  }

  .label-text {
    font-family: Verdana, sans-serif;
    font-size: 14px;
  }

  .table-container.active {
    display: block;
  }

.tag {
  display: inline-block;
  padding: 2px 6px;
  font-size: 12px;
  margin-right: 6px;
  border-radius: 4px;
}

.tag-red {
  background-color: #ffcccb;
  color: #ff0000;
  border: 1px solid #ff0000;
}

.tag-blue {
  background-color: #e0f2ff;
  color: #0066ff;
  border: 1px solid #0066ff;
}

.tag-purple {
  background-color: #e6ccff;
  color: #9900ff;
  border: 1px solid #9900ff;
}

code {
  font-family: Consolas,"courier new";
  color: crimson;
  background-color: #f1f1f1;
  padding: 2px;
  font-size: 105%;
}
</style>

</head>
<body>

<div class="dashboard">

    <div class="main-panel">
        <div class="container">
            <a href="https://github.com/Cocoon-Data-Transformation/cocoon" target="_blank" style="display: flex; align-items: center; text-decoration: none; color: black;">
    <img src="https://raw.githubusercontent.com/Cocoon-Data-Transformation/cocoon/main/images/cocoon_icon.png" alt="cocoon icon" width=50 style="margin-right: 10px;">
    <div style="margin: 0; padding: 0;"><h2 style="margin: 0; padding: 0;">Data Cleaning</h2>
        <p style="margin: 0; padding: 0;">Powered by Cocoon</p>
    </div>
</a>
            <div><h1>web_site</h1>(First 100 rows)</div>
            <div>
                <div class="switch-container">
<span class="label-text">Before</span>
<label class="switch">
    <input type="checkbox">
    <span class="slider"></span>
</label>
<span class="label-text">After</span>
</div>
            </div>
        </div>

        <div class="table-container before active">
            <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WEB_GMT_OFFSET</th>
      <th>WEB_SUITE_NUMBER</th>
      <th>WEB_SITE_ID</th>
      <th>WEB_STREET_NAME</th>
      <th>WEB_STREET_TYPE</th>
      <th>WEB_COMPANY_ID</th>
      <th>WEB_STATE</th>
      <th>WEB_MARKET_MANAGER</th>
      <th>WEB_COUNTRY</th>
      <th>WEB_MANAGER</th>
      <th>WEB_NAME</th>
      <th>WEB_COUNTY</th>
      <th>WEB_SITE_SK</th>
      <th>WEB_CITY</th>
      <th>WEB_MKT_ID</th>
      <th>WEB_CLASS</th>
      <th>WEB_TAX_PERCENTAGE</th>
      <th>WEB_REC_END_DATE</th>
      <th>WEB_REC_START_DATE</th>
      <th>WEB_STREET_NUMBER</th>
      <th>WEB_CLOSE_DATE_SK</th>
      <th>WEB_OPEN_DATE_SK</th>
      <th>WEB_ZIP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-5</td>
      <td>Suite 330</td>
      <td>AAAAAAAABAAAAAAA</td>
      <td>Dogwood Sunset</td>
      <td>Ln</td>
      <td>6</td>
      <td>TN</td>
      <td>Joe George</td>
      <td>United States</td>
      <td>Ronald Shaffer</td>
      <td>site_0</td>
      <td>Williamson County</td>
      <td>1</td>
      <td>Midway</td>
      <td>4</td>
      <td>Unknown</td>
      <td>0.1</td>
      <td>None</td>
      <td>1997-08-16</td>
      <td>51</td>
      <td>NaN</td>
      <td>2450807</td>
      <td>31904</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-5</td>
      <td>Suite 150</td>
      <td>AAAAAAAACAAAAAAA</td>
      <td>Ridge Wilson</td>
      <td>Cir.</td>
      <td>4</td>
      <td>TN</td>
      <td>David Myers</td>
      <td>United States</td>
      <td>Tommy Jones</td>
      <td>site_0</td>
      <td>Williamson County</td>
      <td>2</td>
      <td>Midway</td>
      <td>6</td>
      <td>Unknown</td>
      <td>0.0</td>
      <td>2000-08-15</td>
      <td>1997-08-16</td>
      <td>358</td>
      <td>2448973.0</td>
      <td>2450798</td>
      <td>31904</td>
    </tr>
  </tbody>
</table>
        </div>
        <div class="table-container after">
            <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gmt_offset</th>
      <th>suite_number</th>
      <th>website_id</th>
      <th>street_name</th>
      <th>street_type</th>
      <th>company_id</th>
      <th>web_state</th>
      <th>market_manager</th>
      <th>web_country</th>
      <th>site_manager</th>
      <th>website_name</th>
      <th>web_county</th>
      <th>website_surrogate_key</th>
      <th>web_city</th>
      <th>market_id</th>
      <th>web_classification</th>
      <th>tax_percentage</th>
      <th>record_end_date</th>
      <th>record_start_date</th>
      <th>street_number</th>
      <th>web_close_date</th>
      <th>web_open_date</th>
      <th>zip_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-5</td>
      <td>Suite 330</td>
      <td>AAAAAAAABAAAAAAA</td>
      <td>Dogwood Sunset</td>
      <td>Ln</td>
      <td>6</td>
      <td>TN</td>
      <td>Joe George</td>
      <td>United States</td>
      <td>Ronald Shaffer</td>
      <td>site_0</td>
      <td>Williamson County</td>
      <td>1</td>
      <td>Midway</td>
      <td>4</td>
      <td>Unknown</td>
      <td>0.1</td>
      <td>NaT</td>
      <td>1997-08-16</td>
      <td>51</td>
      <td>NaN</td>
      <td>4850808.0</td>
      <td>31904</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-5</td>
      <td>Suite 150</td>
      <td>AAAAAAAACAAAAAAA</td>
      <td>Ridge Wilson</td>
      <td>Cir</td>
      <td>4</td>
      <td>TN</td>
      <td>David Myers</td>
      <td>United States</td>
      <td>Tommy Jones</td>
      <td>site_0</td>
      <td>Williamson County</td>
      <td>2</td>
      <td>Midway</td>
      <td>6</td>
      <td>Unknown</td>
      <td>0.0</td>
      <td>2000-08-15</td>
      <td>1997-08-16</td>
      <td>358</td>
      <td>2448973.0</td>
      <td>4850799.0</td>
      <td>31904</td>
    </tr>
  </tbody>
</table>
        </div>
    </div>
    <div class="right-panel">

<div class="card-item card-item-collapsed">
    <span class="field-name">gmt_offset</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="hist_viz_gmt_offset"></div><b>📃 Summary:</b> GMT time offset for the website's location<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">suite_number</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_suite_number"></div><b>📃 Summary:</b> Suite number of the website's address<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">website_id</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><span class="tag tag-blue">unique</span><br><br><div id="bar_viz_website_id"></div><b>📃 Summary:</b> Unique identifier for the website<br><b>🦄 Unique:</b> This column is a unique identifier for the website. For this table, each row represents a unique website, and the website_id is designed to be unique for each website.<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">street_name</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_street_name"></div><b>📃 Summary:</b> Street name of the website's address<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">street_type</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><span class="tag tag-purple">accepted_values<select><option value='Ave'>Ave</option><option value='Blvd'>Blvd</option><option value='Cir'>Cir</option><option value='Ct'>Ct</option><option value='Dr'>Dr</option><option value='Ln'>Ln</option><option value='Pl'>Pl</option><option value='Rd'>Rd</option><option value='St'>St</option><option value='Ter'>Ter</option><option value='Way'>Way</option><option value='Pkwy'>Pkwy</option><option value='Hwy'>Hwy</option><option value='Aly'>Aly</option><option value='Expy'>Expy</option></select></span><br><br><div id="bar_viz_street_type"></div><b>📃 Summary:</b> Street type of the website's address<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">company_id</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="hist_viz_company_id"></div><b>📃 Summary:</b> Unique identifier for the company<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_state</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_web_state"></div><b>📃 Summary:</b> State where the website is registered<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">market_manager</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_market_manager"></div><b>📃 Summary:</b> Name of the market manager<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_country</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_web_country"></div><b>📃 Summary:</b> Country where the website is registered<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">site_manager</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_site_manager"></div><b>📃 Summary:</b> Name of the website manager<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">website_name</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_website_name"></div><b>📃 Summary:</b> Name of the website<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_county</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_web_county"></div><b>📃 Summary:</b> County where the website is registered<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">website_surrogate_key</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><span class="tag tag-blue">unique</span><br><br><div id="hist_viz_website_surrogate_key"></div><b>📃 Summary:</b> Surrogate key for the website<br><b>🦄 Unique:</b> This column is a surrogate key for the website. For this table, each row represents a unique website, and the surrogate key is designed to be unique for each website.<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_city</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_web_city"></div><b>📃 Summary:</b> City where the website is registered<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">market_id</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="hist_viz_market_id"></div><b>📃 Summary:</b> Unique identifier for the market<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_classification</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_web_classification"></div><b>📃 Summary:</b> Classification of the website<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">tax_percentage</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="hist_viz_tax_percentage"></div><b>📃 Summary:</b> Tax percentage applicable to the website<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">record_end_date</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_record_end_date"></div><b>📃 Summary:</b> End date of the record<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">record_start_date</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_record_start_date"></div><b>📃 Summary:</b> Start date of the record<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">street_number</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_street_number"></div><b>📃 Summary:</b> Street number of the website's address<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_close_date</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><div id="hist_viz_web_close_date"></div><b>📃 Summary:</b> Date when the website was closed<br><b>❓ Missing:</b> Website may still be active, so no close date.<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">web_open_date</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="hist_viz_web_open_date"></div><b>📃 Summary:</b> Date when the website was opened<br><br></div>

<div class="card-item card-item-collapsed">
    <span class="field-name">zip_code</span>
    <div class="card-controls">
        <span class="toggle">▲</span>
    </div>
</div>
<div class="indent" style="display: block;"><span class="tag tag-red">not_null</span><br><br><div id="bar_viz_zip_code"></div><b>📃 Summary:</b> ZIP code of the website's location<br><br></div>

    </div>

    <div class="bottom-panel">
        <h1>Cocoon Cleaning Summary 🤗</h1><hr><br><h2>📃 1. Table Summary</h2><br>The table is about web sites. It contains details such as site ID, name, opening and closing dates, manager, market information, company details, address, and tax percentage. Each row represents a unique web site with its characteristics and location information. The table includes both current and historical data for web sites.<br><br><br><h2>📊 2. Column Rename</h2><br>
                😎 <b>26</b> columns have been renamed<br>
                <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column</th>
      <th>Summary</th>
      <th>New Column Name</th>
      <th>Renamed?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WEB_SITE_SK</td>
      <td>Surrogate key for the website</td>
      <td>website_surrogate_key</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WEB_SITE_ID</td>
      <td>Unique identifier for the website</td>
      <td>website_id</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WEB_REC_START_DATE</td>
      <td>Start date of the record</td>
      <td>record_start_date</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WEB_REC_END_DATE</td>
      <td>End date of the record</td>
      <td>record_end_date</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WEB_NAME</td>
      <td>Name of the website</td>
      <td>website_name</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WEB_OPEN_DATE_SK</td>
      <td>Date when the website was opened</td>
      <td>web_open_date</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>6</th>
      <td>WEB_CLOSE_DATE_SK</td>
      <td>Date when the website was closed</td>
      <td>web_close_date</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>7</th>
      <td>WEB_CLASS</td>
      <td>Classification of the website</td>
      <td>web_classification</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WEB_MANAGER</td>
      <td>Name of the website manager</td>
      <td>site_manager</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>9</th>
      <td>WEB_MKT_ID</td>
      <td>Unique identifier for the market</td>
      <td>market_id</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>10</th>
      <td>WEB_MKT_CLASS</td>
      <td>Market classification of the website</td>
      <td>market_classification</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>11</th>
      <td>WEB_MKT_DESC</td>
      <td>Description of the website's market</td>
      <td>market_description</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>12</th>
      <td>WEB_MARKET_MANAGER</td>
      <td>Name of the market manager</td>
      <td>market_manager</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>13</th>
      <td>WEB_COMPANY_ID</td>
      <td>Unique identifier for the company</td>
      <td>company_id</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WEB_COMPANY_NAME</td>
      <td>Name of the company owning the website</td>
      <td>company_name</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>15</th>
      <td>WEB_STREET_NUMBER</td>
      <td>Street number of the website's address</td>
      <td>street_number</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>16</th>
      <td>WEB_STREET_NAME</td>
      <td>Street name of the website's address</td>
      <td>street_name</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>17</th>
      <td>WEB_STREET_TYPE</td>
      <td>Street type of the website's address</td>
      <td>street_type</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>18</th>
      <td>WEB_SUITE_NUMBER</td>
      <td>Suite number of the website's address</td>
      <td>suite_number</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>19</th>
      <td>WEB_CITY</td>
      <td>City where the website is registered</td>
      <td>web_city</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>20</th>
      <td>WEB_COUNTY</td>
      <td>County where the website is registered</td>
      <td>web_county</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>21</th>
      <td>WEB_STATE</td>
      <td>State where the website is registered</td>
      <td>web_state</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>22</th>
      <td>WEB_ZIP</td>
      <td>ZIP code of the website's location</td>
      <td>zip_code</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>23</th>
      <td>WEB_COUNTRY</td>
      <td>Country where the website is registered</td>
      <td>web_country</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>24</th>
      <td>WEB_GMT_OFFSET</td>
      <td>GMT time offset for the website's location</td>
      <td>gmt_offset</td>
      <td>✔️ Yes</td>
    </tr>
    <tr>
      <th>25</th>
      <td>WEB_TAX_PERCENTAGE</td>
      <td>Tax percentage applicable to the website</td>
      <td>tax_percentage</td>
      <td>✔️ Yes</td>
    </tr>
  </tbody>
</table><br><br><br><h2>🚧 3. Erroneous Values</h2><br>
            🔍 <b>4</b> columns have erroneous values<br><ol><li><b>market_classification</b>: Both values are unusual because they are incomplete sentences rather than clear market classifications.<br>✔️ The column has been cleaned:<br><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Value</th>
      <th>Cleaned Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Completely excellent things ought to pro</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>Grey lines ought to result indeed centres. Tod</td>
      <td></td>
    </tr>
  </tbody>
</table><br></li><li><b>market_description</b>: Both values are unusual because they are incoherent sentences that don't describe markets in a meaningful way.<br>✔️ The column has been cleaned:<br><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Value</th>
      <th>Cleaned Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lucky passengers know. Red details will not hang alive, international s</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>Well similar decisions used to keep hardly democratic, personal priorities.</td>
      <td></td>
    </tr>
  </tbody>
</table><br></li><li><b>company_name</b>: 'cally' and 'ese' are unusual because they seem like partial names or abbreviations instead of complete company names.<br>✔️ The column has been cleaned:<br><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Value</th>
      <th>Cleaned Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cally</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>ese</td>
      <td></td>
    </tr>
  </tbody>
</table><br></li><li><b>street_type</b>: 'Cir.' and 'Ln' are unusual because they use inconsistent punctuation and abbreviation styles.<br>✔️ The column has been cleaned:<br><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Value</th>
      <th>Cleaned Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cir.</td>
      <td>Cir</td>
    </tr>
  </tbody>
</table><br></li></ol><br><h2>🕵️‍♂️ 4. Disguised Missing Values</h2><br>
                🔍 <b>3</b> columns have disguised missing values<br>
                ✔️ <b>3</b> columns have been cleaned<br>
                <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column</th>
      <th>Disguised Missing Values</th>
      <th>Impute to NULL?</th>
      <th>Values to NULL (Sep By ,)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>market_classification</td>
      <td>[]</td>
      <td>True</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>market_description</td>
      <td>[]</td>
      <td>True</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>company_name</td>
      <td>[]</td>
      <td>True</td>
      <td></td>
    </tr>
  </tbody>
</table><br><br><br><h2>🔧 5. Data Type</h2><br>
                ✔️ <b>6</b> columns have been casted<br>
                <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column Name</th>
      <th>Clause</th>
      <th>Reasoning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>record_end_date</td>
      <td>CAST("record_end_date" AS DATE)</td>
      <td>To transform the 'record_end_date' column from VARCHAR to DATE, we need to use a simple CAST function. The date format in the given example ('2000-08-15') is already in the standard ISO 8601 format (YYYY-MM-DD), which is directly compatible with DuckDB's DATE type. Therefore, we don't need to use the strptime function for parsing; a straightforward CAST will suffice.\n</td>
    </tr>
    <tr>
      <th>1</th>
      <td>record_start_date</td>
      <td>CAST("record_start_date" AS DATE)</td>
      <td>To transform the 'record_start_date' column from VARCHAR to DATE, we need to use a simple CAST function. The date format in the given distinct value '1997-08-16' is already in the standard ISO format (YYYY-MM-DD), which is directly compatible with DuckDB's DATE type. Therefore, we can use a straightforward CAST without needing to use strptime() for parsing.\n</td>
    </tr>
    <tr>
      <th>2</th>
      <td>street_number</td>
      <td>CAST("street_number" AS VARCHAR)</td>
      <td>To transform the data type of the 'street_number' column from 'INT' to 'VARCHAR', we need to use a simple CAST function. This will convert each integer value to its string representation. In DuckDB, the VARCHAR data type is used for variable-length character strings, which is appropriate for storing street numbers as text.\n</td>
    </tr>
    <tr>
      <th>3</th>
      <td>web_close_date</td>
      <td>"web_close_date"</td>
      <td>Fail to cast</td>
    </tr>
    <tr>
      <th>4</th>
      <td>web_open_date</td>
      <td>julian(DATE '1858-11-17' + CAST("web_open_date" AS INTEGER))</td>
      <td>To transform the 'web_open_date' column from INT to DATE in DuckDB, we need to use the CAST function. The values in the column appear to be Julian dates, which can be directly cast to DATE type in DuckDB without needing any additional conversion function like strptime. DuckDB automatically recognizes Julian dates when casting to DATE.\n</td>
    </tr>
    <tr>
      <th>5</th>
      <td>zip_code</td>
      <td>CAST("zip_code" AS VARCHAR)</td>
      <td>To transform the data type of the 'zip_code' column from 'INT' to 'VARCHAR', we need to use a CAST function. In DuckDB, the syntax for this is straightforward. We simply use the CAST keyword, specifying the column name and the desired data type.\n</td>
    </tr>
  </tbody>
</table><br><br><br><h2>❓ 6. Missing Values</h2><br>
                🔍 <b>5</b> columns have missing values<br>
                ✔️ <b>1</b> of them are acceptable<br>
                <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column</th>
      <th>NULL (%)</th>
      <th>Is NULL Acceptable?</th>
      <th>Explanation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>company_name</td>
      <td>100</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>market_classification</td>
      <td>100</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>market_description</td>
      <td>100</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>record_end_date</td>
      <td>50</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>web_close_date</td>
      <td>50</td>
      <td>True</td>
      <td>Website may still be active, so no close date.</td>
    </tr>
  </tbody>
</table><br>🧩 These missing values are handled as follows:<br>
                    <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column</th>
      <th>NULL (%)</th>
      <th>Strategy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>company_name</td>
      <td>100</td>
      <td>🗑️ Drop Column</td>
    </tr>
    <tr>
      <th>1</th>
      <td>market_classification</td>
      <td>100</td>
      <td>🗑️ Drop Column</td>
    </tr>
    <tr>
      <th>2</th>
      <td>market_description</td>
      <td>100</td>
      <td>🗑️ Drop Column</td>
    </tr>
    <tr>
      <th>3</th>
      <td>record_end_date</td>
      <td>50</td>
      <td>🔄 Unchanged</td>
    </tr>
  </tbody>
</table><br><br><br>
    </div>
</div>

<script src="https://d3js.org/d3.v6.min.js"  charset="utf-8"></script>
<script src="https://d3js.org/topojson.v3.min.js"></script>
<script>
document.querySelectorAll('.card-item').forEach(function(card) {{
    card.addEventListener('click', function() {{
        var indent = this.nextElementSibling;
        var toggle = this.querySelector('.toggle');
        if (indent.style.display === "block") {{
            indent.style.display = "none";
            toggle.textContent = '▼';
            this.classList.remove('card-item-collapsed');
        }} else {{
            indent.style.display = "block";
            toggle.textContent = '▲';
            this.classList.add('card-item-collapsed');
        }}
    }});
}});
  const toggleSwitch = document.querySelector('.switch input[type="checkbox"]');
  const labelTextAfter = document.querySelector('.label-text:last-of-type');
  const tableContainerBefore = document.querySelector('.table-container.before');
  const tableContainerAfter = document.querySelector('.table-container.after');

  const handleToggle = () => {
    if (toggleSwitch.checked) {
      labelTextAfter.style.color = 'blue';
      tableContainerBefore.classList.remove('active');
      tableContainerAfter.classList.add('active');
    } else {
      labelTextAfter.style.color = '';
      tableContainerBefore.classList.add('active');
      tableContainerAfter.classList.remove('active');
    }
  };

  toggleSwitch.addEventListener('change', handleToggle);
</script>
<script>
    function drawBarChart(divId, data) {
      const margin = {top: 10, right: 10, bottom: 25, left: 100},
            width = 300 - margin.left - margin.right,
            height = 100 - margin.top - margin.bottom;

      const targetDiv = d3.select("#" + divId);
      targetDiv.classed("bar-chart-container", true);

      const svg = targetDiv
                    .append("svg")
                      .attr("width", width + margin.left + margin.right)
                      .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      const y = d3.scaleBand()
                  .range([0, height])
                  .domain(data.map(d => d.label))
                  .padding(0.1);

      const x = d3.scaleLinear()
                  .domain([0, d3.max(data, d => d.value)])  // Percent scale
                  .range([0, width]);

      svg.append("g")
         .call(d3.axisLeft(y));

      svg.selectAll(".bar")
         .data(data)
         .enter().append("rect")
           .attr("class", "bar")
           .attr("y", d => y(d.label))
           .attr("height", y.bandwidth())
           .attr("x", 0)
           .attr("width", d => x(d.value))
           .attr("fill", "steelblue");

      svg.append("g")
         .attr("transform", "translate(0," + height + ")")
         .call(d3.axisBottom(x).ticks(5).tickFormat(d => d + "%"));
    }
    
    function drawHistogram(divId, data, binWidth) {
      const margin = {top: 10, right: 10, bottom: 20, left: 40},
            width = 300 - margin.left - margin.right,
            height = 100 - margin.top - margin.bottom;
            
      const targetDiv = d3.select("#" + divId);
      targetDiv.classed("histogram-container", true);

      const svg = targetDiv
                    .append("svg")
                      .attr("width", width + margin.left + margin.right)
                      .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      const x = d3.scaleLinear()
                  .domain([d3.min(data, d => d.x) - binWidth, d3.max(data, d => d.x) + binWidth])
                  .range([0, width]);

      const y = d3.scaleLinear()
                  .domain([0, d3.max(data, d => d.y) * 1.1]) // Increase the y-axis limit by 10% for margin
                  .range([height, 0]);

      const xAxis = d3.axisBottom(x).ticks(5);
      const yAxis = d3.axisLeft(y).ticks(5);

      svg.append("g")
         .attr("transform", "translate(0," + height + ")")
         .call(xAxis)

      svg.append("g")
         .call(yAxis)

      svg.selectAll("rect")
         .data(data)
         .enter().append("rect")
           .attr("x", d => x(d.x - binWidth / 2))
           .attr("y", d => y(d.y))
           .attr("width", x(binWidth) - x(0))
           .attr("height", d => height - y(d.y))
           .attr("fill", "steelblue");
    }
    
    function drawMap(divId, coordinates) {
      const targetDiv = d3.select("#" + divId);
      targetDiv.classed("map-container", true);

      const width = 300;
      const height = 200;
      const projection = d3.geoNaturalEarth1()
          .scale(width / 1.5 / Math.PI)
          .translate([width / 2, height / 2]);
      const path = d3.geoPath().projection(projection);

      const svg = targetDiv.append("svg")
          .attr("width", width)
          .attr("height", height);

      d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson").then(data => {
        // Draw the map
        svg.append("g")
          .selectAll("path")
          .data(data.features)
          .join("path")
              .attr("fill", "#ccc")
              .attr("d", path)
              .style("stroke", "#fff");

        // Plotting the points
        coordinates.forEach(coords => {
          svg.append("circle")
            .attr("cx", projection(coords)[0])
            .attr("cy", projection(coords)[1])
            .attr("r", 2)
            .attr("fill", "red");
        });
      });
    }
    
    let data = [];
    let binWidth = 5;
data = [{'x': -5, 'y': 2}];
    binWidth = -5;
    drawHistogram("hist_viz_gmt_offset", data, binWidth);
data = [{'label': 'Suite 150', 'value': 50.0}, {'label': 'Suite 330', 'value': 50.0}];
    drawBarChart("bar_viz_suite_number", data);
data = [{'label': 'AAAAAAAACAAAAAA...', 'value': 50.0}, {'label': 'AAAAAAAABAAAAAA...', 'value': 50.0}];
    drawBarChart("bar_viz_website_id", data);
data = [{'label': 'Ridge Wilson', 'value': 50.0}, {'label': 'Dogwood Sunset', 'value': 50.0}];
    drawBarChart("bar_viz_street_name", data);
data = [{'label': 'Cir', 'value': 50.0}, {'label': 'Ln', 'value': 50.0}];
    drawBarChart("bar_viz_street_type", data);
data = [{'x': 4.05, 'y': 1}, {'x': 4.15, 'y': 0}];
    binWidth = 0.1;
    drawHistogram("hist_viz_company_id", data, binWidth);
data = [{'label': 'TN', 'value': 100.0}];
    drawBarChart("bar_viz_web_state", data);
data = [{'label': 'David Myers', 'value': 50.0}, {'label': 'Joe George', 'value': 50.0}];
    drawBarChart("bar_viz_market_manager", data);
data = [{'label': 'United States', 'value': 100.0}];
    drawBarChart("bar_viz_web_country", data);
data = [{'label': 'Ronald Shaffer', 'value': 50.0}, {'label': 'Tommy Jones', 'value': 50.0}];
    drawBarChart("bar_viz_site_manager", data);
data = [{'label': 'site_0', 'value': 100.0}];
    drawBarChart("bar_viz_website_name", data);
data = [{'label': 'Williamson Coun...', 'value': 100.0}];
    drawBarChart("bar_viz_web_county", data);
data = [{'x': 1.025, 'y': 1}, {'x': 1.0750000000000002, 'y': 0}];
    binWidth = 0.05;
    drawHistogram("hist_viz_website_surrogate_key", data, binWidth);
data = [{'label': 'Midway', 'value': 100.0}];
    drawBarChart("bar_viz_web_city", data);
data = [{'x': 4.05, 'y': 1}, {'x': 4.15, 'y': 0}];
    binWidth = 0.1;
    drawHistogram("hist_viz_market_id", data, binWidth);
data = [{'label': 'Unknown', 'value': 100.0}];
    drawBarChart("bar_viz_web_classification", data);
data = [{'x': 0.0025, 'y': 1}, {'x': 0.0075, 'y': 0}];
    binWidth = 0.005;
    drawHistogram("hist_viz_tax_percentage", data, binWidth);
data = [{'label': '2000-08-15 00:0...', 'value': 100.0}];
    drawBarChart("bar_viz_record_end_date", data);
data = [{'label': '1997-08-16 00:0...', 'value': 100.0}];
    drawBarChart("bar_viz_record_start_date", data);
data = [{'label': '51', 'value': 50.0}, {'label': '358', 'value': 50.0}];
    drawBarChart("bar_viz_street_number", data);
data = [{'x': 2448973.0, 'y': 1}];
    binWidth = 2448973.0;
    drawHistogram("hist_viz_web_close_date", data, binWidth);
data = [{'x': 4850799.225, 'y': 1}, {'x': 4850799.675000001, 'y': 0}];
    binWidth = 0.45;
    drawHistogram("hist_viz_web_open_date", data, binWidth);
data = [{'label': '31904', 'value': 100.0}];
    drawBarChart("bar_viz_zip_code", data);


</script>
</body>
</html>