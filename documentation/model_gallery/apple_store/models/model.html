<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cocoon - Data Modeling</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-yaml.min.js"></script>
</head>
<style>
    /* for list-group-item highlight */
    .list-group-item.active {
        background-color: #464646;
        border-color: #f8f9fa;
        color: #ffffff;
    }

    .list-group-item.active:hover {
        background-color: #bebebe;
        border-color: #e9ecef;
        color: #ffffff;
    }

    /* for nav-link highlight */
    .nav-link {
        color: #6c757d !important;
        /* Gray color for inactive links */
    }

    .nav-link.active {
        color: #000 !important;
        /* Black color for active link */
    }


table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 0.9em;
    border-radius: 4px;
    overflow: hidden;
}

th,
td {
    padding: 3px 4px;
    text-align: left;
    border-bottom: 1px solid #dddddd;
    border-right: 1px solid #dddddd;
}

thead tr {
    background-color: #464646;
    /* Changed color for header */
    color: #ffffff;
    /* Changed text color for better contrast */
    text-align: left;
    font-weight: bold;
    font-size: 12px;
}

th {
    top: 0;
    background-color: #464646;
    color: #ffffff;
}

tbody tr {
    background-color: #f9f9f9;
    /* Lighter color for content rows */
    font-size: 10px
}

.code_container {
    max-height: calc(60vh);
    overflow: auto;
}

.code_container pre[class*="language-"] {
    border-radius: 4px;
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
    font-size: 12px;
}


    .code_container {
        max-height: calc(60vh);
        overflow: auto;
    }

    .code_container pre[class*="language-"] {
        border-radius: 4px;
        padding: 1em;
        margin: .5em 0;
        overflow: auto;
        font-size: 12px;
    }


    .carousel-indicators li {
        background-color: #808080;
        /* Gray for inactive indicators */
    }

    .carousel-indicators .active {
        background-color: #000000;
        /* Black for active indicator */
    }
</style>

<body>


    <div class="container mt-4">
        <!-- New row for the header -->
        <div class="row mb-4">
            <div class="col-md-6">
                <a href="https://github.com/Cocoon-Data-Transformation/cocoon" target="_blank"
                    class="text-decoration-none text-dark">
                    <div class="d-flex align-items-center">
                        <img src="https://raw.githubusercontent.com/Cocoon-Data-Transformation/cocoon/main/images/cocoon_icon.png"
                            alt="cocoon icon" width="40" class="mr-3">
                        <div>
                            <h4 class="mb-0">Cocoon Data Model</h4>
                            <small class="mb-0">Note: Cocoon uses LLMs and can make mistakes</small>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-md-6 d-flex align-items-center justify-content-end">
                <h2>Fivetran Apple Store</h2>
            </div>
        </div>


        <div class="row">
            <div class="col-md-9">
                <div class="card">
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="cocoon_steps_source">

                                <nav class="navbar navbar-light bg-light">
                                    <span class="navbar-brand mb-0">
                                        <h5 class="card-title mb-0">Source Table</h5>
                                    </span>
                                    <ul class="nav">
                                        <li class="nav-item dropdown">
                                            <a class="nav-link dropdown-toggle active" href="#"
                                                id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                                Select Table
                                            </a>
                                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                                <a class="nav-link small active" data-toggle="tab" href="#cocoon_source_app">app</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_app_store_platform_version_source_type">app_store_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_app_store_source_type_device">app_store_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_app_store_territory_source_type">app_store_territory_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_crashes_app_version">crashes_app_version</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_crashes_platform_version">crashes_platform_version</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_downloads_platform_version_source_type">downloads_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_downloads_source_type_device">downloads_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_downloads_territory_source_type">downloads_territory_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_sales_account">sales_account</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_sales_subscription_events">sales_subscription_events</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_sales_subscription_summary">sales_subscription_summary</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_usage_app_version_source_type">usage_app_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_usage_platform_version_source_type">usage_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_usage_source_type_device">usage_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_source_usage_territory_source_type">usage_territory_source_type</a>
                                            </div>
                                        </li>
                                    </ul>
                                </nav>
                                <div class="container">
                                    <small class="text-muted">We display the source tables from the data warehouses to
                                        model.</small>
                                </div>
                                <hr>
                                <div class="scroll-container overflow-auto">
                                    <div class="tab-content mt-3">
                                        <div class="tab-pane fade show active" id="cocoon_source_app">
    <p class="text-center mb-0">app <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>is_enabled</th>
      <th>name</th>
      <th>asset_token</th>
      <th>pre_order_info</th>
      <th>icon_url</th>
      <th>app_opt_in_rate</th>
      <th>ios</th>
      <th>tvos</th>
      <th>is_bundle</th>
      <th>_fivetran_synced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>True</td>
      <td>Super Cool Name</td>
      <td>Random Asset Token</td>
      <td>NaN</td>
      <td>Random Icon URL</td>
      <td>10</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_app_store_platform_version_source_type">
    <p class="text-center mb-0">app_store_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>platform_version</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>impressions</th>
      <th>_fivetran_synced</th>
      <th>impressions_unique_device</th>
      <th>page_views</th>
      <th>page_views_unique_device</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-08-01 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-07-01 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-08-02 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-08-03 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>30</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>28</td>
      <td>30</td>
      <td>28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-08-04 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-04-18 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-04-19 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2020-12-04 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-01-31 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2020-12-25 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_app_store_source_type_device">
    <p class="text-center mb-0">app_store_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>device</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>impressions</th>
      <th>_fivetran_synced</th>
      <th>impressions_unique_device</th>
      <th>page_views</th>
      <th>page_views_unique_device</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-10-03 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-08-23 00:00:00+00:00</td>
      <td>iPad</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>8</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-10-06 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>1210</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>732</td>
      <td>146</td>
      <td>103</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-03-17 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>1757</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>1113</td>
      <td>209</td>
      <td>151</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-02-24 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-06-06 00:00:00+00:00</td>
      <td>iPad</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2020-11-15 00:00:00+00:00</td>
      <td>iPad</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-06-24 00:00:00+00:00</td>
      <td>iPad</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-03-17 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-07-12 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>Institutional Purchase</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_app_store_territory_source_type">
    <p class="text-center mb-0">app_store_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>source_type</th>
      <th>territory</th>
      <th>meets_threshold</th>
      <th>impressions</th>
      <th>_fivetran_synced</th>
      <th>impressions_unique_device</th>
      <th>page_views</th>
      <th>page_views_unique_device</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-09-17 00:00:00+00:00</td>
      <td>App Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2020-12-29 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-01-26 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2020-12-04 00:00:00+00:00</td>
      <td>App Store Browse</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-06-09 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-10-05 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>47</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>30</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-05-21 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-05-09 00:00:00+00:00</td>
      <td>App Store Browse</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-05-18 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>3</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-10-21 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>12345</td>
      <td>2021-10-23 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Kosovo</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12345</td>
      <td>2021-11-24 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Kosovo</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12345</td>
      <td>2021-10-24 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Côte d'Ivoire</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>12345</td>
      <td>2021-10-26 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Cote d'Ivoire</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>12345</td>
      <td>2021-11-26 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Cote d'Ivoire</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>12345</td>
      <td>2021-11-26 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Turkey</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>12345</td>
      <td>2021-11-26 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Türkiye</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_crashes_app_version">
    <p class="text-center mb-0">crashes_app_version <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>app_version</th>
      <th>date_</th>
      <th>device</th>
      <th>meets_threshold</th>
      <th>crashes</th>
      <th>_fivetran_synced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-01-22 00:00:00+00:00</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-01-07 00:00:00+00:00</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2020-11-15 00:00:00+00:00</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-06-18 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-07-30 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-05-02 00:00:00+00:00</td>
      <td>iPad</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-06-19 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2020-12-05 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2020-12-21 00:00:00+00:00</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-04-12 00:00:00+00:00</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_crashes_platform_version">
    <p class="text-center mb-0">crashes_platform_version <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>device</th>
      <th>platform_version</th>
      <th>meets_threshold</th>
      <th>crashes</th>
      <th>_fivetran_synced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-05-10 00:00:00+00:00</td>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-05-13 00:00:00+00:00</td>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-05-12 00:00:00+00:00</td>
      <td>iPod</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-05-11 00:00:00+00:00</td>
      <td>iPod</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-07-25 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-09-11 00:00:00+00:00</td>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-04-10 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-04-11 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-01-03 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-05-28 00:00:00+00:00</td>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_downloads_platform_version_source_type">
    <p class="text-center mb-0">downloads_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>platform_version</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>first_time_downloads</th>
      <th>_fivetran_synced</th>
      <th>redownloads</th>
      <th>total_downloads</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-04-05 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-05-27 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-04-06 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-05-28 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-04-27 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-05-11 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-05-29 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-04-26 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-06-17 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-05-30 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_downloads_source_type_device">
    <p class="text-center mb-0">downloads_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>device</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>first_time_downloads</th>
      <th>_fivetran_synced</th>
      <th>redownloads</th>
      <th>total_downloads</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-09-04 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2022-01-07 00:00:00+00:00</td>
      <td>iPad</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-07-14 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>153</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>153</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-05-01 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-09-15 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>Institutional Purchase</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-08-31 00:00:00+00:00</td>
      <td>iPod</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-06-18 00:00:00+00:00</td>
      <td>iPod</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-04-02 00:00:00+00:00</td>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2022-03-08 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-09-02 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>5</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>3</td>
      <td>8</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_downloads_territory_source_type">
    <p class="text-center mb-0">downloads_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>source_type</th>
      <th>territory</th>
      <th>meets_threshold</th>
      <th>first_time_downloads</th>
      <th>_fivetran_synced</th>
      <th>redownloads</th>
      <th>total_downloads</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-10-25 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-05-08 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-09-30 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-11-11 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2022-01-10 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-06-18 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-11-27 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-07-15 00:00:00+00:00</td>
      <td>App Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-04-07 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-06-05 00:00:00+00:00</td>
      <td>App Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_sales_account">
    <p class="text-center mb-0">sales_account <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>_fivetran_synced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>Super Cool Name</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_sales_subscription_events">
    <p class="text-center mb-0">sales_subscription_events <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_filename</th>
      <th>account_number</th>
      <th>vendor_number</th>
      <th>_index</th>
      <th>event_date</th>
      <th>app_name</th>
      <th>days_canceled</th>
      <th>subscription_name</th>
      <th>consecutive_paid_periods</th>
      <th>previous_subscription_name</th>
      <th>cancellation_reason</th>
      <th>proceeds_reason</th>
      <th>subscription_apple_id</th>
      <th>standard_subscription_duration</th>
      <th>original_start_date</th>
      <th>device</th>
      <th>days_before_canceling</th>
      <th>quantity</th>
      <th>marketing_opt_in_duration</th>
      <th>promotional_offer_name</th>
      <th>state</th>
      <th>previous_subscription_apple_id</th>
      <th>event</th>
      <th>subscription_group_id</th>
      <th>country</th>
      <th>promotional_offer_id</th>
      <th>app_apple_id</th>
      <th>_fivetran_synced</th>
      <th>subscription_offer_type</th>
      <th>subscription_offer_duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>9</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>3</td>
      <td>NaN</td>
      <td></td>
      <td>None</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2021-02-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>NJ</td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>25</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>14</td>
      <td>NaN</td>
      <td></td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2020-03-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>FL</td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>41</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>1</td>
      <td>NaN</td>
      <td>Canceled</td>
      <td>None</td>
      <td>12345</td>
      <td>1 Year</td>
      <td>2020-04-25</td>
      <td>iPhone</td>
      <td>176</td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>CA</td>
      <td></td>
      <td>Cancel</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>57</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>2</td>
      <td>NaN</td>
      <td></td>
      <td>None</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2021-03-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>CA</td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>73</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>3</td>
      <td>NaN</td>
      <td></td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>1 Year</td>
      <td>2019-04-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>GB</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>89</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>13</td>
      <td>NaN</td>
      <td></td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2020-04-24</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>ON</td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>CA</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>105</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>1</td>
      <td>NaN</td>
      <td>Canceled</td>
      <td>None</td>
      <td>12345</td>
      <td>1 Year</td>
      <td>2020-04-25</td>
      <td>iPad</td>
      <td>70</td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>CA</td>
      <td></td>
      <td>Cancel</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>121</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>13</td>
      <td>NaN</td>
      <td></td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2020-04-25</td>
      <td>iPad</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>AT</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>137</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>1</td>
      <td>NaN</td>
      <td></td>
      <td>None</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2021-04-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>MO</td>
      <td></td>
      <td>Subscribe</td>
      <td>12345</td>
      <td>US</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>153</td>
      <td>2021-04-25</td>
      <td>Super Cool Name</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>3</td>
      <td>NaN</td>
      <td></td>
      <td>None</td>
      <td>12345</td>
      <td>1 Month</td>
      <td>2021-02-25</td>
      <td>iPhone</td>
      <td></td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>KA</td>
      <td></td>
      <td>Renew</td>
      <td>12345</td>
      <td>IN</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_sales_subscription_summary">
    <p class="text-center mb-0">sales_subscription_summary <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_filename</th>
      <th>account_number</th>
      <th>vendor_number</th>
      <th>_index</th>
      <th>developer_proceeds</th>
      <th>app_name</th>
      <th>free_trial_promotional_offer_subscriptions</th>
      <th>proceeds_currency</th>
      <th>subscription_name</th>
      <th>pay_as_you_go_promotional_offer_subscriptions</th>
      <th>customer_currency</th>
      <th>marketing_opt_ins</th>
      <th>pay_up_front_promotional_offer_subscriptions</th>
      <th>billing_retry</th>
      <th>proceeds_reason</th>
      <th>subscription_apple_id</th>
      <th>active_standard_price_subscriptions</th>
      <th>standard_subscription_duration</th>
      <th>grace_period</th>
      <th>device</th>
      <th>active_pay_up_front_introductory_offer_subscriptions</th>
      <th>customer_price</th>
      <th>promotional_offer_name</th>
      <th>state</th>
      <th>active_pay_as_you_go_introductory_offer_subscriptions</th>
      <th>subscription_group_id</th>
      <th>country</th>
      <th>active_free_trial_introductory_offer_subscriptions</th>
      <th>promotional_offer_id</th>
      <th>app_apple_id</th>
      <th>_fivetran_synced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>9</td>
      <td>24.72</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>30</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>42.99</td>
      <td></td>
      <td></td>
      <td>0</td>
      <td>12345</td>
      <td>FR</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>25</td>
      <td>24.27</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>2</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>42.99</td>
      <td></td>
      <td></td>
      <td>0</td>
      <td>12345</td>
      <td>FI</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>41</td>
      <td>24.20</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>1</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>42.99</td>
      <td></td>
      <td>MI</td>
      <td>0</td>
      <td>12345</td>
      <td>IT</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>57</td>
      <td>3.50</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>5</td>
      <td>1 Month</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>4.99</td>
      <td></td>
      <td>MS</td>
      <td>0</td>
      <td>12345</td>
      <td>US</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>73</td>
      <td>3.50</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>None</td>
      <td>12345</td>
      <td>7</td>
      <td>1 Month</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>4.99</td>
      <td></td>
      <td>NJ</td>
      <td>0</td>
      <td>12345</td>
      <td>US</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>89</td>
      <td>31182.00</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>KRW</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>KRW</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>1</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>49000.00</td>
      <td></td>
      <td>부산</td>
      <td>0</td>
      <td>12345</td>
      <td>KR</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>105</td>
      <td>3.50</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>1</td>
      <td>1 Month</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>4.99</td>
      <td></td>
      <td>AA</td>
      <td>0</td>
      <td>12345</td>
      <td>US</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>121</td>
      <td>33.99</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>6</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>39.99</td>
      <td></td>
      <td>DC</td>
      <td>0</td>
      <td>12345</td>
      <td>US</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>137</td>
      <td>3.50</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td></td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>USD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>12345</td>
      <td>6</td>
      <td>1 Month</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>4.99</td>
      <td></td>
      <td>AZ</td>
      <td>0</td>
      <td>12345</td>
      <td>US</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>12345</td>
      <td>12345</td>
      <td>153</td>
      <td>29.67</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>EUR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Rate After One Year</td>
      <td>12345</td>
      <td>1</td>
      <td>1 Year</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>42.99</td>
      <td></td>
      <td>PO</td>
      <td>0</td>
      <td>12345</td>
      <td>IT</td>
      <td>0</td>
      <td></td>
      <td>12345</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_usage_app_version_source_type">
    <p class="text-center mb-0">usage_app_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>app_version</th>
      <th>date_</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>installations</th>
      <th>_fivetran_synced</th>
      <th>sessions</th>
      <th>active_devices</th>
      <th>active_devices_last_30_days</th>
      <th>deletions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-03-20 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-08-08 00:00:00+00:00</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-09-25 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-03-26 00:00:00+00:00</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2020-11-03 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-07-05 00:00:00+00:00</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-04-01 00:00:00+00:00</td>
      <td>Institutional Purchase</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-07-10 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-06-08 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>1.0.0 (iOS)</td>
      <td>2021-10-20 00:00:00+00:00</td>
      <td>Institutional Purchase</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_usage_platform_version_source_type">
    <p class="text-center mb-0">usage_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>platform_version</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>installations</th>
      <th>_fivetran_synced</th>
      <th>sessions</th>
      <th>active_devices</th>
      <th>active_devices_last_30_days</th>
      <th>deletions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-06-10 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-08-02 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-08-01 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-08-03 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-04-18 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-04-17 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-04-19 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-07-01 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-01-31 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-01-30 00:00:00+00:00</td>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_usage_source_type_device">
    <p class="text-center mb-0">usage_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>device</th>
      <th>source_type</th>
      <th>meets_threshold</th>
      <th>installations</th>
      <th>_fivetran_synced</th>
      <th>sessions</th>
      <th>active_devices</th>
      <th>active_devices_last_30_days</th>
      <th>deletions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2020-11-27 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>6</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>58</td>
      <td>34</td>
      <td>406</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2021-01-04 00:00:00+00:00</td>
      <td>Desktop</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-05-18 00:00:00+00:00</td>
      <td>iPad</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>8</td>
      <td>5</td>
      <td>60</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-09-10 00:00:00+00:00</td>
      <td>iPod</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-02-19 00:00:00+00:00</td>
      <td>iPad</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>10</td>
      <td>3</td>
      <td>55</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-07-13 00:00:00+00:00</td>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2020-12-22 00:00:00+00:00</td>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2021-07-31 00:00:00+00:00</td>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-01-09 00:00:00+00:00</td>
      <td>iPad</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>6</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>41</td>
      <td>21</td>
      <td>273</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-02-25 00:00:00+00:00</td>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>3</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>65</td>
      <td>27</td>
      <td>374</td>
      <td>5</td>
    </tr>
  </tbody>
</table></div>
    </div><div class="tab-pane fade " id="cocoon_source_usage_territory_source_type">
    <p class="text-center mb-0">usage_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_id</th>
      <th>date_</th>
      <th>source_type</th>
      <th>territory</th>
      <th>meets_threshold</th>
      <th>installations</th>
      <th>_fivetran_synced</th>
      <th>sessions</th>
      <th>active_devices</th>
      <th>active_devices_last_30_days</th>
      <th>deletions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12345</td>
      <td>2021-05-21 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>4</td>
      <td>3</td>
      <td>44</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12345</td>
      <td>2020-12-28 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>1</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12345</td>
      <td>2021-06-07 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12345</td>
      <td>2021-09-22 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>10</td>
      <td>5</td>
      <td>42</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12345</td>
      <td>2021-07-02 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12345</td>
      <td>2021-03-16 00:00:00+00:00</td>
      <td>App Store Browse</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12345</td>
      <td>2021-09-30 00:00:00+00:00</td>
      <td>Web Referrer</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12345</td>
      <td>2020-11-23 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12345</td>
      <td>2021-02-13 00:00:00+00:00</td>
      <td>Unavailable</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12345</td>
      <td>2021-09-09 00:00:00+00:00</td>
      <td>App Store Search</td>
      <td>Canada</td>
      <td>True</td>
      <td>0</td>
      <td>2022-01-02 12:34:56.789000+00:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table></div>
    </div>
                                    </div>
                                </div>

                            </div>

                            <div class="tab-pane fade" id="cocoon_steps_stage">
                                <nav class="navbar navbar-light bg-light">
                                    <span class="navbar-brand mb-0">
                                        <h5 class="card-title mb-0">Stage Table</h5>
                                    </span>
                                    <ul class="nav">
                                        <li class="nav-item dropdown">
                                            <a class="nav-link dropdown-toggle active" href="#"
                                                id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                                Select Table
                                            </a>
                                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                                <a class="nav-link small active" data-toggle="tab" href="#cocoon_stage_stg_downloads_source_type_device">stg_downloads_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_downloads_platform_version_source_type">stg_downloads_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_app_store_territory_source_type">stg_app_store_territory_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_usage_platform_version_source_type">stg_usage_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_sales_subscription_events">stg_sales_subscription_events</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_sales_subscription_summary">stg_sales_subscription_summary</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_app_store_source_type_device">stg_app_store_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_downloads_territory_source_type">stg_downloads_territory_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_sales_account">stg_sales_account</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_usage_territory_source_type">stg_usage_territory_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_app_store_platform_version_source_type">stg_app_store_platform_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_crashes_platform_version">stg_crashes_platform_version</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_usage_app_version_source_type">stg_usage_app_version_source_type</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_app">stg_app</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_usage_source_type_device">stg_usage_source_type_device</a><a class="nav-link small " data-toggle="tab" href="#cocoon_stage_stg_crashes_app_version">stg_crashes_app_version</a>
                                            </div>
                                        </li>
                                    </ul>
                                </nav>
                                <div class="container">
                                    <small class="text-muted">Source tables may have typos, unclear names, incorrect
                                        column types, etc. We clean these tables.</small>
                                </div>
                                <hr>
                                <div class="scroll-container overflow-auto">
                                    <div class="tab-content mt-3">
                                       <div class="tab-pane fade show active" id="cocoon_stage_stg_downloads_source_type_device">
    <p class="text-center mb-0">stg_downloads_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device_type</th>
      <th>download_source</th>
      <th>threshold_met</th>
      <th>new_downloads</th>
      <th>redownloads</th>
      <th>total_downloads</th>
      <th>app_id</th>
      <th>timestamp_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iPhone</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-09-04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>iPad</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>12345</td>
      <td>2022-01-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>iPhone</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>153</td>
      <td>0</td>
      <td>153</td>
      <td>12345</td>
      <td>2021-07-14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>12345</td>
      <td>2021-05-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Desktop</td>
      <td>Institutional Purchase</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-09-15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>iPod</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-08-31</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iPod</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-06-18</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-02</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Desktop</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2022-03-08</td>
    </tr>
    <tr>
      <th>9</th>
      <td>iPhone</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>5</td>
      <td>3</td>
      <td>8</td>
      <td>12345</td>
      <td>2021-09-02</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_downloads_source_type_device.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"downloads_source_type_device_projected" AS (
    -- Projection: Selecting 8 out of 9 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "device",
        "source_type",
        "meets_threshold",
        "first_time_downloads",
        "redownloads",
        "total_downloads"
    FROM "downloads_source_type_device"
),

"downloads_source_type_device_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> timestamp_
    -- device -> device_type
    -- source_type -> download_source
    -- meets_threshold -> threshold_met
    -- first_time_downloads -> new_downloads
    SELECT 
        app_id,
        date_ AS timestamp_,
        device AS device_type,
        source_type AS download_source,
        meets_threshold AS threshold_met,
        first_time_downloads AS new_downloads,
        redownloads,
        total_downloads
    FROM downloads_source_type_device_projected
),

"downloads_source_type_device_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- timestamp_: from VARCHAR to TIMESTAMP
    SELECT
        "device_type",
        "download_source",
        "threshold_met",
        "new_downloads",
        "redownloads",
        "total_downloads",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("timestamp_" AS TIMESTAMP) AS "timestamp_"
    FROM "downloads_source_type_device_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "downloads_source_type_device_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_downloads_source_type_device.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_downloads_source_type_device
  description: The table is about app downloads statistics. It includes details like
    app ID, date, device type, download source, whether it meets a threshold, number
    of first-time downloads, redownloads, and total downloads. The data is broken
    down by different source types (e.g., App Store Browse, Web Referrer) and devices
    (e.g., iPhone, iPad).
  columns:
  - name: device_type
    description: Type of device used for download
    tests:
    - not_null
    - accepted_values:
        values:
        - iPhone
        - iPod
        - Desktop
        - iPad
        - Android Phone
        - Android Tablet
        - Windows Phone
        - Smart TV
        - Gaming Console
        - eReader
        - Smartwatch
        - Other
  - name: download_source
    description: Source or channel of the download
    tests:
    - not_null
    - accepted_values:
        values:
        - App Store Browse
        - Web Referrer
        - App Store Search
        - App Referrer
        - Institutional Purchase
        - Google Play Store Browse
        - Google Play Store Search
        - App Store Update
        - Google Play Store Update
        - Direct Link
        - Email Campaign
        - Social Media
        - In-App Advertisement
        - Push Notification
        - App Store Featured
        - Google Play Store Featured
        - Third-Party App Store
        - Pre-installed
        - QR Code Scan
        - SMS Link
  - name: threshold_met
    description: Indicates if download count meets a certain threshold
    tests:
    - not_null
  - name: new_downloads
    description: Number of first-time downloads
    tests:
    - not_null
  - name: redownloads
    description: Number of redownloads by existing users
    tests:
    - not_null
  - name: total_downloads
    description: Total number of downloads including first-time and redownloads
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: timestamp_
    description: Date and time of the download statistics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_downloads_platform_version_source_type">
    <p class="text-center mb-0">stg_downloads_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>download_source</th>
      <th>first_time_downloads</th>
      <th>redownloads</th>
      <th>total_downloads</th>
      <th>platform_version</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>statistics_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-29</td>
    </tr>
    <tr>
      <th>7</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-26</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-17</td>
    </tr>
    <tr>
      <th>9</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-30</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_downloads_platform_version_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"downloads_platform_version_source_type_projected" AS (
    -- Projection: Selecting 8 out of 9 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "platform_version",
        "source_type",
        "meets_threshold",
        "first_time_downloads",
        "redownloads",
        "total_downloads"
    FROM "downloads_platform_version_source_type"
),

"downloads_platform_version_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> statistics_date
    -- source_type -> download_source
    SELECT 
        app_id,
        date_ AS statistics_date,
        platform_version,
        source_type AS download_source,
        meets_threshold,
        first_time_downloads,
        redownloads,
        total_downloads
    FROM downloads_platform_version_source_type_projected
),

"downloads_platform_version_source_type_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- download_source: ['Unavailable']
    SELECT 
        CASE
            WHEN "download_source" = 'Unavailable' THEN NULL
            ELSE "download_source"
        END AS "download_source",
        "statistics_date",
        "first_time_downloads",
        "redownloads",
        "app_id",
        "total_downloads",
        "platform_version",
        "meets_threshold"
    FROM "downloads_platform_version_source_type_projected_renamed"
),

"downloads_platform_version_source_type_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- statistics_date: from VARCHAR to TIMESTAMP
    SELECT
        "download_source",
        "first_time_downloads",
        "redownloads",
        "total_downloads",
        "platform_version",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("statistics_date" AS TIMESTAMP) AS "statistics_date"
    FROM "downloads_platform_version_source_type_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "downloads_platform_version_source_type_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_downloads_platform_version_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_downloads_platform_version_source_type
  description: The table is about app download statistics. It includes details like
    app ID, date, platform version, source type, and download counts. Each row represents
    download data for a specific app on a particular date, platform version, and source
    type. The table tracks first-time downloads, redownloads, and total downloads,
    along with whether the data meets a certain threshold.
  columns:
  - name: download_source
    description: Source of the app download
    tests:
    - not_null
    - accepted_values:
        values:
        - App Referrer
        - App Store Search
        - Web Referrer
        - Google Play Store
        - Apple App Store
        - Direct Download
        - In-App Advertisement
        - Social Media Link
        - Email Campaign
        - QR Code
        - SMS Link
        - Third-Party App Store
        - Pre-installed
        - Developer Website
        - Affiliate Link
  - name: first_time_downloads
    description: Number of first-time downloads for the app
    tests:
    - not_null
  - name: redownloads
    description: Number of times the app was redownloaded
    tests:
    - not_null
  - name: total_downloads
    description: Total number of downloads including first-time and redownloads
    tests:
    - not_null
  - name: platform_version
    description: Version of the operating system platform
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if the data meets a certain threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: statistics_date
    description: Date of the download statistics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_app_store_territory_source_type">
    <p class="text-center mb-0">stg_app_store_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>discovery_source</th>
      <th>unique_device_impressions</th>
      <th>page_views</th>
      <th>unique_device_page_views</th>
      <th>impressions</th>
      <th>territory</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>metric_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>App Store Search</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-12-29</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-01-26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-12-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-09</td>
    </tr>
    <tr>
      <th>5</th>
      <td>App Store Search</td>
      <td>30</td>
      <td>5</td>
      <td>4</td>
      <td>47</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-05</td>
    </tr>
    <tr>
      <th>6</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-21</td>
    </tr>
    <tr>
      <th>7</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-09</td>
    </tr>
    <tr>
      <th>8</th>
      <td>App Store Search</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-21</td>
    </tr>
    <tr>
      <th>10</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Kosovo</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-23</td>
    </tr>
    <tr>
      <th>11</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Kosovo</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-24</td>
    </tr>
    <tr>
      <th>12</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Côte d'Ivoire</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-24</td>
    </tr>
    <tr>
      <th>13</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Côte d'Ivoire</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-26</td>
    </tr>
    <tr>
      <th>14</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Côte d'Ivoire</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-26</td>
    </tr>
    <tr>
      <th>15</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Türkiye</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-26</td>
    </tr>
    <tr>
      <th>16</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>Türkiye</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-26</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_app_store_territory_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"app_store_territory_source_type_projected" AS (
    -- Projection: Selecting 9 out of 10 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "source_type",
        "territory",
        "meets_threshold",
        "impressions",
        "impressions_unique_device",
        "page_views",
        "page_views_unique_device"
    FROM "app_store_territory_source_type"
),

"app_store_territory_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> metric_date
    -- source_type -> discovery_source
    -- impressions_unique_device -> unique_device_impressions
    -- page_views_unique_device -> unique_device_page_views
    SELECT 
        app_id,
        date_ AS metric_date,
        source_type AS discovery_source,
        territory,
        meets_threshold,
        impressions,
        impressions_unique_device AS unique_device_impressions,
        page_views,
        page_views_unique_device AS unique_device_page_views
    FROM app_store_territory_source_type_projected
),

"app_store_territory_source_type_projected_renamed_cleaned" AS (
    -- Clean unusual string values: 
    -- territory: The problem is inconsistent naming for 'Cote d'Ivoire' vs 'Côte d'Ivoire', and 'Turkey' vs 'Türkiye'. The correct values are 'Côte d'Ivoire' and 'Türkiye', based on their more frequent occurrences. 
    SELECT
        "app_id",
        "metric_date",
        "discovery_source",
        CASE
            WHEN "territory" = 'Cote d''Ivoire' THEN 'Côte d''Ivoire'
            WHEN "territory" = 'Turkey' THEN 'Türkiye'
            ELSE "territory"
        END AS "territory",
        "meets_threshold",
        "impressions",
        "unique_device_impressions",
        "page_views",
        "unique_device_page_views"
    FROM "app_store_territory_source_type_projected_renamed"
),

"app_store_territory_source_type_projected_renamed_cleaned_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- discovery_source: ['Unavailable']
    SELECT 
        CASE
            WHEN "discovery_source" = 'Unavailable' THEN NULL
            ELSE "discovery_source"
        END AS "discovery_source",
        "unique_device_impressions",
        "page_views",
        "metric_date",
        "app_id",
        "unique_device_page_views",
        "impressions",
        "territory",
        "meets_threshold"
    FROM "app_store_territory_source_type_projected_renamed_cleaned"
),

"app_store_territory_source_type_projected_renamed_cleaned_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- metric_date: from VARCHAR to TIMESTAMP
    SELECT
        "discovery_source",
        "unique_device_impressions",
        "page_views",
        "unique_device_page_views",
        "impressions",
        "territory",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("metric_date" AS TIMESTAMP) AS "metric_date"
    FROM "app_store_territory_source_type_projected_renamed_cleaned_null"
)

-- COCOON BLOCK END
SELECT * FROM "app_store_territory_source_type_projected_renamed_cleaned_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_app_store_territory_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_app_store_territory_source_type
  description: The table is about app performance metrics in the App Store. It includes
    details such as app ID, date, source type, territory, and various engagement metrics.
    The metrics cover impressions, page views, and unique device interactions. The
    data is segmented by different source types like App Store Search and Web Referrer.
    It also indicates whether the data meets a certain threshold.
  columns:
  - name: discovery_source
    description: Channel through which the app was discovered
    tests:
    - accepted_values:
        values:
        - App Store Search
        - App Store Browse
        - App Referrer
        - Web Referrer
        - Social Media
        - Word of Mouth
        - Advertisement
        - Email Marketing
        - Push Notification
        - In-App Promotion
        - App Store Featuring
        - Press/Media Coverage
        - Influencer Promotion
        - App Store Optimization
        - Google Play Store Search
        - Google Play Store Browse
        - Third-Party App Store
        - Pre-installed on Device
        - QR Code
        - SMS/Text Message
    cocoon_meta:
      missing_acceptable: No specific discovery source for some app impressions.
  - name: unique_device_impressions
    description: Number of unique devices that viewed the app
    tests:
    - not_null
  - name: page_views
    description: Number of times the app page was viewed
    tests:
    - not_null
  - name: unique_device_page_views
    description: Number of unique devices that viewed the app page
    tests:
    - not_null
  - name: impressions
    description: Number of times the app was viewed
    tests:
    - not_null
  - name: territory
    description: Geographic region of the data
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if data meets a certain threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: metric_date
    description: Date of the recorded metrics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_usage_platform_version_source_type">
    <p class="text-center mb-0">stg_usage_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>os_version</th>
      <th>acquisition_source</th>
      <th>meets_threshold</th>
      <th>daily_installations</th>
      <th>daily_sessions</th>
      <th>daily_active_devices</th>
      <th>monthly_active_devices</th>
      <th>daily_deletions</th>
      <th>app_id</th>
      <th>record_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-06-10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-08-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-08-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iOS 1.0</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-08-03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-18</td>
    </tr>
    <tr>
      <th>5</th>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-17</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iOS 1.0</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iOS 1.0</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-07-01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-01-31</td>
    </tr>
    <tr>
      <th>9</th>
      <td>iOS 1.0</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1</td>
      <td>12345</td>
      <td>2021-01-30</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_usage_platform_version_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"usage_platform_version_source_type_projected" AS (
    -- Projection: Selecting 10 out of 11 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "platform_version",
        "source_type",
        "meets_threshold",
        "installations",
        "sessions",
        "active_devices",
        "active_devices_last_30_days",
        "deletions"
    FROM "usage_platform_version_source_type"
),

"usage_platform_version_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> record_date
    -- platform_version -> os_version
    -- source_type -> acquisition_source
    -- installations -> daily_installations
    -- sessions -> daily_sessions
    -- active_devices -> daily_active_devices
    -- active_devices_last_30_days -> monthly_active_devices
    -- deletions -> daily_deletions
    SELECT 
        app_id,
        date_ AS record_date,
        platform_version AS os_version,
        source_type AS acquisition_source,
        meets_threshold,
        installations AS daily_installations,
        sessions AS daily_sessions,
        active_devices AS daily_active_devices,
        active_devices_last_30_days AS monthly_active_devices,
        deletions AS daily_deletions
    FROM usage_platform_version_source_type_projected
),

"usage_platform_version_source_type_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- record_date: from VARCHAR to TIMESTAMP
    SELECT
        "os_version",
        "acquisition_source",
        "meets_threshold",
        "daily_installations",
        "daily_sessions",
        "daily_active_devices",
        "monthly_active_devices",
        "daily_deletions",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("record_date" AS TIMESTAMP) AS "record_date"
    FROM "usage_platform_version_source_type_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "usage_platform_version_source_type_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_usage_platform_version_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_usage_platform_version_source_type
  description: The table is about app usage data. It includes details like app ID,
    date, platform version, source type, and various metrics. Metrics cover installations,
    sessions, active devices, and deletions. The data is segmented by platform version
    and acquisition source. It also indicates if the data meets a certain threshold.
  columns:
  - name: os_version
    description: Version of the operating system
    tests:
    - not_null
  - name: acquisition_source
    description: Channel through which the app was acquired
    tests:
    - not_null
    - accepted_values:
        values:
        - App Referrer
        - App Store Browse
        - App Store Search
        - Web Referrer
        - Social Media
        - Email Marketing
        - Push Notifications
        - Paid Advertising
        - Organic Search
        - Word of Mouth
        - In-App Referral
        - QR Code
        - App Store Featured
        - Cross-Promotion
        - Influencer Marketing
        - Offline Marketing
        - Pre-installed
  - name: meets_threshold
    description: Indicates if data meets a certain threshold
    tests:
    - not_null
  - name: daily_installations
    description: Number of app installations on the given date
    tests:
    - not_null
  - name: daily_sessions
    description: Number of app sessions on the given date
    tests:
    - not_null
  - name: daily_active_devices
    description: Number of active devices on the given date
    tests:
    - not_null
  - name: monthly_active_devices
    description: Number of active devices in the last 30 days
    tests:
    - not_null
  - name: daily_deletions
    description: Number of app deletions on the given date
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: record_date
    description: Date of the recorded data
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_sales_subscription_events">
    <p class="text-center mb-0">stg_sales_subscription_events <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cancellation_reason</th>
      <th>promotional_offer_name</th>
      <th>user_state</th>
      <th>previous_subscription_apple_id</th>
      <th>promotional_offer_id</th>
      <th>subscription_name</th>
      <th>row_index</th>
      <th>source_file</th>
      <th>consecutive_paid_periods</th>
      <th>event_type</th>
      <th>device_type</th>
      <th>standard_subscription_duration</th>
      <th>proceeds_reason</th>
      <th>country_code</th>
      <th>subscription_quantity</th>
      <th>app_name</th>
      <th>account_number</th>
      <th>app_apple_id</th>
      <th>days_before_canceling</th>
      <th>days_canceled</th>
      <th>event_date</th>
      <th>original_start_date</th>
      <th>previous_subscription_name</th>
      <th>subscription_apple_id</th>
      <th>subscription_group_id</th>
      <th>subscription_offer_duration</th>
      <th>subscription_offer_type</th>
      <th>vendor_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>None</td>
      <td>NJ</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>9</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>3</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>None</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2021-02-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>1</th>
      <td>None</td>
      <td>None</td>
      <td>FL</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>25</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>14</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>Rate After One Year</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2020-03-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Canceled</td>
      <td>None</td>
      <td>CA</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>41</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>1</td>
      <td>Cancel</td>
      <td>iPhone</td>
      <td>1 Year</td>
      <td>None</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>176.0</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2020-04-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>3</th>
      <td>None</td>
      <td>None</td>
      <td>CA</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>57</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>2</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>None</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2021-03-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>73</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>3</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Year</td>
      <td>Rate After One Year</td>
      <td>GB</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2019-04-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>5</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>89</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>13</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>Rate After One Year</td>
      <td>CA</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2020-04-24</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Canceled</td>
      <td>None</td>
      <td>CA</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>105</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>1</td>
      <td>Cancel</td>
      <td>iPad</td>
      <td>1 Year</td>
      <td>None</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>70.0</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2020-04-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>7</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>121</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>13</td>
      <td>Renew</td>
      <td>iPad</td>
      <td>1 Month</td>
      <td>Rate After One Year</td>
      <td>AT</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2020-04-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>None</td>
      <td>MO</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>137</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>1</td>
      <td>Subscribe</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>None</td>
      <td>US</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2021-04-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>9</th>
      <td>None</td>
      <td>None</td>
      <td>KS</td>
      <td>None</td>
      <td>None</td>
      <td>Super Cool Name</td>
      <td>153</td>
      <td>Subscription_Event_12345678_20220102_V1_2.txt.gz</td>
      <td>3</td>
      <td>Renew</td>
      <td>iPhone</td>
      <td>1 Month</td>
      <td>None</td>
      <td>IN</td>
      <td>1</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021-04-25</td>
      <td>2021-02-25</td>
      <td>None</td>
      <td>12345</td>
      <td>12345</td>
      <td>None</td>
      <td>None</td>
      <td>12345</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_sales_subscription_events.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"sales_subscription_events_projected" AS (
    -- Projection: Selecting 29 out of 30 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "_filename",
        "account_number",
        "vendor_number",
        "_index",
        "event_date",
        "app_name",
        "days_canceled",
        "subscription_name",
        "consecutive_paid_periods",
        "previous_subscription_name",
        "cancellation_reason",
        "proceeds_reason",
        "subscription_apple_id",
        "standard_subscription_duration",
        "original_start_date",
        "device",
        "days_before_canceling",
        "quantity",
        "marketing_opt_in_duration",
        "promotional_offer_name",
        "state",
        "previous_subscription_apple_id",
        "event",
        "subscription_group_id",
        "country",
        "promotional_offer_id",
        "app_apple_id",
        "subscription_offer_type",
        "subscription_offer_duration"
    FROM "sales_subscription_events"
),

"sales_subscription_events_projected_renamed" AS (
    -- Rename: Renaming columns
    -- _filename -> source_file
    -- _index -> row_index
    -- device -> device_type
    -- quantity -> subscription_quantity
    -- state -> user_state
    -- event -> event_type
    -- country -> country_code
    SELECT 
        _filename AS source_file,
        account_number,
        vendor_number,
        _index AS row_index,
        event_date,
        app_name,
        days_canceled,
        subscription_name,
        consecutive_paid_periods,
        previous_subscription_name,
        cancellation_reason,
        proceeds_reason,
        subscription_apple_id,
        standard_subscription_duration,
        original_start_date,
        device AS device_type,
        days_before_canceling,
        quantity AS subscription_quantity,
        marketing_opt_in_duration,
        promotional_offer_name,
        state AS user_state,
        previous_subscription_apple_id,
        event AS event_type,
        subscription_group_id,
        country AS country_code,
        promotional_offer_id,
        app_apple_id,
        subscription_offer_type,
        subscription_offer_duration
    FROM sales_subscription_events_projected
),

"sales_subscription_events_projected_renamed_trimmed" AS (
    -- Trim Leading and Trailing Spaces
    SELECT
        "source_file",
        "account_number",
        "vendor_number",
        "row_index",
        "event_date",
        "app_name",
        "subscription_name",
        "consecutive_paid_periods",
        "previous_subscription_name",
        "proceeds_reason",
        "subscription_apple_id",
        "standard_subscription_duration",
        "original_start_date",
        "device_type",
        "subscription_quantity",
        "event_type",
        "subscription_group_id",
        "country_code",
        "app_apple_id",
        "subscription_offer_type",
        "subscription_offer_duration",
        TRIM("days_canceled") AS "days_canceled",
        TRIM("cancellation_reason") AS "cancellation_reason",
        TRIM("days_before_canceling") AS "days_before_canceling",
        TRIM("marketing_opt_in_duration") AS "marketing_opt_in_duration",
        TRIM("promotional_offer_name") AS "promotional_offer_name",
        TRIM("user_state") AS "user_state",
        TRIM("previous_subscription_apple_id") AS "previous_subscription_apple_id",
        TRIM("promotional_offer_id") AS "promotional_offer_id"
    FROM "sales_subscription_events_projected_renamed"
),

"sales_subscription_events_projected_renamed_trimmed_cleaned" AS (
    -- Clean unusual string values: 
    -- user_state: The problem is that this column contains non-standard US state abbreviations and empty values. 'KA' is likely a typo for 'KS' (Kansas). 'ON' is not a US state abbreviation, but could represent Ontario, Canada. Empty values should be preserved as they might represent missing data. The correct values should be standard US state abbreviations or empty strings for missing data. 
    SELECT
        "source_file",
        "account_number",
        "vendor_number",
        "row_index",
        "event_date",
        "app_name",
        "subscription_name",
        "consecutive_paid_periods",
        "previous_subscription_name",
        "proceeds_reason",
        "subscription_apple_id",
        "standard_subscription_duration",
        "original_start_date",
        "device_type",
        "subscription_quantity",
        "event_type",
        "subscription_group_id",
        "country_code",
        "app_apple_id",
        "subscription_offer_type",
        "subscription_offer_duration",
        "days_canceled",
        "cancellation_reason",
        "days_before_canceling",
        "marketing_opt_in_duration",
        "promotional_offer_name",
        CASE
            WHEN "user_state" = 'KA' THEN 'KS'
            WHEN "user_state" = 'ON' THEN ''
            ELSE "user_state"
        END AS "user_state",
        "previous_subscription_apple_id",
        "promotional_offer_id"
    FROM "sales_subscription_events_projected_renamed_trimmed"
),

"sales_subscription_events_projected_renamed_trimmed_cleaned_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- days_canceled: ['']
    -- cancellation_reason: ['']
    -- days_before_canceling: ['']
    -- marketing_opt_in_duration: ['']
    -- promotional_offer_name: ['']
    -- user_state: ['']
    -- previous_subscription_apple_id: ['']
    -- promotional_offer_id: ['']
    SELECT 
        CASE
            WHEN "days_canceled" = '' THEN NULL
            ELSE "days_canceled"
        END AS "days_canceled",
        CASE
            WHEN "cancellation_reason" = '' THEN NULL
            ELSE "cancellation_reason"
        END AS "cancellation_reason",
        CASE
            WHEN "days_before_canceling" = '' THEN NULL
            ELSE "days_before_canceling"
        END AS "days_before_canceling",
        CASE
            WHEN "marketing_opt_in_duration" = '' THEN NULL
            ELSE "marketing_opt_in_duration"
        END AS "marketing_opt_in_duration",
        CASE
            WHEN "promotional_offer_name" = '' THEN NULL
            ELSE "promotional_offer_name"
        END AS "promotional_offer_name",
        CASE
            WHEN "user_state" = '' THEN NULL
            ELSE "user_state"
        END AS "user_state",
        CASE
            WHEN "previous_subscription_apple_id" = '' THEN NULL
            ELSE "previous_subscription_apple_id"
        END AS "previous_subscription_apple_id",
        CASE
            WHEN "promotional_offer_id" = '' THEN NULL
            ELSE "promotional_offer_id"
        END AS "promotional_offer_id",
        "subscription_name",
        "app_apple_id",
        "row_index",
        "subscription_apple_id",
        "subscription_group_id",
        "previous_subscription_name",
        "source_file",
        "subscription_offer_duration",
        "consecutive_paid_periods",
        "account_number",
        "event_type",
        "device_type",
        "original_start_date",
        "standard_subscription_duration",
        "proceeds_reason",
        "country_code",
        "subscription_offer_type",
        "vendor_number",
        "event_date",
        "subscription_quantity",
        "app_name"
    FROM "sales_subscription_events_projected_renamed_trimmed_cleaned"
),

"sales_subscription_events_projected_renamed_trimmed_cleaned_null_casted" AS (
    -- Column Type Casting: 
    -- account_number: from INT to VARCHAR
    -- app_apple_id: from INT to VARCHAR
    -- days_before_canceling: from VARCHAR to INT
    -- days_canceled: from VARCHAR to INT
    -- event_date: from VARCHAR to DATE
    -- original_start_date: from VARCHAR to DATE
    -- previous_subscription_name: from DECIMAL to VARCHAR
    -- subscription_apple_id: from INT to VARCHAR
    -- subscription_group_id: from INT to VARCHAR
    -- subscription_offer_duration: from DECIMAL to VARCHAR
    -- subscription_offer_type: from DECIMAL to VARCHAR
    -- vendor_number: from INT to VARCHAR
    SELECT
        "cancellation_reason",
        "marketing_opt_in_duration",
        "promotional_offer_name",
        "user_state",
        "previous_subscription_apple_id",
        "promotional_offer_id",
        "subscription_name",
        "row_index",
        "source_file",
        "consecutive_paid_periods",
        "event_type",
        "device_type",
        "standard_subscription_duration",
        "proceeds_reason",
        "country_code",
        "subscription_quantity",
        "app_name",
        CAST("account_number" AS VARCHAR) AS "account_number",
        CAST("app_apple_id" AS VARCHAR) AS "app_apple_id",
        CAST("days_before_canceling" AS INT) AS "days_before_canceling",
        CAST("days_canceled" AS INT) AS "days_canceled",
        CAST("event_date" AS DATE) AS "event_date",
        CAST("original_start_date" AS DATE) AS "original_start_date",
        CAST("previous_subscription_name" AS VARCHAR) AS "previous_subscription_name",
        CAST("subscription_apple_id" AS VARCHAR) AS "subscription_apple_id",
        CAST("subscription_group_id" AS VARCHAR) AS "subscription_group_id",
        CAST("subscription_offer_duration" AS VARCHAR) AS "subscription_offer_duration",
        CAST("subscription_offer_type" AS VARCHAR) AS "subscription_offer_type",
        CAST("vendor_number" AS VARCHAR) AS "vendor_number"
    FROM "sales_subscription_events_projected_renamed_trimmed_cleaned_null"
),

"sales_subscription_events_projected_renamed_trimmed_cleaned_null_casted_missing_handled" AS (
    -- Handling missing values: There are 3 columns with unacceptable missing values
    -- marketing_opt_in_duration has 100.0 percent missing. Strategy: 🗑️ Drop Column
    -- proceeds_reason has 60.0 percent missing. Strategy: 🔄 Unchanged
    -- user_state has 30.0 percent missing. Strategy: 🔄 Unchanged
    SELECT
        "cancellation_reason",
        "promotional_offer_name",
        "user_state",
        "previous_subscription_apple_id",
        "promotional_offer_id",
        "subscription_name",
        "row_index",
        "source_file",
        "consecutive_paid_periods",
        "event_type",
        "device_type",
        "standard_subscription_duration",
        "proceeds_reason",
        "country_code",
        "subscription_quantity",
        "app_name",
        "account_number",
        "app_apple_id",
        "days_before_canceling",
        "days_canceled",
        "event_date",
        "original_start_date",
        "previous_subscription_name",
        "subscription_apple_id",
        "subscription_group_id",
        "subscription_offer_duration",
        "subscription_offer_type",
        "vendor_number"
    FROM "sales_subscription_events_projected_renamed_trimmed_cleaned_null_casted"
)

-- COCOON BLOCK END
SELECT * FROM "sales_subscription_events_projected_renamed_trimmed_cleaned_null_casted_missing_handled"</code></pre>
    </div>
    <p class="text-center">stg_sales_subscription_events.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_sales_subscription_events
  description: The table is about subscription events for an app. It includes details
    like account number, event date, app name, subscription name, event type (renew/cancel),
    consecutive paid periods, subscription duration, country, and device. Each row
    represents a specific subscription event with associated attributes like renewal
    status, cancellation reasons, and promotional offers.
  columns:
  - name: cancellation_reason
    description: Reason for subscription cancellation
    tests:
    - accepted_values:
        values:
        - Too expensive
        - No longer needed
        - Switched to competitor
        - Poor service quality
        - Technical issues
        - Changed circumstances
        - Found better alternative
        - Billing problems
        - Lack of features
        - Unused subscription
        - Dissatisfied with product
        - Company policy change
        - Budget cuts
        - Temporary pause
        - Moving/Relocating
        - Other
        - Canceled
    cocoon_meta:
      missing_acceptable: Not applicable for renewals or non-canceled subscriptions
  - name: promotional_offer_name
    description: Name of promotional offer
    cocoon_meta:
      missing_acceptable: Not applicable if no promotional offer was used
  - name: user_state
    description: State or region of the user
    tests:
    - not_null
    - accepted_values:
        values:
        - AL
        - AK
        - AZ
        - AR
        - CA
        - CO
        - CT
        - DE
        - FL
        - GA
        - HI
        - ID
        - IL
        - IN
        - IA
        - KS
        - KY
        - LA
        - ME
        - MD
        - MA
        - MI
        - MN
        - MS
        - MO
        - MT
        - NE
        - NV
        - NH
        - NJ
        - NM
        - NY
        - NC
        - ND
        - OH
        - OK
        - OR
        - PA
        - RI
        - SC
        - SD
        - TN
        - TX
        - UT
        - VT
        - VA
        - WA
        - WV
        - WI
        - WY
  - name: previous_subscription_apple_id
    description: Apple ID of previous subscription
    cocoon_meta:
      missing_acceptable: Not applicable for first-time subscribers
  - name: promotional_offer_id
    description: Identifier for promotional offer
    cocoon_meta:
      missing_acceptable: Not applicable if no promotional offer was used
  - name: subscription_name
    description: Name of the subscription
    tests:
    - not_null
  - name: row_index
    description: Row index in the source file
    tests:
    - not_null
    - unique
    cocoon_meta:
      uniqueness: This column represents the row index in the source file. For this
        table, each row is a specific subscription event. The row_index appears to
        be unique across rows in the given sample, and it's likely to be unique across
        the entire dataset if it represents the actual row number in the source file.
  - name: source_file
    description: Name of the source file
    tests:
    - not_null
  - name: consecutive_paid_periods
    description: Number of consecutive paid subscription periods
    tests:
    - not_null
  - name: event_type
    description: Type of subscription event (e.g., Renew, Cancel)
    tests:
    - not_null
    - accepted_values:
        values:
        - Renew
        - Cancel
        - Subscribe
        - Upgrade
        - Downgrade
        - Pause
        - Resume
        - Trial
        - Expire
        - Refund
  - name: device_type
    description: Device used for the subscription
    tests:
    - not_null
    - accepted_values:
        values:
        - iPhone
        - iPad
        - Android phone
        - Android tablet
        - Windows phone
        - MacBook
        - Windows laptop
        - Desktop computer
        - Smart TV
        - Gaming console
        - Smartwatch
        - E-reader
  - name: standard_subscription_duration
    description: Duration of standard subscription
    tests:
    - not_null
    - accepted_values:
        values:
        - 1 Day
        - 1 Week
        - 2 Weeks
        - 1 Month
        - 3 Months
        - 6 Months
        - 1 Year
        - 2 Years
        - 3 Years
        - 5 Years
  - name: proceeds_reason
    description: Reason for proceeds change
    tests:
    - not_null
  - name: country_code
    description: Country code of the user
    tests:
    - not_null
  - name: subscription_quantity
    description: Quantity of subscriptions
    tests:
    - not_null
  - name: app_name
    description: Name of the application
    tests:
    - not_null
  - name: account_number
    description: Unique identifier for the user account
    tests:
    - not_null
  - name: app_apple_id
    description: Apple ID of the application
    tests:
    - not_null
  - name: days_before_canceling
    description: Days between subscription start and cancellation
    cocoon_meta:
      missing_acceptable: Not applicable for renewals or non-canceled subscriptions
  - name: days_canceled
    description: Number of days the subscription was canceled
    cocoon_meta:
      missing_acceptable: Not applicable for active subscriptions or renewals
  - name: event_date
    description: Date of the subscription event
    tests:
    - not_null
  - name: original_start_date
    description: Initial date of subscription
    tests:
    - not_null
  - name: previous_subscription_name
    description: Name of previous subscription
    cocoon_meta:
      missing_acceptable: Not applicable for first-time subscribers
  - name: subscription_apple_id
    description: Apple ID of the subscription
    tests:
    - not_null
  - name: subscription_group_id
    description: Group ID for the subscription
    tests:
    - not_null
  - name: subscription_offer_duration
    description: Duration of subscription offer
    cocoon_meta:
      missing_acceptable: Not applicable if no special offer was applied
  - name: subscription_offer_type
    description: Type of subscription offer
    cocoon_meta:
      missing_acceptable: Not applicable if no special offer was applied
  - name: vendor_number
    description: Vendor identification number
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_sales_subscription_summary">
    <p class="text-center mb-0">stg_sales_subscription_summary <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>proceeds_currency</th>
      <th>customer_state</th>
      <th>grace_period_days</th>
      <th>subscription_name</th>
      <th>pay_as_you_go_promo_subs</th>
      <th>standard_sub_duration</th>
      <th>active_pay_as_you_go_intro_subs</th>
      <th>source_file</th>
      <th>customer_country</th>
      <th>pay_up_front_promo_subs</th>
      <th>active_pay_up_front_intro_subs</th>
      <th>free_trial_promo_subs</th>
      <th>developer_proceeds</th>
      <th>device_type</th>
      <th>marketing_opt_in_count</th>
      <th>proceeds_reason</th>
      <th>customer_price</th>
      <th>active_free_trial_intro_subs</th>
      <th>active_standard_subs</th>
      <th>customer_currency</th>
      <th>billing_retry_count</th>
      <th>row_index</th>
      <th>app_name</th>
      <th>account_number</th>
      <th>app_apple_id</th>
      <th>subscription_apple_id</th>
      <th>subscription_group_id</th>
      <th>vendor_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>EUR</td>
      <td>None</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>FR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>24.72</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>42.99</td>
      <td>0</td>
      <td>30</td>
      <td>EUR</td>
      <td>0</td>
      <td>9</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>1</th>
      <td>EUR</td>
      <td>None</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>FI</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>24.27</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>42.99</td>
      <td>0</td>
      <td>2</td>
      <td>EUR</td>
      <td>0</td>
      <td>25</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>MI</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>IT</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>24.20</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>42.99</td>
      <td>0</td>
      <td>1</td>
      <td>EUR</td>
      <td>0</td>
      <td>41</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USD</td>
      <td>MS</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Month</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>US</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.50</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>4.99</td>
      <td>0</td>
      <td>5</td>
      <td>USD</td>
      <td>0</td>
      <td>57</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>NJ</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Month</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>US</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.50</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>4.99</td>
      <td>0</td>
      <td>7</td>
      <td>USD</td>
      <td>2</td>
      <td>73</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>5</th>
      <td>KRW</td>
      <td>None</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>KR</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>31182.00</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>49000.00</td>
      <td>0</td>
      <td>1</td>
      <td>KRW</td>
      <td>0</td>
      <td>89</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>6</th>
      <td>None</td>
      <td>AZ</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Month</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>US</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.50</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>4.99</td>
      <td>0</td>
      <td>1</td>
      <td>USD</td>
      <td>0</td>
      <td>105</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>7</th>
      <td>None</td>
      <td>DC</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>US</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>33.99</td>
      <td>iPhone</td>
      <td>0</td>
      <td>Rate After One Year</td>
      <td>39.99</td>
      <td>0</td>
      <td>6</td>
      <td>USD</td>
      <td>0</td>
      <td>121</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>AZ</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Month</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>US</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.50</td>
      <td>iPhone</td>
      <td>0</td>
      <td>None</td>
      <td>4.99</td>
      <td>0</td>
      <td>6</td>
      <td>USD</td>
      <td>0</td>
      <td>137</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
    <tr>
      <th>9</th>
      <td>EUR</td>
      <td>None</td>
      <td>0</td>
      <td>Super Cool Name</td>
      <td>0</td>
      <td>1 Year</td>
      <td>0</td>
      <td>Subscription_12345678_20210712_V1_2.txt.gz</td>
      <td>IT</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>29.67</td>
      <td>iPhone</td>
      <td>0</td>
      <td>Rate After One Year</td>
      <td>42.99</td>
      <td>0</td>
      <td>1</td>
      <td>EUR</td>
      <td>0</td>
      <td>153</td>
      <td>Super Cool Name</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
      <td>12345</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_sales_subscription_summary.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"sales_subscription_summary_projected" AS (
    -- Projection: Selecting 30 out of 31 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "_filename",
        "account_number",
        "vendor_number",
        "_index",
        "developer_proceeds",
        "app_name",
        "free_trial_promotional_offer_subscriptions",
        "proceeds_currency",
        "subscription_name",
        "pay_as_you_go_promotional_offer_subscriptions",
        "customer_currency",
        "marketing_opt_ins",
        "pay_up_front_promotional_offer_subscriptions",
        "billing_retry",
        "proceeds_reason",
        "subscription_apple_id",
        "active_standard_price_subscriptions",
        "standard_subscription_duration",
        "grace_period",
        "device",
        "active_pay_up_front_introductory_offer_subscriptions",
        "customer_price",
        "promotional_offer_name",
        "state",
        "active_pay_as_you_go_introductory_offer_subscriptions",
        "subscription_group_id",
        "country",
        "active_free_trial_introductory_offer_subscriptions",
        "promotional_offer_id",
        "app_apple_id"
    FROM "sales_subscription_summary"
),

"sales_subscription_summary_projected_renamed" AS (
    -- Rename: Renaming columns
    -- _filename -> source_file
    -- _index -> row_index
    -- free_trial_promotional_offer_subscriptions -> free_trial_promo_subs
    -- pay_as_you_go_promotional_offer_subscriptions -> pay_as_you_go_promo_subs
    -- marketing_opt_ins -> marketing_opt_in_count
    -- pay_up_front_promotional_offer_subscriptions -> pay_up_front_promo_subs
    -- billing_retry -> billing_retry_count
    -- active_standard_price_subscriptions -> active_standard_subs
    -- standard_subscription_duration -> standard_sub_duration
    -- grace_period -> grace_period_days
    -- device -> device_type
    -- active_pay_up_front_introductory_offer_subscriptions -> active_pay_up_front_intro_subs
    -- promotional_offer_name -> promo_offer_name
    -- state -> customer_state
    -- active_pay_as_you_go_introductory_offer_subscriptions -> active_pay_as_you_go_intro_subs
    -- country -> customer_country
    -- active_free_trial_introductory_offer_subscriptions -> active_free_trial_intro_subs
    -- promotional_offer_id -> promo_offer_id
    SELECT 
        _filename AS source_file,
        account_number,
        vendor_number,
        _index AS row_index,
        developer_proceeds,
        app_name,
        free_trial_promotional_offer_subscriptions AS free_trial_promo_subs,
        proceeds_currency,
        subscription_name,
        pay_as_you_go_promotional_offer_subscriptions AS pay_as_you_go_promo_subs,
        customer_currency,
        marketing_opt_ins AS marketing_opt_in_count,
        pay_up_front_promotional_offer_subscriptions AS pay_up_front_promo_subs,
        billing_retry AS billing_retry_count,
        proceeds_reason,
        subscription_apple_id,
        active_standard_price_subscriptions AS active_standard_subs,
        standard_subscription_duration AS standard_sub_duration,
        grace_period AS grace_period_days,
        device AS device_type,
        active_pay_up_front_introductory_offer_subscriptions AS active_pay_up_front_intro_subs,
        customer_price,
        promotional_offer_name AS promo_offer_name,
        state AS customer_state,
        active_pay_as_you_go_introductory_offer_subscriptions AS active_pay_as_you_go_intro_subs,
        subscription_group_id,
        country AS customer_country,
        active_free_trial_introductory_offer_subscriptions AS active_free_trial_intro_subs,
        promotional_offer_id AS promo_offer_id,
        app_apple_id
    FROM sales_subscription_summary_projected
),

"sales_subscription_summary_projected_renamed_trimmed" AS (
    -- Trim Leading and Trailing Spaces
    SELECT
        "source_file",
        "account_number",
        "vendor_number",
        "row_index",
        "developer_proceeds",
        "app_name",
        "free_trial_promo_subs",
        "subscription_name",
        "pay_as_you_go_promo_subs",
        "customer_currency",
        "marketing_opt_in_count",
        "pay_up_front_promo_subs",
        "billing_retry_count",
        "proceeds_reason",
        "subscription_apple_id",
        "active_standard_subs",
        "standard_sub_duration",
        "grace_period_days",
        "device_type",
        "active_pay_up_front_intro_subs",
        "customer_price",
        "active_pay_as_you_go_intro_subs",
        "subscription_group_id",
        "customer_country",
        "active_free_trial_intro_subs",
        "app_apple_id",
        TRIM("proceeds_currency") AS "proceeds_currency",
        TRIM("promo_offer_name") AS "promo_offer_name",
        TRIM("customer_state") AS "customer_state",
        TRIM("promo_offer_id") AS "promo_offer_id"
    FROM "sales_subscription_summary_projected_renamed"
),

"sales_subscription_summary_projected_renamed_trimmed_cleaned" AS (
    -- Clean unusual string values: 
    -- customer_state: The problem is that some values in the customer_state column don't conform to standard US state abbreviations. The correct values should be two-letter US state codes, with the exception of 'DC' for District of Columbia. The empty string (''), 'AA', 'PO', and '부산' are unusual. 'AA' might be a typo for 'AZ' (Arizona), which is already present. 'PO' could be a typo for a state abbreviation but it's unclear which one. '부산' is a Korean city name and doesn't correspond to any US state. The empty string might indicate missing data. 
    -- promo_offer_id: The promo_offer_id column only contains empty strings, which do not identify any promotional offers. Since there are no other values to map to, we will leave the values as empty strings. 
    SELECT
        "source_file",
        "account_number",
        "vendor_number",
        "row_index",
        "developer_proceeds",
        "app_name",
        "free_trial_promo_subs",
        "subscription_name",
        "pay_as_you_go_promo_subs",
        "customer_currency",
        "marketing_opt_in_count",
        "pay_up_front_promo_subs",
        "billing_retry_count",
        "proceeds_reason",
        "subscription_apple_id",
        "active_standard_subs",
        "standard_sub_duration",
        "grace_period_days",
        "device_type",
        "active_pay_up_front_intro_subs",
        "customer_price",
        "active_pay_as_you_go_intro_subs",
        "subscription_group_id",
        "customer_country",
        "active_free_trial_intro_subs",
        "app_apple_id",
        "proceeds_currency",
        "promo_offer_name",
        CASE
            WHEN "customer_state" = 'AA' THEN 'AZ'
            WHEN "customer_state" = 'PO' THEN ''
            WHEN "customer_state" = '부산' THEN ''
            ELSE "customer_state"
        END AS "customer_state",
        "promo_offer_id"
    FROM "sales_subscription_summary_projected_renamed_trimmed"
),

"sales_subscription_summary_projected_renamed_trimmed_cleaned_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- proceeds_currency: ['']
    -- promo_offer_name: ['']
    -- customer_state: ['']
    -- promo_offer_id: ['']
    SELECT 
        CASE
            WHEN "proceeds_currency" = '' THEN NULL
            ELSE "proceeds_currency"
        END AS "proceeds_currency",
        CASE
            WHEN "promo_offer_name" = '' THEN NULL
            ELSE "promo_offer_name"
        END AS "promo_offer_name",
        CASE
            WHEN "customer_state" = '' THEN NULL
            ELSE "customer_state"
        END AS "customer_state",
        CASE
            WHEN "promo_offer_id" = '' THEN NULL
            ELSE "promo_offer_id"
        END AS "promo_offer_id",
        "grace_period_days",
        "subscription_name",
        "pay_as_you_go_promo_subs",
        "app_apple_id",
        "standard_sub_duration",
        "active_pay_as_you_go_intro_subs",
        "subscription_apple_id",
        "subscription_group_id",
        "source_file",
        "customer_country",
        "pay_up_front_promo_subs",
        "active_pay_up_front_intro_subs",
        "free_trial_promo_subs",
        "account_number",
        "developer_proceeds",
        "device_type",
        "marketing_opt_in_count",
        "proceeds_reason",
        "customer_price",
        "active_free_trial_intro_subs",
        "vendor_number",
        "active_standard_subs",
        "customer_currency",
        "billing_retry_count",
        "row_index",
        "app_name"
    FROM "sales_subscription_summary_projected_renamed_trimmed_cleaned"
),

"sales_subscription_summary_projected_renamed_trimmed_cleaned_null_casted" AS (
    -- Column Type Casting: 
    -- account_number: from INT to VARCHAR
    -- app_apple_id: from INT to VARCHAR
    -- subscription_apple_id: from INT to VARCHAR
    -- subscription_group_id: from INT to VARCHAR
    -- vendor_number: from INT to VARCHAR
    SELECT
        "proceeds_currency",
        "promo_offer_name",
        "customer_state",
        "promo_offer_id",
        "grace_period_days",
        "subscription_name",
        "pay_as_you_go_promo_subs",
        "standard_sub_duration",
        "active_pay_as_you_go_intro_subs",
        "source_file",
        "customer_country",
        "pay_up_front_promo_subs",
        "active_pay_up_front_intro_subs",
        "free_trial_promo_subs",
        "developer_proceeds",
        "device_type",
        "marketing_opt_in_count",
        "proceeds_reason",
        "customer_price",
        "active_free_trial_intro_subs",
        "active_standard_subs",
        "customer_currency",
        "billing_retry_count",
        "row_index",
        "app_name",
        CAST("account_number" AS VARCHAR) AS "account_number",
        CAST("app_apple_id" AS VARCHAR) AS "app_apple_id",
        CAST("subscription_apple_id" AS VARCHAR) AS "subscription_apple_id",
        CAST("subscription_group_id" AS VARCHAR) AS "subscription_group_id",
        CAST("vendor_number" AS VARCHAR) AS "vendor_number"
    FROM "sales_subscription_summary_projected_renamed_trimmed_cleaned_null"
),

"sales_subscription_summary_projected_renamed_trimmed_cleaned_null_casted_missing_handled" AS (
    -- Handling missing values: There are 4 columns with unacceptable missing values
    -- proceeds_currency has 50.0 percent missing. Strategy: 🔄 Unchanged
    -- proceeds_reason has 80.0 percent missing. Strategy: 🔄 Unchanged
    -- promo_offer_id has 100.0 percent missing. Strategy: 🗑️ Drop Column
    -- promo_offer_name has 100.0 percent missing. Strategy: 🗑️ Drop Column
    SELECT
        "proceeds_currency",
        "customer_state",
        "grace_period_days",
        "subscription_name",
        "pay_as_you_go_promo_subs",
        "standard_sub_duration",
        "active_pay_as_you_go_intro_subs",
        "source_file",
        "customer_country",
        "pay_up_front_promo_subs",
        "active_pay_up_front_intro_subs",
        "free_trial_promo_subs",
        "developer_proceeds",
        "device_type",
        "marketing_opt_in_count",
        "proceeds_reason",
        "customer_price",
        "active_free_trial_intro_subs",
        "active_standard_subs",
        "customer_currency",
        "billing_retry_count",
        "row_index",
        "app_name",
        "account_number",
        "app_apple_id",
        "subscription_apple_id",
        "subscription_group_id",
        "vendor_number"
    FROM "sales_subscription_summary_projected_renamed_trimmed_cleaned_null_casted"
)

-- COCOON BLOCK END
SELECT * FROM "sales_subscription_summary_projected_renamed_trimmed_cleaned_null_casted_missing_handled"</code></pre>
    </div>
    <p class="text-center">stg_sales_subscription_summary.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_sales_subscription_summary
  description: The table is about app subscription sales. It contains details such
    as account number, vendor number, app name, subscription name, and customer information.
    Each row represents a subscription sale, including financial data like developer
    proceeds and customer price. It also tracks subscription types, durations, and
    promotional offers. The table includes geographic information and device types
    used for subscriptions.
  columns:
  - name: proceeds_currency
    description: Currency of the proceeds
    tests:
    - not_null
  - name: customer_state
    description: State or province of the customer
    tests:
    - accepted_values:
        values:
        - AL
        - AK
        - AZ
        - AR
        - CA
        - CO
        - CT
        - DE
        - FL
        - GA
        - HI
        - ID
        - IL
        - IN
        - IA
        - KS
        - KY
        - LA
        - ME
        - MD
        - MA
        - MI
        - MN
        - MS
        - MO
        - MT
        - NE
        - NV
        - NH
        - NJ
        - NM
        - NY
        - NC
        - ND
        - OH
        - OK
        - OR
        - PA
        - RI
        - SC
        - SD
        - TN
        - TX
        - UT
        - VT
        - VA
        - WA
        - WV
        - WI
        - WY
        - DC
        - AS
        - GU
        - MP
        - PR
        - VI
        - AB
        - BC
        - MB
        - NB
        - NL
        - NS
        - NT
        - NU
        - 'ON'
        - PE
        - QC
        - SK
        - YT
    cocoon_meta:
      missing_acceptable: Not applicable for non-US customers or countries without
        states.
  - name: grace_period_days
    description: Number of grace period days
    tests:
    - not_null
  - name: subscription_name
    description: Name of the subscription
    tests:
    - not_null
  - name: pay_as_you_go_promo_subs
    description: Count of pay-as-you-go promo offer subscriptions
    tests:
    - not_null
  - name: standard_sub_duration
    description: Duration of the standard subscription
    tests:
    - not_null
    - accepted_values:
        values:
        - 1 Week
        - 2 Weeks
        - 1 Month
        - 3 Months
        - 6 Months
        - 1 Year
        - 2 Years
        - 3 Years
        - 5 Years
  - name: active_pay_as_you_go_intro_subs
    description: Count of active pay-as-you-go intro offer subscriptions
    tests:
    - not_null
  - name: source_file
    description: Name of the source file
    tests:
    - not_null
  - name: customer_country
    description: Country code of the customer
    tests:
    - not_null
  - name: pay_up_front_promo_subs
    description: Count of pay-up-front promo offer subscriptions
    tests:
    - not_null
  - name: active_pay_up_front_intro_subs
    description: Count of active pay-up-front intro offer subscriptions
    tests:
    - not_null
  - name: free_trial_promo_subs
    description: Count of free trial promo offer subscriptions
    tests:
    - not_null
  - name: developer_proceeds
    description: Amount received by the developer
    tests:
    - not_null
  - name: device_type
    description: Type of device used
    tests:
    - not_null
    - accepted_values:
        values:
        - iPhone
        - Android phone
        - iPad
        - Android tablet
        - Windows PC
        - Mac
        - Linux PC
        - Smart TV
        - Gaming console
        - Smartwatch
        - E-reader
        - Smart speaker
        - Other
  - name: marketing_opt_in_count
    description: Number of marketing opt-ins
    tests:
    - not_null
  - name: proceeds_reason
    description: Reason for the proceeds
    tests:
    - not_null
  - name: customer_price
    description: Price paid by the customer
    tests:
    - not_null
  - name: active_free_trial_intro_subs
    description: Count of active free trial intro offer subscriptions
    tests:
    - not_null
  - name: active_standard_subs
    description: Count of active standard price subscriptions
    tests:
    - not_null
  - name: customer_currency
    description: Currency used by the customer
    tests:
    - not_null
  - name: billing_retry_count
    description: Number of billing retry attempts
    tests:
    - not_null
  - name: row_index
    description: Row index in the source file
    tests:
    - not_null
    - unique
    cocoon_meta:
      uniqueness: This column represents the row index in the source file. For this
        table, each row is a unique subscription sale. The row_index appears to be
        unique across rows in the given sample.
  - name: app_name
    description: Name of the app
    tests:
    - not_null
  - name: account_number
    description: Unique identifier for the account
    tests:
    - not_null
  - name: app_apple_id
    description: Apple ID of the app
    tests:
    - not_null
  - name: subscription_apple_id
    description: Apple ID of the subscription
    tests:
    - not_null
  - name: subscription_group_id
    description: ID of the subscription group
    tests:
    - not_null
  - name: vendor_number
    description: Unique identifier for the vendor
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_app_store_source_type_device">
    <p class="text-center mb-0">stg_app_store_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>discovery_source</th>
      <th>unique_impressions</th>
      <th>device_type</th>
      <th>unique_page_views</th>
      <th>total_page_views</th>
      <th>total_impressions</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>metric_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>0</td>
      <td>iPhone</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>App Store Browse</td>
      <td>5</td>
      <td>iPad</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>App Store Search</td>
      <td>732</td>
      <td>iPhone</td>
      <td>103</td>
      <td>146</td>
      <td>1210</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Store Search</td>
      <td>1113</td>
      <td>iPhone</td>
      <td>151</td>
      <td>209</td>
      <td>1757</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-03-17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>0</td>
      <td>Desktop</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-02-24</td>
    </tr>
    <tr>
      <th>5</th>
      <td>None</td>
      <td>0</td>
      <td>iPad</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-06</td>
    </tr>
    <tr>
      <th>6</th>
      <td>None</td>
      <td>0</td>
      <td>iPad</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-11-15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>None</td>
      <td>0</td>
      <td>iPad</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-24</td>
    </tr>
    <tr>
      <th>8</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>Desktop</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-03-17</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Institutional Purchase</td>
      <td>0</td>
      <td>Desktop</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-12</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_app_store_source_type_device.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"app_store_source_type_device_projected" AS (
    -- Projection: Selecting 9 out of 10 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "device",
        "source_type",
        "meets_threshold",
        "impressions",
        "impressions_unique_device",
        "page_views",
        "page_views_unique_device"
    FROM "app_store_source_type_device"
),

"app_store_source_type_device_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> metric_date
    -- device -> device_type
    -- source_type -> discovery_source
    -- impressions -> total_impressions
    -- impressions_unique_device -> unique_impressions
    -- page_views -> total_page_views
    -- page_views_unique_device -> unique_page_views
    SELECT 
        app_id,
        date_ AS metric_date,
        device AS device_type,
        source_type AS discovery_source,
        meets_threshold,
        impressions AS total_impressions,
        impressions_unique_device AS unique_impressions,
        page_views AS total_page_views,
        page_views_unique_device AS unique_page_views
    FROM app_store_source_type_device_projected
),

"app_store_source_type_device_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- discovery_source: ['Unavailable']
    SELECT 
        CASE
            WHEN "discovery_source" = 'Unavailable' THEN NULL
            ELSE "discovery_source"
        END AS "discovery_source",
        "metric_date",
        "unique_impressions",
        "app_id",
        "device_type",
        "unique_page_views",
        "total_page_views",
        "total_impressions",
        "meets_threshold"
    FROM "app_store_source_type_device_projected_renamed"
),

"app_store_source_type_device_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- metric_date: from VARCHAR to TIMESTAMP
    SELECT
        "discovery_source",
        "unique_impressions",
        "device_type",
        "unique_page_views",
        "total_page_views",
        "total_impressions",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("metric_date" AS TIMESTAMP) AS "metric_date"
    FROM "app_store_source_type_device_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "app_store_source_type_device_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_app_store_source_type_device.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_app_store_source_type_device
  description: The table is about app store performance metrics. It includes details
    like app ID, date, device type, source type, impressions, page views, and unique
    device counts. Each row represents performance data for a specific app on a particular
    date, device, and source type. The data tracks how users discover and interact
    with the app across different platforms and channels.
  columns:
  - name: discovery_source
    description: Channel through which the app was discovered
    tests:
    - accepted_values:
        values:
        - App Store Search
        - App Store Browse
        - Institutional Purchase
        - Word of Mouth
        - Social Media
        - App Store Ads
        - Web Search
        - Website Referral
        - Email Marketing
        - In-App Referral
        - App Store Featured
        - App Store Category
        - Television Ad
        - Print Ad
        - Radio Ad
        - Influencer Promotion
        - App Review Sites
        - App Recommendation
        - Pre-installed
        - Partner Promotion
    cocoon_meta:
      missing_acceptable: Not applicable for direct app access or unknown sources.
  - name: unique_impressions
    description: Number of unique devices that viewed the app
    tests:
    - not_null
  - name: device_type
    description: Type of device used (iPhone, iPad, Desktop)
    tests:
    - not_null
    - accepted_values:
        values:
        - iPhone
        - iPad
        - Desktop
        - Android Phone
        - Android Tablet
        - MacBook
        - Windows Laptop
        - Chromebook
        - Smart TV
        - Gaming Console
        - Smartwatch
        - E-reader
  - name: unique_page_views
    description: Number of unique devices that viewed the app page
    tests:
    - not_null
  - name: total_page_views
    description: Total number of app page views
    tests:
    - not_null
  - name: total_impressions
    description: Total number of times the app was viewed
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if the data meets a certain threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: metric_date
    description: Date of the recorded metrics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_downloads_territory_source_type">
    <p class="text-center mb-0">stg_downloads_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acquisition_channel</th>
      <th>new_downloads</th>
      <th>country</th>
      <th>redownloads</th>
      <th>total_downloads</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>stat_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Web Referrer</td>
      <td>1</td>
      <td>Canada</td>
      <td>0</td>
      <td>1</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Store Search</td>
      <td>1</td>
      <td>Canada</td>
      <td>0</td>
      <td>1</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2022-01-10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-11-27</td>
    </tr>
    <tr>
      <th>7</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-15</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-07</td>
    </tr>
    <tr>
      <th>9</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>Canada</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-05</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_downloads_territory_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"downloads_territory_source_type_projected" AS (
    -- Projection: Selecting 8 out of 9 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "source_type",
        "territory",
        "meets_threshold",
        "first_time_downloads",
        "redownloads",
        "total_downloads"
    FROM "downloads_territory_source_type"
),

"downloads_territory_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> stat_date
    -- source_type -> acquisition_channel
    -- territory -> country
    -- first_time_downloads -> new_downloads
    SELECT 
        app_id,
        date_ AS stat_date,
        source_type AS acquisition_channel,
        territory AS country,
        meets_threshold,
        first_time_downloads AS new_downloads,
        redownloads,
        total_downloads
    FROM downloads_territory_source_type_projected
),

"downloads_territory_source_type_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- acquisition_channel: ['Unavailable']
    SELECT 
        CASE
            WHEN "acquisition_channel" = 'Unavailable' THEN NULL
            ELSE "acquisition_channel"
        END AS "acquisition_channel",
        "stat_date",
        "new_downloads",
        "country",
        "redownloads",
        "app_id",
        "total_downloads",
        "meets_threshold"
    FROM "downloads_territory_source_type_projected_renamed"
),

"downloads_territory_source_type_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- stat_date: from VARCHAR to TIMESTAMP
    SELECT
        "acquisition_channel",
        "new_downloads",
        "country",
        "redownloads",
        "total_downloads",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("stat_date" AS TIMESTAMP) AS "stat_date"
    FROM "downloads_territory_source_type_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "downloads_territory_source_type_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_downloads_territory_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_downloads_territory_source_type
  description: The table is about app downloads. It tracks download statistics for
    an app across different territories and source types. Details include the app
    ID, date, source type, territory, download counts (first-time, redownloads, total),
    and whether the data meets a threshold. The table allows analysis of app performance
    by location and acquisition channel over time.
  columns:
  - name: acquisition_channel
    description: Channel or method through which app was downloaded
    tests:
    - not_null
    - accepted_values:
        values:
        - App Store Search
        - Web Referrer
        - App Referrer
        - Google Play Store Search
        - Apple App Store Browse
        - Google Play Store Browse
        - Social Media Ad
        - Search Engine Ad
        - Display Ad
        - Email Campaign
        - SMS Campaign
        - Push Notification
        - Influencer Marketing
        - Word of Mouth
        - QR Code
        - TV Ad
        - Print Ad
        - Radio Ad
        - In-App Promotion
        - App Store Optimization (ASO)
        - Pre-installed
        - App Bundle
  - name: new_downloads
    description: Number of first-time downloads
    tests:
    - not_null
  - name: country
    description: Geographical location of the downloads
    tests:
    - not_null
  - name: redownloads
    description: Number of times the app was redownloaded
    tests:
    - not_null
  - name: total_downloads
    description: Total number of downloads including redownloads
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if data meets a certain threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: stat_date
    description: Date of the download statistics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_sales_account">
    <p class="text-center mb-0">stg_sales_account <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>account_name</th>
      <th>account_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Super Cool Name</td>
      <td>12345</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_sales_account.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"sales_account_projected" AS (
    -- Projection: Selecting 2 out of 3 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "id",
        "name"
    FROM "sales_account"
),

"sales_account_projected_renamed" AS (
    -- Rename: Renaming columns
    -- id -> account_id
    -- name -> account_name
    SELECT 
        id AS account_id,
        name AS account_name
    FROM sales_account_projected
),

"sales_account_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- account_id: from INT to VARCHAR
    SELECT
        "account_name",
        CAST("account_id" AS VARCHAR) AS "account_id"
    FROM "sales_account_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "sales_account_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_sales_account.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_sales_account
  description: The table is about sales accounts. It contains details of individual
    accounts, including a unique identifier (id) and the account name. Each row likely
    represents a separate sales account in a system or database.
  columns:
  - name: account_name
    description: Name of the sales account
    tests:
    - not_null
  - name: account_id
    description: Unique identifier for the sales account
    tests:
    - not_null
    - unique
    cocoon_meta:
      uniqueness: This column is described as a unique identifier for the sales account.
        For this table, each row represents a distinct sales account. By definition,
        a unique identifier should be unique across all rows, making it a suitable
        candidate key.
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_usage_territory_source_type">
    <p class="text-center mb-0">stg_usage_territory_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acquisition_source</th>
      <th>daily_deletions</th>
      <th>daily_sessions</th>
      <th>daily_active_devices</th>
      <th>monthly_active_devices</th>
      <th>daily_installations</th>
      <th>territory</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>metric_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>App Store Search</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>44</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-05-21</td>
    </tr>
    <tr>
      <th>1</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-12-28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>None</td>
      <td>2</td>
      <td>10</td>
      <td>5</td>
      <td>42</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-02</td>
    </tr>
    <tr>
      <th>5</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-03-16</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-30</td>
    </tr>
    <tr>
      <th>7</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-11-23</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-02-13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Canada</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-09</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_usage_territory_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"usage_territory_source_type_projected" AS (
    -- Projection: Selecting 10 out of 11 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "source_type",
        "territory",
        "meets_threshold",
        "installations",
        "sessions",
        "active_devices",
        "active_devices_last_30_days",
        "deletions"
    FROM "usage_territory_source_type"
),

"usage_territory_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> metric_date
    -- source_type -> acquisition_source
    -- installations -> daily_installations
    -- sessions -> daily_sessions
    -- active_devices -> daily_active_devices
    -- active_devices_last_30_days -> monthly_active_devices
    -- deletions -> daily_deletions
    SELECT 
        app_id,
        date_ AS metric_date,
        source_type AS acquisition_source,
        territory,
        meets_threshold,
        installations AS daily_installations,
        sessions AS daily_sessions,
        active_devices AS daily_active_devices,
        active_devices_last_30_days AS monthly_active_devices,
        deletions AS daily_deletions
    FROM usage_territory_source_type_projected
),

"usage_territory_source_type_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- acquisition_source: ['Unavailable']
    SELECT 
        CASE
            WHEN "acquisition_source" = 'Unavailable' THEN NULL
            ELSE "acquisition_source"
        END AS "acquisition_source",
        "daily_deletions",
        "daily_sessions",
        "daily_active_devices",
        "metric_date",
        "monthly_active_devices",
        "app_id",
        "daily_installations",
        "territory",
        "meets_threshold"
    FROM "usage_territory_source_type_projected_renamed"
),

"usage_territory_source_type_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- metric_date: from VARCHAR to TIMESTAMP
    SELECT
        "acquisition_source",
        "daily_deletions",
        "daily_sessions",
        "daily_active_devices",
        "monthly_active_devices",
        "daily_installations",
        "territory",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("metric_date" AS TIMESTAMP) AS "metric_date"
    FROM "usage_territory_source_type_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "usage_territory_source_type_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_usage_territory_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_usage_territory_source_type
  description: The table is about app usage metrics. It contains data for a specific
    app across different dates, territories, and source types. Key metrics include
    installations, sessions, active devices, and deletions. The data is segmented
    by date, territory, and source type, allowing for analysis of app performance
    across these dimensions.
  columns:
  - name: acquisition_source
    description: Origin of the app installation or interaction
    tests:
    - accepted_values:
        values:
        - App Store Search
        - Web Referrer
        - App Store Browse
        - Direct Link
        - Social Media
        - App Store Ads
        - In-App Referral
        - Email Campaign
        - Push Notification
        - QR Code
        - App Store Featured
        - Google Play Store Search
        - Google Play Store Browse
        - Google Play Store Ads
        - Third-party App Store
        - Pre-installed
        - Word of Mouth
        - TV Advertisement
        - Print Advertisement
        - Influencer Promotion
    cocoon_meta:
      missing_acceptable: Not applicable when user didn't come from a specific source.
  - name: daily_deletions
    description: Number of app deletions on the specific date
    tests:
    - not_null
  - name: daily_sessions
    description: Number of app sessions on the specific date
    tests:
    - not_null
  - name: daily_active_devices
    description: Number of devices using the app on the specific date
    tests:
    - not_null
  - name: monthly_active_devices
    description: Number of devices using the app in the last 30 days
    tests:
    - not_null
  - name: daily_installations
    description: Number of app installations on the specific date
    tests:
    - not_null
  - name: territory
    description: Geographical region where the app is used
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if data meets a certain threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: metric_date
    description: Date of the recorded metrics
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_app_store_platform_version_source_type">
    <p class="text-center mb-0">stg_app_store_platform_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>traffic_source</th>
      <th>unique_device_impressions</th>
      <th>unique_device_page_views</th>
      <th>ios_version</th>
      <th>total_page_views</th>
      <th>total_impressions</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>performance_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Referrer</td>
      <td>28</td>
      <td>28</td>
      <td>iOS 1.0</td>
      <td>30</td>
      <td>30</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-04</td>
    </tr>
    <tr>
      <th>5</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-12-04</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Web Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-01-31</td>
    </tr>
    <tr>
      <th>9</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>iOS 1.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-12-25</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_app_store_platform_version_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"app_store_platform_version_source_type_projected" AS (
    -- Projection: Selecting 9 out of 10 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "platform_version",
        "source_type",
        "meets_threshold",
        "impressions",
        "impressions_unique_device",
        "page_views",
        "page_views_unique_device"
    FROM "app_store_platform_version_source_type"
),

"app_store_platform_version_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> performance_date
    -- platform_version -> ios_version
    -- source_type -> traffic_source
    -- impressions -> total_impressions
    -- impressions_unique_device -> unique_device_impressions
    -- page_views -> total_page_views
    -- page_views_unique_device -> unique_device_page_views
    SELECT 
        app_id,
        date_ AS performance_date,
        platform_version AS ios_version,
        source_type AS traffic_source,
        meets_threshold,
        impressions AS total_impressions,
        impressions_unique_device AS unique_device_impressions,
        page_views AS total_page_views,
        page_views_unique_device AS unique_device_page_views
    FROM app_store_platform_version_source_type_projected
),

"app_store_platform_version_source_type_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- traffic_source: ['Unavailable']
    SELECT 
        CASE
            WHEN "traffic_source" = 'Unavailable' THEN NULL
            ELSE "traffic_source"
        END AS "traffic_source",
        "unique_device_impressions",
        "performance_date",
        "app_id",
        "unique_device_page_views",
        "ios_version",
        "total_page_views",
        "total_impressions",
        "meets_threshold"
    FROM "app_store_platform_version_source_type_projected_renamed"
),

"app_store_platform_version_source_type_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- performance_date: from VARCHAR to TIMESTAMP
    SELECT
        "traffic_source",
        "unique_device_impressions",
        "unique_device_page_views",
        "ios_version",
        "total_page_views",
        "total_impressions",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("performance_date" AS TIMESTAMP) AS "performance_date"
    FROM "app_store_platform_version_source_type_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "app_store_platform_version_source_type_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_app_store_platform_version_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_app_store_platform_version_source_type
  description: The table is about app performance data on the App Store. It includes
    details such as app ID, date, iOS version, traffic source, impression and page
    view metrics. Each row represents a daily snapshot of an app's performance for
    a specific platform version and source type. The data tracks both total and unique
    device metrics for impressions and page views.
  columns:
  - name: traffic_source
    description: Source of app traffic or discovery
    tests:
    - accepted_values:
        values:
        - App Store Browse
        - App Store Search
        - Web Referrer
        - App Referrer
        - Social Media
        - Paid Advertising
        - Word of Mouth
        - Email Campaign
        - Push Notification
        - In-App Promotion
        - App Store Featuring
        - Press/Media Coverage
        - Organic Search
        - Direct Traffic
    cocoon_meta:
      missing_acceptable: No traffic source when impressions and page views are zero.
  - name: unique_device_impressions
    description: Number of unique devices with impressions
    tests:
    - not_null
  - name: unique_device_page_views
    description: Number of unique devices with page views
    tests:
    - not_null
  - name: ios_version
    description: iOS version of the app
    tests:
    - not_null
  - name: total_page_views
    description: Total number of page views for the app
    tests:
    - not_null
  - name: total_impressions
    description: Total number of impressions for the app
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if data meets reporting threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: performance_date
    description: Date of the performance data
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_crashes_platform_version">
    <p class="text-center mb-0">stg_crashes_platform_version <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device_type</th>
      <th>os_version</th>
      <th>meets_threshold</th>
      <th>crash_count</th>
      <th>app_id</th>
      <th>timestamp_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>iPod</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iPod</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-07-25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-09-11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>iPhone</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-01-03</td>
    </tr>
    <tr>
      <th>9</th>
      <td>iPad</td>
      <td>iOS 1.0</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-28</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_crashes_platform_version.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"crashes_platform_version_projected" AS (
    -- Projection: Selecting 6 out of 7 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "device",
        "platform_version",
        "meets_threshold",
        "crashes"
    FROM "crashes_platform_version"
),

"crashes_platform_version_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> timestamp_
    -- device -> device_type
    -- platform_version -> os_version
    -- crashes -> crash_count
    SELECT 
        app_id,
        date_ AS timestamp_,
        device AS device_type,
        platform_version AS os_version,
        meets_threshold,
        crashes AS crash_count
    FROM crashes_platform_version_projected
),

"crashes_platform_version_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- timestamp_: from VARCHAR to TIMESTAMP
    SELECT
        "device_type",
        "os_version",
        "meets_threshold",
        "crash_count",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("timestamp_" AS TIMESTAMP) AS "timestamp_"
    FROM "crashes_platform_version_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "crashes_platform_version_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_crashes_platform_version.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_crashes_platform_version
  description: The table is about app crashes on different devices. It includes details
    such as app ID, date, device type, platform version, whether it meets a threshold,
    and crash count. Each row represents a specific instance of crash data for an
    app on a particular device and platform version on a given date.
  columns:
  - name: device_type
    description: Type of device (iPad, iPod, iPhone)
    tests:
    - not_null
    - accepted_values:
        values:
        - iPad
        - iPhone
        - iPod
  - name: os_version
    description: Version of the operating system
    tests:
    - not_null
  - name: meets_threshold
    description: Boolean indicating if crash count meets threshold
    tests:
    - not_null
  - name: crash_count
    description: Number of crashes for the app
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: timestamp_
    description: Date and time of the recorded data
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_usage_app_version_source_type">
    <p class="text-center mb-0">stg_usage_app_version_source_type <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_type</th>
      <th>daily_deletions</th>
      <th>daily_sessions</th>
      <th>daily_active_devices</th>
      <th>monthly_active_devices</th>
      <th>daily_installations</th>
      <th>app_version</th>
      <th>meets_threshold</th>
      <th>app_id</th>
      <th>record_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-03-20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-08-08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-09-25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>App Store Browse</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-03-26</td>
    </tr>
    <tr>
      <th>4</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2020-11-03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>App Referrer</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-05</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Institutional Purchase</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-04-01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>App Store Search</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-07-10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-06-08</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Institutional Purchase</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.0.0 (iOS)</td>
      <td>True</td>
      <td>12345</td>
      <td>2021-10-20</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_usage_app_version_source_type.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"usage_app_version_source_type_projected" AS (
    -- Projection: Selecting 10 out of 11 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "app_version",
        "date_",
        "source_type",
        "meets_threshold",
        "installations",
        "sessions",
        "active_devices",
        "active_devices_last_30_days",
        "deletions"
    FROM "usage_app_version_source_type"
),

"usage_app_version_source_type_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> record_date
    -- installations -> daily_installations
    -- sessions -> daily_sessions
    -- active_devices -> daily_active_devices
    -- active_devices_last_30_days -> monthly_active_devices
    -- deletions -> daily_deletions
    SELECT 
        app_id,
        app_version,
        date_ AS record_date,
        source_type,
        meets_threshold,
        installations AS daily_installations,
        sessions AS daily_sessions,
        active_devices AS daily_active_devices,
        active_devices_last_30_days AS monthly_active_devices,
        deletions AS daily_deletions
    FROM usage_app_version_source_type_projected
),

"usage_app_version_source_type_projected_renamed_null" AS (
    -- NULL Imputation: Impute Null to Disguised Missing Values
    -- source_type: ['Unavailable']
    SELECT 
        CASE
            WHEN "source_type" = 'Unavailable' THEN NULL
            ELSE "source_type"
        END AS "source_type",
        "daily_deletions",
        "daily_sessions",
        "daily_active_devices",
        "record_date",
        "monthly_active_devices",
        "app_id",
        "daily_installations",
        "app_version",
        "meets_threshold"
    FROM "usage_app_version_source_type_projected_renamed"
),

"usage_app_version_source_type_projected_renamed_null_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- record_date: from VARCHAR to TIMESTAMP
    SELECT
        "source_type",
        "daily_deletions",
        "daily_sessions",
        "daily_active_devices",
        "monthly_active_devices",
        "daily_installations",
        "app_version",
        "meets_threshold",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("record_date" AS TIMESTAMP) AS "record_date"
    FROM "usage_app_version_source_type_projected_renamed_null"
)

-- COCOON BLOCK END
SELECT * FROM "usage_app_version_source_type_projected_renamed_null_casted"</code></pre>
    </div>
    <p class="text-center">stg_usage_app_version_source_type.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_usage_app_version_source_type
  description: The table is about app usage data. It contains details of an app's
    performance metrics across different versions, dates, and source types. The data
    includes installations, sessions, active devices, and deletions. Each row represents
    a specific combination of app version, date, and source type, providing a comprehensive
    view of the app's usage patterns and user engagement over time.
  columns:
  - name: source_type
    description: Source of app discovery or installation
    tests:
    - accepted_values:
        values:
        - App Store Browse
        - App Store Search
        - Institutional Purchase
        - App Referrer
        - Website
        - Social Media
        - Advertisement
        - Word of Mouth
        - Pre-installed
        - App Store Featured
        - Third-party App Store
        - QR Code
        - Email Campaign
        - Push Notification
    cocoon_meta:
      missing_acceptable: No specific source for app discovery or installation.
  - name: daily_deletions
    description: Number of app deletions on the given date
    tests:
    - not_null
  - name: daily_sessions
    description: Number of app sessions on the given date
    tests:
    - not_null
  - name: daily_active_devices
    description: Number of active devices on the given date
    tests:
    - not_null
  - name: monthly_active_devices
    description: Number of active devices in the past 30 days
    tests:
    - not_null
  - name: daily_installations
    description: Number of app installations on the given date
    tests:
    - not_null
  - name: app_version
    description: Version of the app and platform
    tests:
    - not_null
  - name: meets_threshold
    description: Indicates if data meets reporting threshold
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: record_date
    description: Date of the recorded data
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_app">
    <p class="text-center mb-0">stg_app <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_enabled</th>
      <th>app_name</th>
      <th>asset_token</th>
      <th>icon_url</th>
      <th>user_opt_in_percentage</th>
      <th>is_ios_compatible</th>
      <th>is_tvos_compatible</th>
      <th>is_bundle</th>
      <th>app_id</th>
      <th>pre_order_details</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>Super Cool Name</td>
      <td>Random Asset Token</td>
      <td>Random Icon URL</td>
      <td>10</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>12345</td>
      <td>None</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_app.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"app_projected" AS (
    -- Projection: Selecting 10 out of 11 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "id",
        "is_enabled",
        "name",
        "asset_token",
        "pre_order_info",
        "icon_url",
        "app_opt_in_rate",
        "ios",
        "tvos",
        "is_bundle"
    FROM "app"
),

"app_projected_renamed" AS (
    -- Rename: Renaming columns
    -- id -> app_id
    -- name -> app_name
    -- pre_order_info -> pre_order_details
    -- app_opt_in_rate -> user_opt_in_percentage
    -- ios -> is_ios_compatible
    -- tvos -> is_tvos_compatible
    SELECT 
        id AS app_id,
        is_enabled,
        name AS app_name,
        asset_token,
        pre_order_info AS pre_order_details,
        icon_url,
        app_opt_in_rate AS user_opt_in_percentage,
        ios AS is_ios_compatible,
        tvos AS is_tvos_compatible,
        is_bundle
    FROM app_projected
),

"app_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- pre_order_details: from DECIMAL to VARCHAR
    SELECT
        "is_enabled",
        "app_name",
        "asset_token",
        "icon_url",
        "user_opt_in_percentage",
        "is_ios_compatible",
        "is_tvos_compatible",
        "is_bundle",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("pre_order_details" AS VARCHAR) AS "pre_order_details"
    FROM "app_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "app_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_app.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_app
  description: The table is about mobile applications. It contains details like the
    app's ID, name, whether it's enabled, asset token, icon URL, opt-in rate, platform
    availability (iOS, tvOS), and if it's a bundle. The table also includes a pre-order
    info field and tracks the app's opt-in rate. This data likely represents an app
    store or app management system's database.
  columns:
  - name: is_enabled
    description: Indicates if the app is currently active
    tests:
    - not_null
  - name: app_name
    description: The name of the application
    tests:
    - not_null
  - name: asset_token
    description: Unique identifier for app's digital assets
    tests:
    - not_null
    - unique
    cocoon_meta:
      uniqueness: This column is a unique identifier for app's digital assets. It's
        likely to be unique for each app, as digital assets are typically managed
        individually.
  - name: icon_url
    description: URL link to the app's icon image
    tests:
    - not_null
  - name: user_opt_in_percentage
    description: Percentage of users who opted in to the app
    tests:
    - not_null
  - name: is_ios_compatible
    description: Indicates if the app is available on iOS
    tests:
    - not_null
  - name: is_tvos_compatible
    description: Indicates if the app is available on tvOS
    tests:
    - not_null
  - name: is_bundle
    description: Indicates if the app is part of a bundle
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
    - unique
    cocoon_meta:
      uniqueness: This column is described as a unique identifier for the app. In
        app management systems, app_id is typically designed to be a unique identifier
        for each application.
  - name: pre_order_details
    description: Information about app pre-order availability
    cocoon_meta:
      missing_acceptable: Not applicable for apps not available for pre-order.
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_usage_source_type_device">
    <p class="text-center mb-0">stg_usage_source_type_device <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device_type</th>
      <th>acquisition_channel</th>
      <th>meets_threshold</th>
      <th>new_installations</th>
      <th>daily_sessions</th>
      <th>daily_active_devices</th>
      <th>monthly_active_devices</th>
      <th>app_deletions</th>
      <th>app_id</th>
      <th>record_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>6</td>
      <td>58</td>
      <td>34</td>
      <td>406</td>
      <td>3</td>
      <td>12345</td>
      <td>2020-11-27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Desktop</td>
      <td>App Store Search</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-01-04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>iPad</td>
      <td>App Referrer</td>
      <td>True</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
      <td>60</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iPod</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-09-10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>iPad</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>1</td>
      <td>10</td>
      <td>3</td>
      <td>55</td>
      <td>1</td>
      <td>12345</td>
      <td>2021-02-19</td>
    </tr>
    <tr>
      <th>5</th>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-07-13</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12345</td>
      <td>2020-12-22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iPod</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-07-31</td>
    </tr>
    <tr>
      <th>8</th>
      <td>iPad</td>
      <td>Web Referrer</td>
      <td>True</td>
      <td>6</td>
      <td>41</td>
      <td>21</td>
      <td>273</td>
      <td>1</td>
      <td>12345</td>
      <td>2021-01-09</td>
    </tr>
    <tr>
      <th>9</th>
      <td>iPhone</td>
      <td>App Store Browse</td>
      <td>True</td>
      <td>3</td>
      <td>65</td>
      <td>27</td>
      <td>374</td>
      <td>5</td>
      <td>12345</td>
      <td>2021-02-25</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_usage_source_type_device.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"usage_source_type_device_projected" AS (
    -- Projection: Selecting 10 out of 11 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "date_",
        "device",
        "source_type",
        "meets_threshold",
        "installations",
        "sessions",
        "active_devices",
        "active_devices_last_30_days",
        "deletions"
    FROM "usage_source_type_device"
),

"usage_source_type_device_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> record_date
    -- device -> device_type
    -- source_type -> acquisition_channel
    -- installations -> new_installations
    -- sessions -> daily_sessions
    -- active_devices -> daily_active_devices
    -- active_devices_last_30_days -> monthly_active_devices
    -- deletions -> app_deletions
    SELECT 
        app_id,
        date_ AS record_date,
        device AS device_type,
        source_type AS acquisition_channel,
        meets_threshold,
        installations AS new_installations,
        sessions AS daily_sessions,
        active_devices AS daily_active_devices,
        active_devices_last_30_days AS monthly_active_devices,
        deletions AS app_deletions
    FROM usage_source_type_device_projected
),

"usage_source_type_device_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- record_date: from VARCHAR to TIMESTAMP
    SELECT
        "device_type",
        "acquisition_channel",
        "meets_threshold",
        "new_installations",
        "daily_sessions",
        "daily_active_devices",
        "monthly_active_devices",
        "app_deletions",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("record_date" AS TIMESTAMP) AS "record_date"
    FROM "usage_source_type_device_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "usage_source_type_device_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_usage_source_type_device.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_usage_source_type_device
  description: The table is about app usage statistics. It includes details such as
    app ID, date, device type, source type, installation count, session count, active
    devices, and deletions. The data is broken down by device (iPhone, iPad, Desktop,
    iPod) and source type (App Store Browse, App Store Search, App Referrer). It tracks
    various metrics over time to analyze app performance and user engagement across
    different platforms and acquisition channels.
  columns:
  - name: device_type
    description: Type of device (iPhone, iPad, Desktop, iPod)
    tests:
    - not_null
    - accepted_values:
        values:
        - iPod
        - iPad
        - iPhone
        - Desktop
  - name: acquisition_channel
    description: Channel through which the app was discovered
    tests:
    - not_null
    - accepted_values:
        values:
        - App Store Browse
        - Web Referrer
        - App Referrer
        - App Store Search
        - Social Media
        - Word of Mouth
        - Email Marketing
        - Push Notification
        - In-App Promotion
        - App Store Ads
        - Google Ads
        - Facebook Ads
        - Instagram Ads
        - Twitter Ads
        - YouTube Ads
        - Influencer Marketing
        - TV Advertising
        - Print Media
        - Outdoor Advertising
        - Event Marketing
        - App Store Featuring
        - Pre-installed on Device
        - App Bundles
        - Cross-Promotion
        - QR Code
        - Direct URL
  - name: meets_threshold
    description: Boolean indicating if data meets reporting threshold
    tests:
    - not_null
  - name: new_installations
    description: Number of new app installations on the given date
    tests:
    - not_null
  - name: daily_sessions
    description: Number of app sessions on the given date
    tests:
    - not_null
  - name: daily_active_devices
    description: Number of active devices on the given date
    tests:
    - not_null
  - name: monthly_active_devices
    description: Number of active devices in the last 30 days
    tests:
    - not_null
  - name: app_deletions
    description: Number of app deletions on the given date
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the app
    tests:
    - not_null
  - name: record_date
    description: Date of the recorded data
    tests:
    - not_null
</code></pre>
    </div>
</div><div class="tab-pane fade " id="cocoon_stage_stg_crashes_app_version">
    <p class="text-center mb-0">stg_crashes_app_version <small class="text-muted">(first 100 rows)</small></p>
    <div class="code_container mb-4 mx-4"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>app_version</th>
      <th>device_type</th>
      <th>threshold_met</th>
      <th>crash_count</th>
      <th>app_id</th>
      <th>record_datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0.0 (iOS)</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-01-22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0.0 (iOS)</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-01-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0.0 (iOS)</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2020-11-15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0.0 (iOS)</td>
      <td>iPhone</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-06-18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0.0 (iOS)</td>
      <td>Desktop</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-07-30</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0.0 (iOS)</td>
      <td>iPad</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-05-02</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.0.0 (iOS)</td>
      <td>iPhone</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-06-19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.0.0 (iOS)</td>
      <td>Desktop</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2020-12-05</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.0.0 (iOS)</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2020-12-21</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.0.0 (iOS)</td>
      <td>iPod</td>
      <td>True</td>
      <td>0</td>
      <td>12345</td>
      <td>2021-04-12</td>
    </tr>
  </tbody>
</table></div>
    
    <p class="text-center">stg_crashes_app_version.sql <small class="text-muted">(clean the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-sql">-- COCOON BLOCK START: PLEASE DO NOT MODIFY THIS BLOCK FOR SELF-MAINTENANCE
WITH 
"crashes_app_version_projected" AS (
    -- Projection: Selecting 6 out of 7 columns
    -- Columns projected out: ['_fivetran_synced']
    SELECT 
        "app_id",
        "app_version",
        "date_",
        "device",
        "meets_threshold",
        "crashes"
    FROM "crashes_app_version"
),

"crashes_app_version_projected_renamed" AS (
    -- Rename: Renaming columns
    -- date_ -> record_datetime
    -- device -> device_type
    -- meets_threshold -> threshold_met
    -- crashes -> crash_count
    SELECT 
        app_id,
        app_version,
        date_ AS record_datetime,
        device AS device_type,
        meets_threshold AS threshold_met,
        crashes AS crash_count
    FROM crashes_app_version_projected
),

"crashes_app_version_projected_renamed_casted" AS (
    -- Column Type Casting: 
    -- app_id: from INT to VARCHAR
    -- record_datetime: from VARCHAR to TIMESTAMP
    SELECT
        "app_version",
        "device_type",
        "threshold_met",
        "crash_count",
        CAST("app_id" AS VARCHAR) AS "app_id",
        CAST("record_datetime" AS TIMESTAMP) AS "record_datetime"
    FROM "crashes_app_version_projected_renamed"
)

-- COCOON BLOCK END
SELECT * FROM "crashes_app_version_projected_renamed_casted"</code></pre>
    </div>
    <p class="text-center">stg_crashes_app_version.yml <small class="text-muted"> (Document the table)</small></p>
    <div class="code_container mb-4 mx-4">
        <pre><code class="language-yaml">version: 2
models:
- name: stg_crashes_app_version
  description: The table is about app crash data. It includes the app ID, app version,
    date, device type, a threshold indicator, and number of crashes. Each row represents
    a specific instance of crash data for an app version on a particular device and
    date. The data appears to track crash occurrences across different versions and
    devices over time.
  columns:
  - name: app_version
    description: Version of the app, including platform
    tests:
    - not_null
  - name: device_type
    description: Type of device running the app
    tests:
    - not_null
    - accepted_values:
        values:
        - iPod
        - Desktop
        - iPhone
        - iPad
        - Android Phone
        - Android Tablet
        - Windows Phone
        - Windows Tablet
        - MacBook
        - Smart TV
        - Gaming Console
        - Smartwatch
        - E-reader
  - name: threshold_met
    description: Indicator if crash count meets certain threshold
    tests:
    - not_null
  - name: crash_count
    description: Number of crashes recorded
    tests:
    - not_null
  - name: app_id
    description: Unique identifier for the application
    tests:
    - not_null
  - name: record_datetime
    description: Date and time of the recorded data
    tests:
    - not_null
</code></pre>
    </div>
</div>
                                    </div>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="cocoon_steps_scd">
                                <nav class="navbar navbar-light bg-light">
                                    <span class="navbar-brand mb-0">
                                        <h5 class="card-title mb-0">Slowly Changing Dimension Model</h5>
                                    </span>
                                    <ul class="nav">
                                        <li class="nav-item dropdown">
                                            <a class="nav-link dropdown-toggle active" href="#"
                                                id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                                Select Table
                                            </a>
                                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                                
                                            </div>
                                        </li>
                                    </ul>
                                </nav>

                                <div class="container">
                                    <small class="text-muted">Some tables log change events, which may be redundant to
                                        query. Instead, we take a snapshot of the latest.</small>
                                </div>
                                <hr>
                                <div class="scroll-container overflow-auto">
                                    <div class="tab-content mt-3">
                                        
                                    </div>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="cocoon_steps_join">
                                <nav class="navbar navbar-light bg-light">
                                    <span class="navbar-brand mb-0">
                                        <h5 class="card-title mb-0">Integration</h5>
                                    </span>
                                </nav>

                                <div class="container">
                                    <small class="text-muted">We identify the primary key (PK) and foreign key (FK) from
                                        tables. We build a join graph that connects FK to PK.</small>
                                </div>
                                <hr>
                                <p class="text-center">Join Graph <small class="text-muted">(FK to PK)</small></p>
<div class="container mb-4">
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2259pt" height="88pt"
 viewBox="0.00 0.00 2259.00 88.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-84 2255,-84 2255,4 -4,4"/>
<!-- stg_crashes_platform_version -->
<g id="node1" class="node">
<title>stg_crashes_platform_version</title>
<polygon fill="#ffffff" stroke="#000000" points="1127.5,-80 1006.5,-80 1006.5,-58 1127.5,-58 1127.5,-80"/>
<text text-anchor="middle" x="1067" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_crashes_platform_version</text>
</g>
<!-- stg_app -->
<g id="node13" class="node">
<title>stg_app</title>
<polygon fill="#ffffff" stroke="#000000" points="1161,-22 1125,-22 1125,0 1161,0 1161,-22"/>
<text text-anchor="middle" x="1143" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_app</text>
</g>
<!-- stg_crashes_platform_version&#45;&gt;stg_app -->
<g id="edge5" class="edge">
<title>stg_crashes_platform_version&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1080.59,-57.99C1092.72,-49.05 1110.62,-35.86 1124.14,-25.89"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1125.69,-27.36 1129.27,-22.11 1123.2,-23.98 1125.69,-27.36"/>
</g>
<!-- stg_app_store_territory_source_type -->
<g id="node2" class="node">
<title>stg_app_store_territory_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="1292.5,-80 1145.5,-80 1145.5,-58 1292.5,-58 1292.5,-80"/>
<text text-anchor="middle" x="1219" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_app_store_territory_source_type</text>
</g>
<!-- stg_app_store_territory_source_type&#45;&gt;stg_app -->
<g id="edge3" class="edge">
<title>stg_app_store_territory_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1205.41,-57.99C1193.28,-49.05 1175.38,-35.86 1161.86,-25.89"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1162.8,-23.98 1156.73,-22.11 1160.31,-27.36 1162.8,-23.98"/>
</g>
<!-- stg_usage_territory_source_type -->
<g id="node3" class="node">
<title>stg_usage_territory_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="1443,-80 1311,-80 1311,-58 1443,-58 1443,-80"/>
<text text-anchor="middle" x="1377" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_usage_territory_source_type</text>
</g>
<!-- stg_usage_territory_source_type&#45;&gt;stg_app -->
<g id="edge12" class="edge">
<title>stg_usage_territory_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1335.17,-57.99C1286.25,-46.28 1206.94,-27.3 1167.25,-17.8"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.55,-15.72 1161.23,-16.36 1166.57,-19.8 1167.55,-15.72"/>
</g>
<!-- stg_usage_app_version_source_type -->
<g id="node4" class="node">
<title>stg_usage_app_version_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="1610.5,-80 1461.5,-80 1461.5,-58 1610.5,-58 1610.5,-80"/>
<text text-anchor="middle" x="1536" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_usage_app_version_source_type</text>
</g>
<!-- stg_usage_app_version_source_type&#45;&gt;stg_app -->
<g id="edge9" class="edge">
<title>stg_usage_app_version_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1465.74,-57.99C1376.06,-45.21 1225.54,-23.76 1167.16,-15.44"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.39,-13.35 1161.15,-14.59 1166.8,-17.51 1167.39,-13.35"/>
</g>
<!-- stg_usage_source_type_device -->
<g id="node5" class="node">
<title>stg_usage_source_type_device</title>
<polygon fill="#ffffff" stroke="#000000" points="1755.5,-80 1628.5,-80 1628.5,-58 1755.5,-58 1755.5,-80"/>
<text text-anchor="middle" x="1692" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_usage_source_type_device</text>
</g>
<!-- stg_usage_source_type_device&#45;&gt;stg_app -->
<g id="edge11" class="edge">
<title>stg_usage_source_type_device&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1628.42,-59.02C1625.57,-58.67 1622.76,-58.32 1620,-58 1447.1,-37.67 1238.16,-19.84 1167.61,-14.01"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.38,-11.88 1161.23,-13.48 1167.03,-16.07 1167.38,-11.88"/>
</g>
<!-- stg_sales_subscription_events -->
<g id="node6" class="node">
<title>stg_sales_subscription_events</title>
<polygon fill="#ffffff" stroke="#000000" points="2099,-80 1975,-80 1975,-58 2099,-58 2099,-80"/>
<text text-anchor="middle" x="2037" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_sales_subscription_events</text>
</g>
<!-- stg_sales_subscription_events&#45;&gt;stg_app -->
<g id="edge13" class="edge">
<title>stg_sales_subscription_events&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1974.7,-58.92C1971.76,-58.59 1968.85,-58.28 1966,-58 1651.39,-27.11 1266.94,-15.28 1167.43,-12.61"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.34,-10.51 1161.29,-12.45 1167.23,-14.71 1167.34,-10.51"/>
</g>
<!-- stg_sales_account -->
<g id="node16" class="node">
<title>stg_sales_account</title>
<polygon fill="#ffffff" stroke="#000000" points="2148,-22 2072,-22 2072,0 2148,0 2148,-22"/>
<text text-anchor="middle" x="2110" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_sales_account</text>
</g>
<!-- stg_sales_subscription_events&#45;&gt;stg_sales_account -->
<g id="edge15" class="edge">
<title>stg_sales_subscription_events&#45;&gt;stg_sales_account</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M2050.05,-57.99C2061.64,-49.1 2078.69,-36.02 2091.65,-26.08"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="2093.09,-27.62 2096.57,-22.3 2090.53,-24.29 2093.09,-27.62"/>
</g>
<!-- stg_app_store_platform_version_source_type -->
<g id="node7" class="node">
<title>stg_app_store_platform_version_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="1956.5,-80 1773.5,-80 1773.5,-58 1956.5,-58 1956.5,-80"/>
<text text-anchor="middle" x="1865" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_app_store_platform_version_source_type</text>
</g>
<!-- stg_app_store_platform_version_source_type&#45;&gt;stg_app -->
<g id="edge1" class="edge">
<title>stg_app_store_platform_version_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1773.46,-58.75C1770.61,-58.49 1767.78,-58.24 1765,-58 1532.39,-37.77 1250.34,-18.98 1167.17,-13.56"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.2,-11.46 1161.08,-13.17 1166.93,-15.65 1167.2,-11.46"/>
</g>
<!-- stg_downloads_source_type_device -->
<g id="node8" class="node">
<title>stg_downloads_source_type_device</title>
<polygon fill="#ffffff" stroke="#000000" points="146,-80 0,-80 0,-58 146,-58 146,-80"/>
<text text-anchor="middle" x="73" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_downloads_source_type_device</text>
</g>
<!-- stg_downloads_source_type_device&#45;&gt;stg_app -->
<g id="edge7" class="edge">
<title>stg_downloads_source_type_device&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M146.29,-58.79C149.23,-58.5 152.14,-58.24 155,-58 538.35,-25.75 1007.41,-14.72 1118.57,-12.46"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1118.82,-14.56 1124.78,-12.34 1118.74,-10.36 1118.82,-14.56"/>
</g>
<!-- stg_downloads_platform_version_source_type -->
<g id="node9" class="node">
<title>stg_downloads_platform_version_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="351.5,-80 164.5,-80 164.5,-58 351.5,-58 351.5,-80"/>
<text text-anchor="middle" x="258" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_downloads_platform_version_source_type</text>
</g>
<!-- stg_downloads_platform_version_source_type&#45;&gt;stg_app -->
<g id="edge6" class="edge">
<title>stg_downloads_platform_version_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M351.64,-58.68C354.46,-58.44 357.25,-58.22 360,-58 658.59,-34.6 1022.09,-17.45 1118.55,-13.09"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1118.87,-15.18 1124.77,-12.81 1118.68,-10.98 1118.87,-15.18"/>
</g>
<!-- stg_downloads_territory_source_type -->
<g id="node10" class="node">
<title>stg_downloads_territory_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="520.5,-80 369.5,-80 369.5,-58 520.5,-58 520.5,-80"/>
<text text-anchor="middle" x="445" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_downloads_territory_source_type</text>
</g>
<!-- stg_downloads_territory_source_type&#45;&gt;stg_app -->
<g id="edge8" class="edge">
<title>stg_downloads_territory_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M520.53,-58.95C523.73,-58.62 526.89,-58.3 530,-58 758.81,-35.97 1036.53,-18.45 1118.89,-13.44"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1119.06,-15.54 1124.92,-13.08 1118.81,-11.34 1119.06,-15.54"/>
</g>
<!-- stg_usage_platform_version_source_type -->
<g id="node11" class="node">
<title>stg_usage_platform_version_source_type</title>
<polygon fill="#ffffff" stroke="#000000" points="707,-80 539,-80 539,-58 707,-58 707,-80"/>
<text text-anchor="middle" x="623" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_usage_platform_version_source_type</text>
</g>
<!-- stg_usage_platform_version_source_type&#45;&gt;stg_app -->
<g id="edge10" class="edge">
<title>stg_usage_platform_version_source_type&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M707.12,-58.94C828.5,-45.87 1046.14,-22.43 1118.71,-14.62"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1119.13,-16.68 1124.87,-13.95 1118.68,-12.51 1119.13,-16.68"/>
</g>
<!-- stg_sales_subscription_summary -->
<g id="node12" class="node">
<title>stg_sales_subscription_summary</title>
<polygon fill="#ffffff" stroke="#000000" points="2251,-80 2117,-80 2117,-58 2251,-58 2251,-80"/>
<text text-anchor="middle" x="2184" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_sales_subscription_summary</text>
</g>
<!-- stg_sales_subscription_summary&#45;&gt;stg_app -->
<g id="edge14" class="edge">
<title>stg_sales_subscription_summary&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M2116.9,-58.86C2113.89,-58.55 2110.92,-58.26 2108,-58 1734.14,-24.55 1276.47,-14.43 1167.23,-12.41"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1167.15,-10.31 1161.12,-12.3 1167.08,-14.51 1167.15,-10.31"/>
</g>
<!-- stg_sales_subscription_summary&#45;&gt;stg_sales_account -->
<g id="edge16" class="edge">
<title>stg_sales_subscription_summary&#45;&gt;stg_sales_account</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M2170.77,-57.99C2159.03,-49.1 2141.74,-36.02 2128.61,-26.08"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="2129.67,-24.25 2123.62,-22.3 2127.13,-27.6 2129.67,-24.25"/>
</g>
<!-- stg_app_store_source_type_device -->
<g id="node14" class="node">
<title>stg_app_store_source_type_device</title>
<polygon fill="#ffffff" stroke="#000000" points="867,-80 725,-80 725,-58 867,-58 867,-80"/>
<text text-anchor="middle" x="796" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_app_store_source_type_device</text>
</g>
<!-- stg_app_store_source_type_device&#45;&gt;stg_app -->
<g id="edge2" class="edge">
<title>stg_app_store_source_type_device&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M858.04,-57.99C935.78,-45.44 1065.29,-24.54 1118.77,-15.91"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1119.31,-17.95 1124.9,-14.92 1118.64,-13.8 1119.31,-17.95"/>
</g>
<!-- stg_crashes_app_version -->
<g id="node15" class="node">
<title>stg_crashes_app_version</title>
<polygon fill="#ffffff" stroke="#000000" points="988.5,-80 885.5,-80 885.5,-58 988.5,-58 988.5,-80"/>
<text text-anchor="middle" x="937" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">stg_crashes_app_version</text>
</g>
<!-- stg_crashes_app_version&#45;&gt;stg_app -->
<g id="edge4" class="edge">
<title>stg_crashes_app_version&#45;&gt;stg_app</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M973.83,-57.99C1015.84,-46.57 1083.31,-28.23 1119.03,-18.52"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1119.66,-20.52 1124.9,-16.92 1118.56,-16.47 1119.66,-20.52"/>
</g>
</g>
</svg>

        </div>
        </div>
<p class="text-center">cocoon_join.yml <small class="text-muted"> (Document the joins)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">join_graph:
- table_name: stg_app
  primary_key: app_id
  foreign_keys: []
- table_name: stg_app_store_platform_version_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_app_store_source_type_device
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_app_store_territory_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_crashes_app_version
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_crashes_platform_version
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_downloads_platform_version_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_downloads_source_type_device
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_downloads_territory_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_usage_app_version_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_usage_platform_version_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_usage_source_type_device
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_usage_territory_source_type
  foreign_keys:
  - column: app_id
    reference:
      table_name: stg_app
      column: app_id
- table_name: stg_sales_subscription_events
  foreign_keys:
  - column: app_apple_id
    reference:
      table_name: stg_app
      column: app_id
  - column: account_number
    reference:
      table_name: stg_sales_account
      column: account_id
- table_name: stg_sales_subscription_summary
  foreign_keys:
  - column: app_apple_id
    reference:
      table_name: stg_app
      column: app_id
  - column: account_number
    reference:
      table_name: stg_sales_account
      column: account_id
- table_name: stg_sales_account
  primary_key: account_id
  foreign_keys: []
</code></pre>
</div>
                            </div>

                            <div class="tab-pane fade" id="cocoon_steps_er">
                                <nav class="navbar navbar-light bg-light">
                                    <span class="navbar-brand mb-0">
                                        <h5 class="card-title mb-0">Entity–Relationship model</h5>
                                    </span>
                                </nav>
                                <div class="container">
                                    <small class="text-muted">We identify the entities and relationships behind the
                                        tables, and tell the story among these relationships.</small>
                                </div>
                                <hr>
                                <div class="container">
    <div id="cocoon_er_story_carousel" class="carousel slide" data-interval="false">
        <div class="d-flex justify-content-between align-items-center mt-3">
            <a class="btn btn-secondary" href="#cocoon_er_story_carousel" role="button"
                data-slide="prev">
                Prev
            </a>
            <a class="btn btn-secondary" href="#cocoon_er_story_carousel" role="button"
                data-slide="next">
                Next
            </a>
        </div>
        <ol class="carousel-indicators" style="position: relative; bottom: 30px;">
            <li data-target="#cocoon_er_story_carousel" data-slide-to="0" class=""></li>
<li data-target="#cocoon_er_story_carousel" data-slide-to="1" class=""></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active" style="transition: none;">
    <p>Story behind the relationships <small class="text-muted"> (only for those connect >= 2 entities)</small></p><ol class="small"><li><b>[ApplicationSubscriptionEvents]: Sales Accounts manages Application subscriptions.</b></li></ol>
    
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="150pt" height="88pt"
 viewBox="0.00 0.00 150.47 88.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-84 146.47,-84 146.47,4 -4,4"/>
<!-- ApplicationSubscriptionEvents -->
<g id="node1" class="node">
<title>ApplicationSubscriptionEvents</title>
<polygon fill="#e1f5fe" stroke="#4fc3f7" points="130.45,-80 5.45,-80 5.45,-58 130.45,-58 130.45,-80"/>
<text text-anchor="middle" x="67.95" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">ApplicationSubscriptionEvents</text>
</g>
<!-- Applications -->
<g id="node2" class="node">
<title>Applications</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="27.95" cy="-11" rx="27.89" ry="11"/>
<text text-anchor="middle" x="27.95" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Applications</text>
</g>
<!-- ApplicationSubscriptionEvents&#45;&#45;Applications -->
<g id="edge1" class="edge">
<title>ApplicationSubscriptionEvents&#45;&#45;Applications</title>
<path fill="none" stroke="#4fc3f7" d="M60.79,-57.99C53.51,-47.8 42.29,-32.09 35.03,-21.93"/>
</g>
<!-- Sales Accounts -->
<g id="node3" class="node">
<title>Sales Accounts</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="107.95" cy="-11" rx="34.54" ry="11"/>
<text text-anchor="middle" x="107.95" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Sales Accounts</text>
</g>
<!-- ApplicationSubscriptionEvents&#45;&#45;Sales Accounts -->
<g id="edge2" class="edge">
<title>ApplicationSubscriptionEvents&#45;&#45;Sales Accounts</title>
<path fill="none" stroke="#4fc3f7" d="M75.1,-57.99C82.38,-47.8 93.6,-32.09 100.86,-21.93"/>
</g>
</g>
</svg>

        </div>
        
    <br>
    
    </div>
<div class="carousel-item " style="transition: none;">
    <p>Story behind the relationships <small class="text-muted"> (only for those connect >= 2 entities)</small></p><ol class="small"><li>[ApplicationSubscriptionEvents]: Sales Accounts manages Application subscriptions.</li><li><b>[ApplicationSubscriptionSummary]: System generates daily revenue reports for Application subscriptions for sales accounts.</b></li></ol>
    
        <div style="overflow: auto; border: 1px solid #cccccc;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="288pt" height="88pt"
 viewBox="0.00 0.00 287.50 88.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-84 283.5,-84 283.5,4 -4,4"/>
<!-- ApplicationSubscriptionEvents -->
<g id="node1" class="node">
<title>ApplicationSubscriptionEvents</title>
<polygon fill="#ffffff" stroke="#000000" points="125,-80 0,-80 0,-58 125,-58 125,-80"/>
<text text-anchor="middle" x="62.5" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">ApplicationSubscriptionEvents</text>
</g>
<!-- Applications -->
<g id="node2" class="node">
<title>Applications</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="96.5" cy="-11" rx="27.89" ry="11"/>
<text text-anchor="middle" x="96.5" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Applications</text>
</g>
<!-- ApplicationSubscriptionEvents&#45;&#45;Applications -->
<g id="edge1" class="edge">
<title>ApplicationSubscriptionEvents&#45;&#45;Applications</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M68.58,-57.99C74.77,-47.8 84.3,-32.09 90.47,-21.93"/>
</g>
<!-- Sales Accounts -->
<g id="node3" class="node">
<title>Sales Accounts</title>
<ellipse fill="#e1f5fe" stroke="#4fc3f7" cx="193.5" cy="-11" rx="34.54" ry="11"/>
<text text-anchor="middle" x="193.5" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">Sales Accounts</text>
</g>
<!-- ApplicationSubscriptionEvents&#45;&#45;Sales Accounts -->
<g id="edge2" class="edge">
<title>ApplicationSubscriptionEvents&#45;&#45;Sales Accounts</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M85.92,-57.99C111.09,-47.23 150.63,-30.32 174.12,-20.28"/>
</g>
<!-- ApplicationSubscriptionSummary -->
<g id="node4" class="node">
<title>ApplicationSubscriptionSummary</title>
<polygon fill="#e1f5fe" stroke="#4fc3f7" points="279.5,-80 143.5,-80 143.5,-58 279.5,-58 279.5,-80"/>
<text text-anchor="middle" x="211.5" y="-67.1" font-family="Segoe UI" font-size="8.00" fill="#000000">ApplicationSubscriptionSummary</text>
</g>
<!-- ApplicationSubscriptionSummary&#45;&#45;Applications -->
<g id="edge3" class="edge">
<title>ApplicationSubscriptionSummary&#45;&#45;Applications</title>
<path fill="none" stroke="#4fc3f7" d="M190.94,-57.99C168.72,-47.17 133.72,-30.13 113.15,-20.11"/>
</g>
<!-- ApplicationSubscriptionSummary&#45;&#45;Sales Accounts -->
<g id="edge4" class="edge">
<title>ApplicationSubscriptionSummary&#45;&#45;Sales Accounts</title>
<path fill="none" stroke="#4fc3f7" d="M208.28,-57.99C205.05,-47.92 200.08,-32.47 196.81,-22.3"/>
</g>
</g>
</svg>

        </div>
        
    <br>
    
    </div>
        </div>
    </div>
</div>
<p class="text-center">cocoon_er.yml <small class="text-muted"> (Document the ER model)</small></p>
<div class="code_container mb-4 mx-4">
    <pre><code class="language-yaml">entities:
- entity_name: Applications
  entity_description: Represents mobile applications in an app store or app management
    system, containing details about each app's properties, availability, and performance
    metrics.
  table_name: stg_app
  primary_key: app_id
- entity_name: Sales Accounts
  entity_description: Represents individual sales accounts in a sales management system,
    containing basic identification information for each account.
  table_name: stg_sales_account
  primary_key: account_id
relations:
- relation_description: This table tracks daily performance metrics for Applications
    on the App Store across different iOS versions and traffic sources.
  table_name: stg_app_store_platform_version_source_type
  entities:
  - Applications
- relation_description: This table tracks performance metrics for Applications across
    different devices, discovery sources, and dates in app stores.
  table_name: stg_app_store_source_type_device
  entities:
  - Applications
- relation_description: This table stores performance metrics and engagement data
    for Applications in the App Store across different territories and discovery sources.
  table_name: stg_app_store_territory_source_type
  entities:
  - Applications
- relation_description: This table tracks crash data for different versions of Applications
    across various device types and dates.
  table_name: stg_crashes_app_version
  entities:
  - Applications
- relation_description: This table records crash data for Applications across different
    devices, platform versions, and dates.
  table_name: stg_crashes_platform_version
  entities:
  - Applications
- relation_description: This table tracks download statistics for Applications across
    different platform versions, download sources, and dates.
  table_name: stg_downloads_platform_version_source_type
  entities:
  - Applications
- relation_description: This stores the download statistics for Applications, including
    details about device types, sources, and download counts.
  table_name: stg_downloads_source_type_device
  entities:
  - Applications
- relation_description: This table tracks download statistics for Applications across
    different territories and acquisition channels over time.
  table_name: stg_downloads_territory_source_type
  entities:
  - Applications
- relation_description: This table captures detailed usage metrics for Applications
    across different versions, dates, and source types.
  table_name: stg_usage_app_version_source_type
  entities:
  - Applications
- relation_description: This table stores usage metrics and acquisition data for Applications
    across different platform versions and sources.
  table_name: stg_usage_platform_version_source_type
  entities:
  - Applications
- relation_description: This table tracks usage statistics and performance metrics
    for Applications across different devices and acquisition channels over time.
  table_name: stg_usage_source_type_device
  entities:
  - Applications
- relation_description: This table tracks usage metrics for Applications across different
    territories, dates, and acquisition sources.
  table_name: stg_usage_territory_source_type
  entities:
  - Applications
- relation_name: ApplicationSubscriptionEvents
  relation_description: This tracks subscription events for Applications, which are
    purchased and managed by Sales Accounts across various countries and devices.
  table_name: stg_sales_subscription_events
  entities:
  - Applications
  - Sales Accounts
- relation_name: ApplicationSubscriptionSummary
  relation_description: This table reports daily subscription summary for Applications,
    linking them to Sales Accounts and capturing detailed revenue.
  table_name: stg_sales_subscription_summary
  entities:
  - Applications
  - Sales Accounts
story:
- relation_name: ApplicationSubscriptionEvents
  story_line: Sales Accounts manages Application subscriptions.
- relation_name: ApplicationSubscriptionSummary
  story_line: System generates daily revenue reports for Application subscriptions for sales accounts.
</code></pre>
</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-md-3">
                <div class="list-group" id="myTab" role="tablist">
                    <a class="list-group-item list-group-item-action active" data-toggle="list" href="#cocoon_steps_source">
        <div>
            <h6 class="mb-0">1. Source</h6>
            <small>Initial tables from data warehouses</small>
        </div>
    </a><a class="list-group-item list-group-item-action" data-toggle="list" href="#cocoon_steps_stage">
    <div>
        <h6 class="mb-0">2. Stage</h6>
        <small>Clean and document the tables</small>
    </div>
</a><a class="list-group-item list-group-item-action" data-toggle="list" href="#cocoon_steps_join">
    <div>
        <h6 class="mb-0">3. Integration</h6>
        <small>Join graph from PK/FK</small>
    </div>
</a><a class="list-group-item list-group-item-action" data-toggle="list" href="#cocoon_steps_er">
    <div>
        <h6 class="mb-0">4. ER Model</h6>
        <small>Tell the story behind the tables</small>
    </div>
</a>
                </div>
            </div>
        </div>
    </div>
</body>

</html>