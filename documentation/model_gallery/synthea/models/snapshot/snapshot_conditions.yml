version: 2
models:
- name: snapshot_conditions
  description: The table tracks the most recent patient conditions and employment
    status. It shows the current condition descriptions and codes for each patient.
    It includes the latest start date and encounter ID for each condition. The table
    focuses on high school equivalency and full-time employment status. It provides
    a snapshot of the most up-to-date information for each patient's conditions.
  columns:
  - name: condition_description
    description: Text description of the condition or status
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: .+\s\(finding\)$
        summary: Medical conditions ending with "(finding)"
      - regex: .+\s\(disorder\)$
        summary: Medical conditions ending with "(disorder)"
      - regex: .+\s\(situation\)$
        summary: Medical situations ending with "(situation)"
      - regex: ^[A-Za-z\s-]+$
        summary: Medical conditions or findings without parentheses
      - regex: ^[A-Za-z\s-]+(\s\([A-Za-z]+\))?$
        summary: General pattern covering most entries (allows for conditions with
          or without parentheses)
      data_type:
        current_data_type: VARCHAR
  - name: condition_code
    description: Standardized code for the condition or status
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: patient_id
    description: Unique identifier for the patient
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: UUID
cocoon_meta:
  scd_base_table: stg_conditions
  scd_columns:
  - start_date
  - end_date
  - encounter_id
