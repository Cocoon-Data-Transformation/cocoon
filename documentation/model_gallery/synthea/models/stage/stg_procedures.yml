version: 2
models:
- name: stg_procedures
  description: The table is about medical procedures. It contains details such as
    start and stop times, patient and encounter IDs, procedure codes and descriptions,
    base costs, and reason codes/descriptions. Each row represents a specific medical
    procedure performed on a patient. The procedures include medication reconciliation,
    X-rays, and hospital admissions. The table tracks when procedures occurred, who
    they were performed on, and their associated costs.
  columns:
  - name: procedure_description
    description: Brief description of the medical procedure
    tests:
    - not_null
    cocoon_meta:
      patterns:
      - regex: .+\(procedure\)$
        summary: Entries ending with "(procedure)"
      - regex: .+\(regime/therapy\)$
        summary: Entries ending with "(regime/therapy)"
      - regex: ^Screening for .+
        summary: Entries starting with "Screening for"
      - regex: '^[A-Z][a-z]+(?: [a-z]+)*(?: \([a-z/]+\))?$'
        summary: General pattern for medical procedure descriptions
      data_type:
        current_data_type: VARCHAR
  - name: procedure_cost
    description: Base cost of the medical procedure
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: DECIMAL
  - name: reason_description
    description: Description of the reason for the procedure
    cocoon_meta:
      missing_reason: Not applicable for procedures without specific medical reasons.
      data_type:
        current_data_type: VARCHAR
  - name: encounter_id
    description: Unique identifier for the medical encounter
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: UUID
  - name: patient_id
    description: Unique identifier for the patient
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: UUID
  - name: procedure_code
    description: Standardized code for the medical procedure
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: procedure_end_time
    description: End time of the medical procedure
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: TIMESTAMP
  - name: procedure_start_time
    description: Start time of the medical procedure
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: TIMESTAMP
  - name: reason_code
    description: Code indicating the reason for the procedure
    cocoon_meta:
      missing_reason: Not applicable for procedures without specific medical reasons.
      data_type:
        current_data_type: VARCHAR
