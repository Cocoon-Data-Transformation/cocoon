version: 2
models:
- name: stg_devices
  description: The table is about medical devices. It includes start and stop dates
    for device use. It lists patient and encounter IDs. The table provides device
    codes and descriptions. It contains Unique Device Identifiers (UDI). Devices include
    home nebulizers and manual wheelchairs. Some devices have ongoing use without
    stop dates. The data spans from 2003 to 2022.
  columns:
  - name: device_description
    description: Text description of the medical device
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: device_udi
    description: Unique Device Identifier with encoded information
    tests:
    - not_null
    - unique
    cocoon_meta:
      unique_reason: This column represents the Unique Device Identifier, which contains
        encoded information about the device. For this table, each row represents
        a specific device usage instance. The device_udi appears to be unique across
        rows, as it includes a serial number (21) component that should be unique
        for each device instance.
      patterns:
      - regex: \(01\)\d{14}\(11\)\d{6}\(17\)\d{6}\(10\)[0-9]+\(21\)[0-9]+
        summary: UDI (Unique Device Identifier) pattern with multiple segments
      data_type:
        current_data_type: VARCHAR
  - name: device_code
    description: Numeric code representing the device type
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: VARCHAR
  - name: device_end_date
    description: End date and time of device use
    cocoon_meta:
      missing_reason: Devices still in use don't have an end date.
      data_type:
        current_data_type: TIMESTAMP
  - name: device_start_date
    description: Start date and time of device use
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: TIMESTAMP
  - name: encounter_id
    description: Unique identifier for the medical encounter
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: UUID
  - name: patient_id
    description: Unique identifier for the patient
    tests:
    - not_null
    cocoon_meta:
      data_type:
        current_data_type: UUID
